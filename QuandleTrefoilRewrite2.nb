(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    541102,      14481]
NotebookOptionsPosition[    531581,      14178]
NotebookOutlinePosition[    531927,      14193]
CellTagsIndexPosition[    531884,      14190]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.635705036866699*^9, 3.6357050369304*^9}, {
  3.6359607641871433`*^9, 3.635960764512826*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6359607614821997`*^9, 3.635960761785655*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "let", "]"}], " ", "=", " ", 
   RowBox[{"{", "HoldFirst", "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"lambda", "[", 
     RowBox[{
      RowBox[{"{", "x_", "}"}], ",", "expr2_"}], "]"}], ",", "exprl_"}], 
   "]"}], ":=", 
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", "exprl"}], "}"}], ",", "expr2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"let", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x_", " ", "=", " ", "expr_"}], "}"}], ",", " ", "x_"}], "]"}], 
  " ", ":=", " ", "expr"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"let", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", " ", "=", " ", "expr1_"}], "}"}], ",", " ", "y_Symbol"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"y", " ", "/;", " ", 
    RowBox[{"x", " ", "=!=", "y"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"let", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", " ", "=", "expr1_"}], "}"}], ",", " ", 
      RowBox[{"app", "[", 
       RowBox[{"expr2_", ",", "expr3_"}], "]"}]}], "]"}], " ", ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"app", " ", "[", " ", 
     RowBox[{
      RowBox[{"let", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", " ", "=", " ", "expr1"}], "}"}], ",", " ", "expr2"}], 
       "]"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{"let", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", " ", "=", " ", "expr1"}], "}"}], ",", " ", "expr3"}], 
       "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"let", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", " ", "=", " ", "expr1_"}], "}"}], ",", " ", 
     RowBox[{"lambda", "[", 
      RowBox[{
       RowBox[{"{", "x_", "}"}], ",", "expr2_"}], "]"}]}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", " ", "expr2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"let", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", " ", "=", "expr1_"}], "}"}], ",", " ", 
       RowBox[{"lambda", "[", 
        RowBox[{
         RowBox[{"{", "y_", "}"}], ",", " ", "expr2_"}], "]"}]}], "]"}], " ", 
     ":=", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"lambda", "[", 
       RowBox[{
        RowBox[{"{", "y", "}"}], ",", " ", 
        RowBox[{"let", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", "=", "expr1"}], "}"}], ",", " ", "expr2"}], "]"}]}], 
       "]"}], " ", "/;", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", " ", "=!=", "y"}], ")"}], " ", "&&", " ", 
       RowBox[{"(", 
        RowBox[{"Not", "[", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"freeVars", "[", "expr1", "]"}], ",", "y"}], "]"}], "]"}], 
        ")"}]}]}]}], ";"}], "/;", 
   RowBox[{"Print", "[", "expr", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"let", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", "=", "expr1_"}], "}"}], ",", " ", 
     RowBox[{"lambda", "[", 
      RowBox[{
       RowBox[{"{", "y_", "}"}], ",", " ", "expr2_"}], "]"}]}], "]"}], " ", ":=",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"let", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", " ", "=", "expr1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lambda", "[", 
         RowBox[{
          RowBox[{"{", "y", "}"}], ",", " ", "expr2"}], "]"}], "/.", 
        RowBox[{"y", "\[Rule]", " ", 
         RowBox[{"Unique", "[", "\"\<q\>\"", "]"}]}]}], ")"}]}], "]"}], "/;", 
    
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "=!=", "y"}], ")"}], " ", "&&", " ", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"freeVars", "[", "expr1", "]"}], ",", "y"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"freeVars", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"{", "x", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"freeVars", "[", 
    RowBox[{"app", "[", 
     RowBox[{"expr1_", ",", " ", "expr2_"}], "]"}], "]"}], " ", ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{"freeVars", "[", "expr1", "]"}], ",", " ", 
     RowBox[{"freeVars", "[", "expr2", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freeVars", "[", 
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x_", "}"}], ",", " ", "expr_"}], "]"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"freeVars", "[", "expr", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", " ", "=!=", " ", "x"}], ")"}], "&"}]}], "]"}], 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"freeVars", "[", "expr", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#", " ", "=!=", " ", "x"}], ")"}], "&"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"quandleRuleExpandApp", " ", "=", " ", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"a__", ",", 
       RowBox[{"app", "[", 
        RowBox[{"b__", ",", "c__"}], "]"}]}], "]"}], " ", "\[Rule]", 
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "c"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RewriteApp", "[", "t_", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"t", ",", "quandleRuleExpandApp", " ", ",", "i"}], "]"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{
         RowBox[{"Depth", "[", "t", "]"}], "+", "1"}]}], "}"}]}], "]"}], ",", 
    
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"t", ",", "quandleRuleExpandApp", " ", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"Depth", "[", "t", "]"}]}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"testlambda", " ", "=", 
  RowBox[{"lambda", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"lambda", "[", 
     RowBox[{
      RowBox[{"{", "y", "}"}], ",", 
      RowBox[{"lambda", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"app", "[", 
         RowBox[{"z", ",", 
          RowBox[{"app", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"RewriteApp", "[", "testlambda", "]"}]}], "Input",
 CellChangeTimes->{{3.632081243407057*^9, 3.6320812735146713`*^9}, 
   3.632082045943214*^9, {3.6320822203586473`*^9, 3.632082257360139*^9}, {
   3.632082301544422*^9, 3.6320823370125523`*^9}, {3.632082374416296*^9, 
   3.632082396838188*^9}, {3.632339806857229*^9, 3.632339808431198*^9}, {
   3.632685079129251*^9, 3.63268508026888*^9}, {3.6335331402352324`*^9, 
   3.6335331658408813`*^9}, {3.633533244165057*^9, 3.633533336970786*^9}, {
   3.6335336128172073`*^9, 3.633533661779278*^9}, {3.6335336967265673`*^9, 
   3.633533733417204*^9}, {3.633536324630294*^9, 3.6335364160072107`*^9}, {
   3.633536921251981*^9, 3.633536926958612*^9}, {3.633536959052113*^9, 
   3.633537036996255*^9}, {3.6335370745249453`*^9, 3.633537166127075*^9}, {
   3.633537261109126*^9, 3.633537267844029*^9}, {3.633537302062563*^9, 
   3.633537306759581*^9}, {3.633537441072761*^9, 3.633537499192135*^9}, {
   3.633537545327797*^9, 3.633537603487767*^9}, {3.633537644967511*^9, 
   3.633537673179262*^9}, {3.633537708266643*^9, 3.6335377588419037`*^9}, {
   3.63353799847857*^9, 3.6335380085314627`*^9}, {3.6335380400621347`*^9, 
   3.633538042584969*^9}, {3.633538281966696*^9, 3.6335383151242867`*^9}, {
   3.633538357760488*^9, 3.633538403917036*^9}, {3.633538471796103*^9, 
   3.6335384768340693`*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"{", "HoldFirst", "}"}]], "Output",
 CellChangeTimes->{
  3.632081236144916*^9, 3.6320812748517103`*^9, 3.6320822608912363`*^9, 
   3.632082309807102*^9, 3.632082400093081*^9, 3.632340555208167*^9, {
   3.632685070365431*^9, 3.632685081526205*^9}, {3.6335363632588778`*^9, 
   3.6335364170825777`*^9}, 3.6335369283720512`*^9, 3.633536969718246*^9, 
   3.6335370243387117`*^9, {3.633537097833393*^9, 3.633537119365765*^9}, 
   3.63353770887833*^9, {3.633537739166294*^9, 3.633537759863574*^9}, {
   3.633538214998006*^9, 3.633538233272387*^9}, 3.633538286545388*^9, {
   3.633538378298325*^9, 3.633538405466599*^9}, 3.633538477175399*^9, 
   3.634499358363899*^9, 3.6345005683318033`*^9, 3.63476107746735*^9, 
   3.6350236578981647`*^9, 3.6350243885133343`*^9, 3.6350244526300488`*^9, 
   3.6350286534596653`*^9, 3.635101261077362*^9, 3.6351013700724573`*^9, 
   3.635103393228695*^9, 3.635351697556014*^9, 3.6354430211153164`*^9, 
   3.6354476438113546`*^9, 3.635447921435974*^9, 3.635549154361383*^9, 
   3.635705135878105*^9, 3.6366493585442*^9, 3.6366504951359787`*^9, 
   3.636669842770529*^9, 3.6367448280091343`*^9},
 FontSize->18],

Cell[BoxData[
 RowBox[{"lambda", "[", 
  RowBox[{
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "y", "}"}], ",", 
     RowBox[{"lambda", "[", 
      RowBox[{
       RowBox[{"{", "z", "}"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"z", ",", 
         RowBox[{"app", "[", 
          RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.632081236144916*^9, 3.6320812748517103`*^9, 3.6320822608912363`*^9, 
   3.632082309807102*^9, 3.632082400093081*^9, 3.632340555208167*^9, {
   3.632685070365431*^9, 3.632685081526205*^9}, {3.6335363632588778`*^9, 
   3.6335364170825777`*^9}, 3.6335369283720512`*^9, 3.633536969718246*^9, 
   3.6335370243387117`*^9, {3.633537097833393*^9, 3.633537119365765*^9}, 
   3.63353770887833*^9, {3.633537739166294*^9, 3.633537759863574*^9}, {
   3.633538214998006*^9, 3.633538233272387*^9}, 3.633538286545388*^9, {
   3.633538378298325*^9, 3.633538405466599*^9}, 3.633538477175399*^9, 
   3.634499358363899*^9, 3.6345005683318033`*^9, 3.63476107746735*^9, 
   3.6350236578981647`*^9, 3.6350243885133343`*^9, 3.6350244526300488`*^9, 
   3.6350286534596653`*^9, 3.635101261077362*^9, 3.6351013700724573`*^9, 
   3.635103393228695*^9, 3.635351697556014*^9, 3.6354430211153164`*^9, 
   3.6354476438113546`*^9, 3.635447921435974*^9, 3.635549154361383*^9, 
   3.635705135878105*^9, 3.6366493585442*^9, 3.6366504951359787`*^9, 
   3.636669842770529*^9, 3.6367448280341578`*^9},
 FontSize->18],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"lambda", "[", 
      RowBox[{
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"lambda", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"z", ",", 
           RowBox[{"app", "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"lambda", "[", 
      RowBox[{
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"lambda", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"z", ",", "x"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.632081236144916*^9, 3.6320812748517103`*^9, 3.6320822608912363`*^9, 
   3.632082309807102*^9, 3.632082400093081*^9, 3.632340555208167*^9, {
   3.632685070365431*^9, 3.632685081526205*^9}, {3.6335363632588778`*^9, 
   3.6335364170825777`*^9}, 3.6335369283720512`*^9, 3.633536969718246*^9, 
   3.6335370243387117`*^9, {3.633537097833393*^9, 3.633537119365765*^9}, 
   3.63353770887833*^9, {3.633537739166294*^9, 3.633537759863574*^9}, {
   3.633538214998006*^9, 3.633538233272387*^9}, 3.633538286545388*^9, {
   3.633538378298325*^9, 3.633538405466599*^9}, 3.633538477175399*^9, 
   3.634499358363899*^9, 3.6345005683318033`*^9, 3.63476107746735*^9, 
   3.6350236578981647`*^9, 3.6350243885133343`*^9, 3.6350244526300488`*^9, 
   3.6350286534596653`*^9, 3.635101261077362*^9, 3.6351013700724573`*^9, 
   3.635103393228695*^9, 3.635351697556014*^9, 3.6354430211153164`*^9, 
   3.6354476438113546`*^9, 3.635447921435974*^9, 3.635549154361383*^9, 
   3.635705135878105*^9, 3.6366493585442*^9, 3.6366504951359787`*^9, 
   3.636669842770529*^9, 3.636744828037157*^9},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RewriteApp", "[", 
  RowBox[{"lambda", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"lambda", "[", 
     RowBox[{
      RowBox[{"{", "y", "}"}], ",", 
      RowBox[{"lambda", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"z", ",", "x"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.6320814111234903`*^9, 3.632081416923506*^9}, {
  3.6326852152140093`*^9, 3.632685227650962*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"lambda", "[", 
      RowBox[{
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"lambda", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"z", ",", "x"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"lambda", "[", 
      RowBox[{
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"lambda", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"z", ",", "x"}], "]"}], ",", "x"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.632081420148467*^9, 3.634500568636694*^9, 
  3.635023658498176*^9, 3.635024388716344*^9, 3.635024452762061*^9, 
  3.6350286536436768`*^9, 3.635101262559548*^9, 3.635101371426365*^9, 
  3.6351033961633797`*^9, 3.6353516977530136`*^9, 3.6354430211803446`*^9, 
  3.6354476440523767`*^9, 3.635447921668001*^9, 3.6355491547501097`*^9, 
  3.635705135937944*^9, 3.6366493585661993`*^9, 3.6366504951619906`*^9, 
  3.63666984286025*^9, 3.6367448280511365`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RewriteApp", "[", 
  RowBox[{"lambda", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"lambda", "[", 
     RowBox[{
      RowBox[{"{", "y", "}"}], ",", 
      RowBox[{"lambda", "[", 
       RowBox[{
        RowBox[{"{", "z", "}"}], ",", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"z", ",", "x"}], "]"}], ",", "x"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.6320814432065697`*^9, 3.632081447174198*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"lambda", "[", 
      RowBox[{
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"lambda", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"z", ",", "x"}], "]"}], ",", "x"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}], ",", 
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"lambda", "[", 
      RowBox[{
       RowBox[{"{", "y", "}"}], ",", 
       RowBox[{"lambda", "[", 
        RowBox[{
         RowBox[{"{", "z", "}"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"z", ",", "x"}], "]"}], ",", "x"}], "]"}], ",", "x"}],
             "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"y", ",", "x"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.632081448154131*^9, 3.634500568721407*^9, 
  3.635023658511171*^9, 3.635024388730364*^9, 3.6350244527730484`*^9, 
  3.6350286536536775`*^9, 3.635101263415133*^9, 3.635101372129925*^9, 
  3.635103397508192*^9, 3.6353516977640247`*^9, 3.635443021186324*^9, 
  3.6354476440673833`*^9, 3.635447921674001*^9, 3.635549154804886*^9, 
  3.635705135987413*^9, 3.636649358575185*^9, 3.6366504951679907`*^9, 
  3.63666984289548*^9, 3.636744828065159*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"lambda", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", "a"}], "]"}], ",", "x"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{
        RowBox[{"lambda", "[", 
         RowBox[{
          RowBox[{"{", "y", "}"}], ",", "b"}], "]"}], ",", "y"}], "]"}], ",", 
      "c"}], "]"}]}], "]"}],
  FontSize->24]], "Input",
 CellChangeTimes->{{3.632081502840692*^9, 3.6320815247431383`*^9}, {
  3.63208157018777*^9, 3.632081594305505*^9}}],

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{"a", ",", 
   RowBox[{"app", "[", 
    RowBox[{"b", ",", "c"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.6320816147696133`*^9, 3.632082271218288*^9, 3.63208240561753*^9, {
   3.633536381382622*^9, 3.633536420112151*^9}, {3.6335369486259937`*^9, 
   3.633536973943721*^9}, 3.633537103093684*^9, 3.633537712199337*^9, 
   3.633538219653904*^9, 3.633538289784061*^9, {3.6335383817163754`*^9, 
   3.63353840827151*^9}, 3.633538481098344*^9, 3.634500568787689*^9, 
   3.6350236585401864`*^9, 3.6350243887413654`*^9, 3.6350244527830544`*^9, 
   3.635028653663678*^9, 3.6351012635567636`*^9, 3.6351013722338676`*^9, 
   3.63510339910325*^9, 3.6353516977720146`*^9, 3.635443021192334*^9, 
   3.6354476440713606`*^9, 3.635447921680986*^9, 3.6355491548565397`*^9, 
   3.63570513604265*^9, 3.6366493585821857`*^9, 3.636650495172991*^9, 
   3.636669842943801*^9, 3.63674482807716*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trace", "[", 
  StyleBox[
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{
        RowBox[{"lambda", "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", "a"}], "]"}], ",", "x"}], "]"}], ",", 
      
      RowBox[{"app", "[", 
       RowBox[{
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"lambda", "[", 
           RowBox[{
            RowBox[{"{", "y", "}"}], ",", "b"}], "]"}], ",", "y"}], "]"}], 
        ",", "c"}], "]"}]}], "]"}], ",", "app"}],
   FontSize->24], 
  StyleBox["]",
   FontSize->24]}]], "Input",
 CellChangeTimes->{{3.633538483031437*^9, 3.6335384893964863`*^9}, {
  3.6335432612792397`*^9, 3.633543277376164*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"app", "[", 
       RowBox[{
        RowBox[{"lambda", "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", "a"}], "]"}], ",", "x"}], "]"}],
      HoldForm], ",", 
     TagBox[
      RowBox[{"let", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", "=", "x"}], "}"}], ",", "a"}], "]"}],
      HoldForm]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"lambda", "[", 
           RowBox[{
            RowBox[{"{", "y", "}"}], ",", "b"}], "]"}], ",", "y"}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"let", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"y", "=", "y"}], "}"}], ",", "b"}], "]"}],
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"app", "[", 
       RowBox[{"b", ",", "c"}], "]"}],
      HoldForm]}], "}"}], ",", 
   TagBox[
    RowBox[{"app", "[", 
     RowBox[{"a", ",", 
      RowBox[{"app", "[", 
       RowBox[{"b", ",", "c"}], "]"}]}], "]"}],
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{
  3.633538490034741*^9, {3.633543263622184*^9, 3.63354327844565*^9}, 
   3.634500568856001*^9, 3.635023658547183*^9, 3.635024388757346*^9, 
   3.635024452789053*^9, 3.6350286536736784`*^9, 3.635101264045929*^9, 
   3.635101372607605*^9, 3.6351034005574503`*^9, 3.6353516977830176`*^9, 
   3.6354430211973104`*^9, 3.635447644077361*^9, 3.635447921686985*^9, 
   3.635549154905491*^9, 3.6357051360909452`*^9, 3.6366493585902*^9, 
   3.6366504951789923`*^9, 3.636669842979105*^9, 3.6367448280911617`*^9}]
}, Open  ]],

Cell[BoxData["\[NonBreakingSpace]"], "Input",
 CellChangeTimes->{3.633538578051394*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.633538383400115*^9, 3.633538414110265*^9}}],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{{3.632340568629953*^9, 3.632340569892001*^9}, {
   3.63268488995991*^9, 3.632684891036832*^9}, 3.632684940047926*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"y", ",", 
       RowBox[{"app", "[", 
        RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "]"}], ",", "a"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.632081660507234*^9, 3.632081693802388*^9}, {
  3.632081818054954*^9, 3.632081824137731*^9}}],

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{"y", ",", 
   RowBox[{"app", "[", 
    RowBox[{"a", ",", "a"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.632081695845787*^9, 3.632081828483103*^9, {3.633537716313965*^9, 
   3.633537764299861*^9}, 3.633538222387603*^9, 3.634500568997377*^9, 
   3.635023658565184*^9, 3.6350243887943563`*^9, 3.6350244528030434`*^9, 
   3.6350286537026806`*^9, 3.6351012657032423`*^9, 3.635101373705496*^9, 
   3.635103402015561*^9, 3.635351697811015*^9, 3.6354430212153206`*^9, 
   3.635447644092362*^9, 3.6354479217019854`*^9, 3.635549154996192*^9, 
   3.635705136169442*^9, 3.636649358610187*^9, 3.6366504951929827`*^9, 
   3.6366698430509787`*^9, 3.636744828129141*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "]"}], ",", 
   RowBox[{"lambda", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{3.632081717610566*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"$IterationLimit", "::", "itlim"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iteration limit of \[NoBreak]\\!\\(4096\\)\[NoBreak] \
exceeded. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/$IterationLimit/itlim\\\", ButtonNote -> \
\\\"$IterationLimit::itlim\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6345005690868883`*^9, 3.6350236587361975`*^9, 
  3.635024388853355*^9, 3.6350244528300586`*^9, 3.635028653741688*^9, 
  3.635101266330143*^9, 3.635101373852839*^9, 3.635103403348263*^9, 
  3.63535169802203*^9, 3.6354430214643264`*^9, 3.6354476441693707`*^9, 
  3.635447921728987*^9, 3.6355491551367207`*^9, 3.6357051363849363`*^9, 
  3.6366493587262073`*^9, 3.636650495435997*^9, 3.636669843131173*^9, 
  3.6367448281951437`*^9}],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"let", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", "=", 
        RowBox[{"lambda", "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "}"}], ",", "x"}], 
     "]"}], ",", 
    RowBox[{"let", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", "=", 
        RowBox[{"lambda", "[", 
         RowBox[{
          RowBox[{"{", "x", "}"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "}"}], ",", "x"}], 
     "]"}]}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.632081719608481*^9, 3.6335377737664013`*^9, 
  3.634500569096787*^9, 3.635023658738186*^9, 3.635024388856369*^9, 
  3.635024452833059*^9, 3.6350286537446823`*^9, 3.635101266339334*^9, 
  3.635101373861025*^9, 3.635103403360868*^9, 3.6353516980260315`*^9, 
  3.6354430214753256`*^9, 3.635447644171366*^9, 3.635447921730987*^9, 
  3.6355491551472883`*^9, 3.6357051363942738`*^9, 3.6366493587281933`*^9, 
  3.636650495437997*^9, 3.6366698431448936`*^9, 3.6367448281981597`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6320817941953*^9, 3.632081805112*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"G", " ", "=", " ", 
  RowBox[{"lambda", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", " ", 
    RowBox[{"app", "[", 
     RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"app", "[", 
  RowBox[{"G", ",", "a"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6320816430640783`*^9, 3.632081656288569*^9}, 
   3.632684799070821*^9, {3.632684942221278*^9, 3.632684971580962*^9}, {
   3.632685031847632*^9, 3.6326850556597233`*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"lambda", "[", 
  RowBox[{
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"app", "[", 
    RowBox[{"x", ",", "x"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.632685056700985*^9, 3.632685086203352*^9}, 
   3.63353778356642*^9, 3.634499332805328*^9, 3.6344993636781178`*^9, 
   3.63450056917616*^9, 3.6350236587481833`*^9, 3.6350243888743734`*^9, 
   3.6350244528410454`*^9, 3.635028653758684*^9, 3.635101267397696*^9, 
   3.6351013745786057`*^9, 3.635103406389771*^9, 3.6353516980560317`*^9, 
   3.6354430215303307`*^9, 3.635447644179372*^9, 3.6354479217399874`*^9, 
   3.635549155221236*^9, 3.6357051364441233`*^9, 3.636649358739205*^9, 
   3.6366504954460106`*^9, 3.636669843211364*^9, 3.6367448282091603`*^9},
 FontSize->18],

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{"a", ",", "a"}], "]"}]], "Output",
 CellChangeTimes->{{3.632685056700985*^9, 3.632685086203352*^9}, 
   3.63353778356642*^9, 3.634499332805328*^9, 3.6344993636781178`*^9, 
   3.63450056917616*^9, 3.6350236587481833`*^9, 3.6350243888743734`*^9, 
   3.6350244528410454`*^9, 3.635028653758684*^9, 3.635101267397696*^9, 
   3.6351013745786057`*^9, 3.635103406389771*^9, 3.6353516980560317`*^9, 
   3.6354430215303307`*^9, 3.635447644179372*^9, 3.6354479217399874`*^9, 
   3.635549155221236*^9, 3.6357051364441233`*^9, 3.636649358739205*^9, 
   3.6366504954460106`*^9, 3.636669843211364*^9, 3.6367448282121444`*^9},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"app", "[", 
  RowBox[{"a", ",", "a"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Trace", "[", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"G", ",", "G"}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{"app", "|", "lambda"}], ")"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.632685118864555*^9, 3.632685124567045*^9}, {
  3.633540098824638*^9, 3.633540105468524*^9}, {3.633543621172477*^9, 
  3.633543621660986*^9}, {3.633621815294886*^9, 3.633621819966*^9}}],

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{"a", ",", "a"}], "]"}]], "Output",
 CellChangeTimes->{3.632685125573332*^9, 3.633540106406452*^9, 
  3.63354362241794*^9, 3.633621820909151*^9, 3.634500569262765*^9, 
  3.6350236587561836`*^9, 3.6350243888883743`*^9, 3.635024452849047*^9, 
  3.6350286537716703`*^9, 3.63510126852186*^9, 3.635101374874269*^9, 
  3.635103406468644*^9, 3.6353516980760345`*^9, 3.635443021634344*^9, 
  3.635447644188354*^9, 3.6354479217470055`*^9, 3.63554915529806*^9, 
  3.635705136507229*^9, 3.636649358749195*^9, 3.636650495452997*^9, 
  3.636669843260247*^9, 3.636744828219161*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"$IterationLimit", "::", "itlim"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iteration limit of \[NoBreak]\\!\\(4096\\)\[NoBreak] \
exceeded. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/$IterationLimit/itlim\\\", ButtonNote -> \
\\\"$IterationLimit::itlim\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.632685125749309*^9, 3.633540106617693*^9, 
  3.633543622628846*^9, 3.633621821357567*^9, 3.634500569335998*^9, 
  3.6350236589292088`*^9, 3.635024388977368*^9, 3.6350244528940663`*^9, 
  3.6350286538146763`*^9, 3.635101268532179*^9, 3.635101374881536*^9, 
  3.635103406664811*^9, 3.63535169819904*^9, 3.6354430217203393`*^9, 
  3.6354476442403755`*^9, 3.6354479217949905`*^9, 3.635549155367074*^9, 
  3.635705136559113*^9, 3.6366493587971983`*^9, 3.6366504955020037`*^9, 
  3.636669843315234*^9, 3.636744828282149*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"lambda", "[", 
              RowBox[{
               RowBox[{"{", "x", "}"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"x", ",", "x"}], "]"}]}], "]"}], ",", 
             RowBox[{"lambda", "[", 
              RowBox[{
               RowBox[{"{", "x", "}"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"let", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", "=", 
               RowBox[{"lambda", "[", 
                RowBox[{
                 RowBox[{"{", "x", "}"}], ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"x", ",", "x"}], "]"}]}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"let", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", "=", 
                 RowBox[{"lambda", "[", 
                  RowBox[{
                   RowBox[{"{", "x", "}"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "}"}], ",", 
               "x"}], "]"}], ",", 
             RowBox[{"let", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", "=", 
                 RowBox[{"lambda", "[", 
                  RowBox[{
                   RowBox[{"{", "x", "}"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "}"}], ",", 
               "x"}], "]"}]}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"lambda", "[", 
              RowBox[{
               RowBox[{"{", "x", "}"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"x", ",", "x"}], "]"}]}], "]"}], ",", 
             RowBox[{"lambda", "[", 
              RowBox[{
               RowBox[{"{", "x", "}"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "]"}], ",", 
           TemplateBox[{"6136"},
            "OutputSizeLimit`Skeleton",
            DisplayFunction->(FrameBox[
              RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}],
               Background -> GrayLevel[0.75], 
              BaseStyle -> {
               "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
              ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
              GrayLevel[0.75], RoundingRadius -> 7]& )], ",", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"let", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", "=", 
                 RowBox[{"lambda", "[", 
                  RowBox[{
                   RowBox[{"{", "x", "}"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "}"}], ",", 
               "x"}], "]"}], ",", 
             RowBox[{"let", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", "=", 
                 RowBox[{"lambda", "[", 
                  RowBox[{
                   RowBox[{"{", "x", "}"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "}"}], ",", 
               "x"}], "]"}]}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"lambda", "[", 
              RowBox[{
               RowBox[{"{", "x", "}"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"x", ",", "x"}], "]"}]}], "]"}], ",", 
             RowBox[{"lambda", "[", 
              RowBox[{
               RowBox[{"{", "x", "}"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "]"}], ",", 
           RowBox[{"let", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", "=", 
               RowBox[{"lambda", "[", 
                RowBox[{
                 RowBox[{"{", "x", "}"}], ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "}"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{65., {3., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{52., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 37, 24956442114137222676, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{62., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 37, 24956442114137222676, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{44., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 37, 24956442114137222676, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{78., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[37]]], "Output",
 CellChangeTimes->{3.632685125573332*^9, 3.633540106406452*^9, 
  3.63354362241794*^9, 3.633621820909151*^9, 3.634500569262765*^9, 
  3.6350236587561836`*^9, 3.6350243888883743`*^9, 3.635024452849047*^9, 
  3.6350286537716703`*^9, 3.63510126852186*^9, 3.635101374874269*^9, 
  3.635103406468644*^9, 3.6353516980760345`*^9, 3.635443021634344*^9, 
  3.635447644188354*^9, 3.6354479217470055`*^9, 3.63554915529806*^9, 
  3.635705136507229*^9, 3.636649358749195*^9, 3.636650495452997*^9, 
  3.636669843260247*^9, 3.636744828520175*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"app", "[", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"G", ",", "a"}], "]"}], ",", "b"}], "]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"quandleRuleExpandApp2", " ", "=", " ", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], " ", 
     "\[Rule]", 
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "c"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RewriteApp2", "[", "t_", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"t", ",", "quandleRuleExpandApp2", " ", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{
         RowBox[{"Depth", "[", "t", "]"}], "+", "1"}]}], "}"}]}], "]"}], ",", 
    
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"t", ",", "quandleRuleExpandApp2", " ", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"Depth", "[", "t", "]"}]}], "}"}]}], "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.632685184381261*^9, 3.632685196963126*^9}, {
  3.632685317666272*^9, 3.632685365961907*^9}}],

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"a", ",", "a"}], "]"}], ",", "b"}], "]"}]], "Output",
 CellChangeTimes->{3.6326853996020393`*^9, 3.6344993711682167`*^9, 
  3.634500570066739*^9, 3.635023659238224*^9, 3.6350243892254105`*^9, 
  3.6350244531220646`*^9, 3.6350286540437045`*^9, 3.635101270036706*^9, 
  3.6351013764374847`*^9, 3.635103407625847*^9, 3.6353516987380695`*^9, 
  3.635428229548015*^9, 3.6354398407979956`*^9, 3.635443022088376*^9, 
  3.635447644483372*^9, 3.6354479220190043`*^9, 3.635549155927191*^9, 
  3.6357051372009974`*^9, 3.6366493590252137`*^9, 3.636650495779018*^9, 
  3.636669843926828*^9, 3.636744828527175*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"app", "[", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"a", ",", "a"}], "]"}], ",", "b"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Trace", "[", 
  RowBox[{
   RowBox[{"RewriteApp2", "[", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"G", ",", "a"}], "]"}], ",", "b"}], "]"}], "]"}], ",", 
   RowBox[{"(", 
    RowBox[{"app", "|", " ", "lambda"}], ")"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.632685235985477*^9, 3.632685241577814*^9}, {
   3.632685293016738*^9, 3.632685293818787*^9}, 3.63268536874129*^9, {
   3.633551498838215*^9, 3.633551504825656*^9}, {3.633576877885027*^9, 
   3.633576886188158*^9}}],

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"a", ",", "a"}], "]"}], ",", "b"}], "]"}]], "Output",
 CellChangeTimes->{3.632685369533463*^9, 3.632685403146041*^9, 
  3.633551506044743*^9, 3.633576888174121*^9, 3.634500570122703*^9, 
  3.635023659245211*^9, 3.635024389231385*^9, 3.6350244531280622`*^9, 
  3.6350286540547047`*^9, 3.635101270160434*^9, 3.6351013770803843`*^9, 
  3.63510340772535*^9, 3.63535169874807*^9, 3.6354430220963645`*^9, 
  3.6354476444893847`*^9, 3.635447922026018*^9, 3.635549155998888*^9, 
  3.635705137255866*^9, 3.6366493590342245`*^9, 3.636650495785019*^9, 
  3.636669843975876*^9, 3.636744828533181*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      TagBox[
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"lambda", "[", 
          RowBox[{
           RowBox[{"{", "x", "}"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"x", ",", "x"}], "]"}]}], "]"}], ",", "a"}], "]"}],
       HoldForm], ",", 
      TagBox[
       RowBox[{"let", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", "=", "a"}], "}"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"x", ",", "x"}], "]"}]}], "]"}],
       HoldForm], ",", 
      TagBox[
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"let", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", "=", "a"}], "}"}], ",", "x"}], "]"}], ",", 
         RowBox[{"let", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", "=", "a"}], "}"}], ",", "x"}], "]"}]}], "]"}],
       HoldForm], ",", 
      TagBox[
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "a"}], "]"}],
       HoldForm]}], "}"}], ",", 
    TagBox[
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "a"}], "]"}], ",", "b"}], "]"}],
     HoldForm]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.632685369533463*^9, 3.632685403146041*^9, 
  3.633551506044743*^9, 3.633576888174121*^9, 3.634500570122703*^9, 
  3.635023659245211*^9, 3.635024389231385*^9, 3.6350244531280622`*^9, 
  3.6350286540547047`*^9, 3.635101270160434*^9, 3.6351013770803843`*^9, 
  3.63510340772535*^9, 3.63535169874807*^9, 3.6354430220963645`*^9, 
  3.6354476444893847`*^9, 3.635447922026018*^9, 3.635549155998888*^9, 
  3.635705137255866*^9, 3.6366493590342245`*^9, 3.636650495785019*^9, 
  3.636669843975876*^9, 3.6367448285351734`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Trefoilruleone", " ", "=", " ", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"a", ",", "c"}], "]"}], " ", "\[Rule]", " ", 
   "b"}]}], "\[IndentingNewLine]", 
 RowBox[{"Trefoilruletwo", " ", "=", " ", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"b", ",", "a"}], "]"}], " ", "\[Rule]", " ", 
   "c"}]}], "\[IndentingNewLine]", 
 RowBox[{"Trefoilrulethree", " ", "=", " ", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"c", ",", "b"}], "]"}], " ", "\[Rule]", " ", 
   "a"}]}], "\[IndentingNewLine]", 
 RowBox[{"Trefoilrulefour", " ", "=", " ", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"a", ",", "b"}], "]"}], " ", "\[Rule]", 
   "c"}]}], "\[IndentingNewLine]", 
 RowBox[{"Trefoilrulefive", " ", "=", " ", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"c", ",", "a"}], "]"}], " ", "\[Rule]", 
   "b"}]}], "\[IndentingNewLine]", 
 RowBox[{"Trefoilrulesix", " ", "=", " ", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}]}], "\[IndentingNewLine]", 
 RowBox[{"Trefoilruleseven", " ", "=", " ", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}]}], "\[IndentingNewLine]", 
 RowBox[{"Trefoilruleeight", " ", "=", " ", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}]}], "\[IndentingNewLine]", 
 RowBox[{"Trefoilrulenine", " ", "=", " ", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", 
   "c"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6343377842065363`*^9, 3.6343378238828497`*^9}, {
   3.634338383780558*^9, 3.6343383943701525`*^9}, {3.6343384525905523`*^9, 
   3.634338471754683*^9}, {3.634338543458885*^9, 3.6343385605458536`*^9}, {
   3.6343387128767443`*^9, 3.6343387224123025`*^9}, {3.63441585901523*^9, 
   3.634415859487259*^9}, {3.634500131057263*^9, 3.634500227376976*^9}, {
   3.635102941097423*^9, 3.635102953352042*^9}, {3.635103197449196*^9, 
   3.6351032253859453`*^9}, 3.6351032822301702`*^9, {3.6354403821456275`*^9, 
   3.6354403992726264`*^9}, {3.6354404430101805`*^9, 3.635440477177141*^9}, {
   3.635443883166966*^9, 3.6354438880762935`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}]], "Output",
 CellChangeTimes->{3.634427042911374*^9, 3.634500235799192*^9, 
  3.634500570195467*^9, 3.634761042156288*^9, 3.63502365925323*^9, 
  3.635024389237385*^9, 3.6350244531350765`*^9, 3.635028654066701*^9, 
  3.6351012716065283`*^9, 3.635101377224638*^9, 3.635103251780592*^9, 
  3.635103353005591*^9, 3.6351034077922773`*^9, 3.635351698761071*^9, 
  3.6353552819010525`*^9, 3.635428194578978*^9, 3.63543982562914*^9, 
  3.6354430221063747`*^9, 3.63544764449739*^9, 3.635447922034032*^9, 
  3.635549156078491*^9, 3.6357051373079453`*^9, 3.6366493590442247`*^9, 
  3.6366504957930202`*^9, 3.63666984402606*^9, 3.6367448285401783`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}]], "Output",
 CellChangeTimes->{3.634427042911374*^9, 3.634500235799192*^9, 
  3.634500570195467*^9, 3.634761042156288*^9, 3.63502365925323*^9, 
  3.635024389237385*^9, 3.6350244531350765`*^9, 3.635028654066701*^9, 
  3.6351012716065283`*^9, 3.635101377224638*^9, 3.635103251780592*^9, 
  3.635103353005591*^9, 3.6351034077922773`*^9, 3.635351698761071*^9, 
  3.6353552819010525`*^9, 3.635428194578978*^9, 3.63543982562914*^9, 
  3.6354430221063747`*^9, 3.63544764449739*^9, 3.635447922034032*^9, 
  3.635549156078491*^9, 3.6357051373079453`*^9, 3.6366493590442247`*^9, 
  3.6366504957930202`*^9, 3.63666984402606*^9, 3.6367448285421734`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}]], "Output",
 CellChangeTimes->{3.634427042911374*^9, 3.634500235799192*^9, 
  3.634500570195467*^9, 3.634761042156288*^9, 3.63502365925323*^9, 
  3.635024389237385*^9, 3.6350244531350765`*^9, 3.635028654066701*^9, 
  3.6351012716065283`*^9, 3.635101377224638*^9, 3.635103251780592*^9, 
  3.635103353005591*^9, 3.6351034077922773`*^9, 3.635351698761071*^9, 
  3.6353552819010525`*^9, 3.635428194578978*^9, 3.63543982562914*^9, 
  3.6354430221063747`*^9, 3.63544764449739*^9, 3.635447922034032*^9, 
  3.635549156078491*^9, 3.6357051373079453`*^9, 3.6366493590442247`*^9, 
  3.6366504957930202`*^9, 3.63666984402606*^9, 3.636744828543173*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}]], "Output",
 CellChangeTimes->{3.634427042911374*^9, 3.634500235799192*^9, 
  3.634500570195467*^9, 3.634761042156288*^9, 3.63502365925323*^9, 
  3.635024389237385*^9, 3.6350244531350765`*^9, 3.635028654066701*^9, 
  3.6351012716065283`*^9, 3.635101377224638*^9, 3.635103251780592*^9, 
  3.635103353005591*^9, 3.6351034077922773`*^9, 3.635351698761071*^9, 
  3.6353552819010525`*^9, 3.635428194578978*^9, 3.63543982562914*^9, 
  3.6354430221063747`*^9, 3.63544764449739*^9, 3.635447922034032*^9, 
  3.635549156078491*^9, 3.6357051373079453`*^9, 3.6366493590442247`*^9, 
  3.6366504957930202`*^9, 3.63666984402606*^9, 3.6367448285441732`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}]], "Output",
 CellChangeTimes->{3.634427042911374*^9, 3.634500235799192*^9, 
  3.634500570195467*^9, 3.634761042156288*^9, 3.63502365925323*^9, 
  3.635024389237385*^9, 3.6350244531350765`*^9, 3.635028654066701*^9, 
  3.6351012716065283`*^9, 3.635101377224638*^9, 3.635103251780592*^9, 
  3.635103353005591*^9, 3.6351034077922773`*^9, 3.635351698761071*^9, 
  3.6353552819010525`*^9, 3.635428194578978*^9, 3.63543982562914*^9, 
  3.6354430221063747`*^9, 3.63544764449739*^9, 3.635447922034032*^9, 
  3.635549156078491*^9, 3.6357051373079453`*^9, 3.6366493590442247`*^9, 
  3.6366504957930202`*^9, 3.63666984402606*^9, 3.636744828546174*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}]], "Output",
 CellChangeTimes->{3.634427042911374*^9, 3.634500235799192*^9, 
  3.634500570195467*^9, 3.634761042156288*^9, 3.63502365925323*^9, 
  3.635024389237385*^9, 3.6350244531350765`*^9, 3.635028654066701*^9, 
  3.6351012716065283`*^9, 3.635101377224638*^9, 3.635103251780592*^9, 
  3.635103353005591*^9, 3.6351034077922773`*^9, 3.635351698761071*^9, 
  3.6353552819010525`*^9, 3.635428194578978*^9, 3.63543982562914*^9, 
  3.6354430221063747`*^9, 3.63544764449739*^9, 3.635447922034032*^9, 
  3.635549156078491*^9, 3.6357051373079453`*^9, 3.6366493590442247`*^9, 
  3.6366504957930202`*^9, 3.63666984402606*^9, 3.6367448285471735`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}]], "Output",
 CellChangeTimes->{3.634427042911374*^9, 3.634500235799192*^9, 
  3.634500570195467*^9, 3.634761042156288*^9, 3.63502365925323*^9, 
  3.635024389237385*^9, 3.6350244531350765`*^9, 3.635028654066701*^9, 
  3.6351012716065283`*^9, 3.635101377224638*^9, 3.635103251780592*^9, 
  3.635103353005591*^9, 3.6351034077922773`*^9, 3.635351698761071*^9, 
  3.6353552819010525`*^9, 3.635428194578978*^9, 3.63543982562914*^9, 
  3.6354430221063747`*^9, 3.63544764449739*^9, 3.635447922034032*^9, 
  3.635549156078491*^9, 3.6357051373079453`*^9, 3.6366493590442247`*^9, 
  3.6366504957930202`*^9, 3.63666984402606*^9, 3.636744828548174*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}]], "Output",
 CellChangeTimes->{3.634427042911374*^9, 3.634500235799192*^9, 
  3.634500570195467*^9, 3.634761042156288*^9, 3.63502365925323*^9, 
  3.635024389237385*^9, 3.6350244531350765`*^9, 3.635028654066701*^9, 
  3.6351012716065283`*^9, 3.635101377224638*^9, 3.635103251780592*^9, 
  3.635103353005591*^9, 3.6351034077922773`*^9, 3.635351698761071*^9, 
  3.6353552819010525`*^9, 3.635428194578978*^9, 3.63543982562914*^9, 
  3.6354430221063747`*^9, 3.63544764449739*^9, 3.635447922034032*^9, 
  3.635549156078491*^9, 3.6357051373079453`*^9, 3.6366493590442247`*^9, 
  3.6366504957930202`*^9, 3.63666984402606*^9, 3.6367448285491743`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]], "Output",
 CellChangeTimes->{3.634427042911374*^9, 3.634500235799192*^9, 
  3.634500570195467*^9, 3.634761042156288*^9, 3.63502365925323*^9, 
  3.635024389237385*^9, 3.6350244531350765`*^9, 3.635028654066701*^9, 
  3.6351012716065283`*^9, 3.635101377224638*^9, 3.635103251780592*^9, 
  3.635103353005591*^9, 3.6351034077922773`*^9, 3.635351698761071*^9, 
  3.6353552819010525`*^9, 3.635428194578978*^9, 3.63543982562914*^9, 
  3.6354430221063747`*^9, 3.63544764449739*^9, 3.635447922034032*^9, 
  3.635549156078491*^9, 3.6357051373079453`*^9, 3.6366493590442247`*^9, 
  3.6366504957930202`*^9, 3.63666984402606*^9, 3.6367448285501785`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.634428085882338*^9, 3.634428095289608*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trefoilrules", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
   "Trefoilruleone", ",", "Trefoilruletwo", ",", "Trefoilrulethree", ",", 
    "Trefoilrulefour", ",", "Trefoilrulefive", ",", "Trefoilrulesix", ",", 
    "Trefoilruleseven", ",", "Trefoilruleeight", ",", "Trefoilrulenine"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.6344281082832003`*^9, 3.634428130699688*^9}, 
   3.6344305186379347`*^9, {3.634500240810014*^9, 3.6345002818229647`*^9}, {
   3.635103230334791*^9, 3.6351032342715893`*^9}, {3.635103348210761*^9, 
   3.6351033511139107`*^9}, {3.6354431176421204`*^9, 3.63544311809512*^9}, {
   3.6354479158206367`*^9, 3.6354479175157533`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6344305196671457`*^9, 3.634500283387002*^9, 3.634500570327536*^9, {
   3.6347610392501187`*^9, 3.634761045596519*^9}, {3.6350236403261213`*^9, 
   3.635023659269213*^9}, 3.6350243892563868`*^9, 3.635024453153088*^9, 
   3.635028654088697*^9, 3.635101272700831*^9, 3.635101378279406*^9, 
   3.635103247929244*^9, 3.635103355621749*^9, 3.635103408023731*^9, 
   3.635351698788072*^9, 3.635428406376857*^9, 3.6354398227399387`*^9, 
   3.635443022125375*^9, 3.6354431189351697`*^9, 3.6354476445153875`*^9, {
   3.63544791802879*^9, 3.635447922055008*^9}, 3.63554915640163*^9, 
   3.635705137417014*^9, 3.636649359065226*^9, 3.6366504958090196`*^9, 
   3.636669844162476*^9, 3.6367448285581746`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.634427020023472*^9, 3.634427056118157*^9}, 
   3.634428100602194*^9, {3.6344287642317133`*^9, 3.634428776123412*^9}, {
   3.6351029576270733`*^9, 3.635102973760995*^9}, {3.635103284653151*^9, 
   3.635103335146908*^9}, 3.635103421558075*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrefoilRewrite", "[", "t_", "]"}], " ", ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Depth", "[", "t", "]"}], " ", "<", " ", "3"}], ",", 
    RowBox[{"Replace", "[", 
     RowBox[{"t", ",", "Trefoilrules"}], "]"}], ",", 
    RowBox[{"Union", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"t", ",", "Trefoilrules", " ", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3", ",", 
         RowBox[{"Depth", "[", "t", "]"}]}], "}"}]}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.634428058597417*^9, 3.634428066058631*^9}, {
   3.634428767718151*^9, 3.634428806701556*^9}, {3.634430528474682*^9, 
   3.634430532164466*^9}, {3.634495369260165*^9, 3.6344953877843437`*^9}, {
   3.634500393912258*^9, 3.6345004258983717`*^9}, 3.6345005111054363`*^9, 
   3.6345008121194153`*^9, 3.634500853398507*^9, {3.6345012790302057`*^9, 
   3.634501279265833*^9}, {3.6347610107914658`*^9, 3.6347610219321384`*^9}, 
   3.635024261483028*^9, {3.6350243145090933`*^9, 3.635024322839538*^9}, {
   3.635024355151417*^9, 3.635024382518008*^9}, {3.63502447171017*^9, 
   3.635024471872181*^9}, {3.6350245598272295`*^9, 3.6350245676846843`*^9}, {
   3.6350269792719946`*^9, 3.635027011455855*^9}, {3.635027069798212*^9, 
   3.63502709000239*^9}, {3.6350286648513455`*^9, 3.6350286650583572`*^9}, {
   3.635028723532735*^9, 3.6350288326000147`*^9}, {3.635101288141794*^9, 
   3.635101346977962*^9}, {3.635101433439225*^9, 3.635101434138668*^9}, {
   3.6351014875303717`*^9, 3.635101514155479*^9}, 3.635102152615794*^9, {
   3.63510224392183*^9, 3.635102244828726*^9}, {3.635102614350523*^9, 
   3.6351026763593493`*^9}, {3.635102848938562*^9, 3.635102914170144*^9}, {
   3.635103053258609*^9, 3.6351031448995533`*^9}, {3.635387577177739*^9, 
   3.635387591945594*^9}, {3.6353876447136393`*^9, 3.6353876504659405`*^9}, {
   3.635438804018985*^9, 3.635438807527287*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{"t", ",", 
   RowBox[{"Union", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"t", ",", "Trefoilrules", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Depth", "[", "t", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{"t", ",", 
   RowBox[{"Union", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"t", ",", "Trefoilrules", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Depth", "[", "t", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.6350245709268684`*^9, 3.6350286541096907`*^9, 
  3.6351012735974503`*^9, 3.635101379016626*^9, 3.6351034082253942`*^9, 
  3.635351698848075*^9, 3.6354430221573734`*^9, 3.635447644527388*^9, 
  3.635447922067021*^9, 3.635549156483615*^9, 3.635705137482012*^9, 
  3.6366493590902405`*^9, 3.63665049583102*^9, 3.636669844251359*^9, 
  3.636744828579166*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{"a", ",", "c"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{"b", ",", "a"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{"c", ",", "b"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6344305006185427`*^9, 3.634430508742703*^9}, {
  3.63449540139287*^9, 3.634495413189829*^9}}],

Cell[BoxData["b"], "Output",
 CellChangeTimes->{{3.634430509962584*^9, 3.634430535200197*^9}, {
   3.634495393935677*^9, 3.63449541376407*^9}, 3.634499283683044*^9, 
   3.634500289045642*^9, 3.634500430392071*^9, 3.634500515350067*^9, 
   3.6345005704188232`*^9, 3.63450081620426*^9, 3.6345008573365183`*^9, {
   3.634761030043589*^9, 3.6347610517578745`*^9}, {3.63502363405977*^9, 
   3.6350236592822156`*^9}, 3.635024266006268*^9, 3.6350243260347247`*^9, {
   3.6350243619698315`*^9, 3.6350243892673874`*^9}, {3.6350244531630816`*^9, 
   3.6350244773714743`*^9}, {3.6350269987421207`*^9, 
   3.6350270157450705`*^9}, {3.635028654121704*^9, 3.6350286681855183`*^9}, {
   3.635028741102725*^9, 3.635028758276742*^9}, 3.6350288107917533`*^9, {
   3.6351012737059298`*^9, 3.6351012943554173`*^9}, 3.635101379119609*^9, 
   3.635101445178508*^9, {3.635101497122864*^9, 3.6351015191235228`*^9}, 
   3.63510215867962*^9, 3.635102250459581*^9, {3.635102619589553*^9, 
   3.635102656635034*^9}, {3.63510287124273*^9, 3.6351029209529123`*^9}, 
   3.635103067245861*^9, 3.6351031509832*^9, 3.635103258694325*^9, 
   3.635103301888921*^9, 3.635103365420217*^9, 3.6351034083117456`*^9, 
   3.635351698854075*^9, 3.635443022233385*^9, 3.6354476445704*^9, 
   3.635447922074021*^9, 3.635549156535478*^9, 3.6357051375394297`*^9, 
   3.6366493590982323`*^9, 3.6366504958360195`*^9, 3.636669844287903*^9, 
   3.636744828585166*^9}],

Cell[BoxData["c"], "Output",
 CellChangeTimes->{{3.634430509962584*^9, 3.634430535200197*^9}, {
   3.634495393935677*^9, 3.63449541376407*^9}, 3.634499283683044*^9, 
   3.634500289045642*^9, 3.634500430392071*^9, 3.634500515350067*^9, 
   3.6345005704188232`*^9, 3.63450081620426*^9, 3.6345008573365183`*^9, {
   3.634761030043589*^9, 3.6347610517578745`*^9}, {3.63502363405977*^9, 
   3.6350236592822156`*^9}, 3.635024266006268*^9, 3.6350243260347247`*^9, {
   3.6350243619698315`*^9, 3.6350243892673874`*^9}, {3.6350244531630816`*^9, 
   3.6350244773714743`*^9}, {3.6350269987421207`*^9, 
   3.6350270157450705`*^9}, {3.635028654121704*^9, 3.6350286681855183`*^9}, {
   3.635028741102725*^9, 3.635028758276742*^9}, 3.6350288107917533`*^9, {
   3.6351012737059298`*^9, 3.6351012943554173`*^9}, 3.635101379119609*^9, 
   3.635101445178508*^9, {3.635101497122864*^9, 3.6351015191235228`*^9}, 
   3.63510215867962*^9, 3.635102250459581*^9, {3.635102619589553*^9, 
   3.635102656635034*^9}, {3.63510287124273*^9, 3.6351029209529123`*^9}, 
   3.635103067245861*^9, 3.6351031509832*^9, 3.635103258694325*^9, 
   3.635103301888921*^9, 3.635103365420217*^9, 3.6351034083117456`*^9, 
   3.635351698854075*^9, 3.635443022233385*^9, 3.6354476445704*^9, 
   3.635447922074021*^9, 3.635549156535478*^9, 3.6357051375394297`*^9, 
   3.6366493590982323`*^9, 3.6366504958360195`*^9, 3.636669844287903*^9, 
   3.636744828586179*^9}],

Cell[BoxData["a"], "Output",
 CellChangeTimes->{{3.634430509962584*^9, 3.634430535200197*^9}, {
   3.634495393935677*^9, 3.63449541376407*^9}, 3.634499283683044*^9, 
   3.634500289045642*^9, 3.634500430392071*^9, 3.634500515350067*^9, 
   3.6345005704188232`*^9, 3.63450081620426*^9, 3.6345008573365183`*^9, {
   3.634761030043589*^9, 3.6347610517578745`*^9}, {3.63502363405977*^9, 
   3.6350236592822156`*^9}, 3.635024266006268*^9, 3.6350243260347247`*^9, {
   3.6350243619698315`*^9, 3.6350243892673874`*^9}, {3.6350244531630816`*^9, 
   3.6350244773714743`*^9}, {3.6350269987421207`*^9, 
   3.6350270157450705`*^9}, {3.635028654121704*^9, 3.6350286681855183`*^9}, {
   3.635028741102725*^9, 3.635028758276742*^9}, 3.6350288107917533`*^9, {
   3.6351012737059298`*^9, 3.6351012943554173`*^9}, 3.635101379119609*^9, 
   3.635101445178508*^9, {3.635101497122864*^9, 3.6351015191235228`*^9}, 
   3.63510215867962*^9, 3.635102250459581*^9, {3.635102619589553*^9, 
   3.635102656635034*^9}, {3.63510287124273*^9, 3.6351029209529123`*^9}, 
   3.635103067245861*^9, 3.6351031509832*^9, 3.635103258694325*^9, 
   3.635103301888921*^9, 3.635103365420217*^9, 3.6351034083117456`*^9, 
   3.635351698854075*^9, 3.635443022233385*^9, 3.6354476445704*^9, 
   3.635447922074021*^9, 3.635549156535478*^9, 3.6357051375394297`*^9, 
   3.6366493590982323`*^9, 3.6366504958360195`*^9, 3.636669844287903*^9, 
   3.6367448285881944`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6350287621439643`*^9, 3.6350287754267125`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"a", ",", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6350244475057535`*^9, 3.6350244476797533`*^9}, {
  3.6350270396924877`*^9, 3.635027046153827*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"app", "[", "a", "]"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6350270465178556`*^9, {3.6350270794037457`*^9, 3.6350270940736237`*^9}, {
   3.6350286541337056`*^9, 3.6350286719467573`*^9}, 3.63502881473898*^9, 
   3.635101275734191*^9, 3.635101379939081*^9, 3.635101506451528*^9, 
   3.635102925718295*^9, 3.6351031549083443`*^9, 3.6351032664001427`*^9, 
   3.635103305941906*^9, 3.635103408420237*^9, 3.635351698866076*^9, 
   3.6354430222453775`*^9, 3.6354476446984024`*^9, 3.6354479220860214`*^9, 
   3.635549156604846*^9, 3.63570513761773*^9, 3.6366493591122155`*^9, 
   3.6366504958460336`*^9, 3.63666984437706*^9, 3.636744828595166*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"G", ",", 
      RowBox[{"app", "[", 
       RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.635103442087887*^9, 3.635103451970996*^9}, 
   3.6353637885703373`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"app", "[", 
   RowBox[{"b", ",", "b"}], "]"}], "}"}]], "Output",
 CellChangeTimes->{3.6354430222523828`*^9, 3.635447644749405*^9, 
  3.6354479220920224`*^9, 3.635549156660328*^9, 3.63570513765658*^9, 
  3.636649359119216*^9, 3.6366504958520217`*^9, 3.636669844428392*^9, 
  3.6367448286001773`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trace", "[", 
  RowBox[{"TrefoilRewrite", "[", 
   RowBox[{"app", "[", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"a", ",", 
        RowBox[{"app", "[", 
         RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], "]"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6345004525825453`*^9, 3.634500507105049*^9}, {
  3.634500649426366*^9, 3.6345006945024233`*^9}, {3.634500868651932*^9, 
  3.6345008714634647`*^9}, {3.635027024943634*^9, 3.6350270253466263`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"TrefoilRewrite", "[", 
     RowBox[{"app", "[", 
      RowBox[{"app", "[", 
       RowBox[{
        RowBox[{"app", "[", 
         RowBox[{"a", ",", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], "]"}], 
     "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Depth", "[", 
        RowBox[{"app", "[", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
         "]"}], "]"}], "<", "3"}], ",", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"app", "[", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
         "]"}], ",", "Trefoilrules"}], "]"}], ",", 
      RowBox[{"Union", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
            "]"}], ",", "Trefoilrules", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", 
           RowBox[{"Depth", "[", 
            RowBox[{"app", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
             "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
    HoldForm], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Depth", "[", 
         RowBox[{"app", "[", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
          "]"}], "]"}],
        HoldForm], ",", 
       TagBox["5",
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"5", "<", "3"}],
      HoldForm], ",", 
     TagBox["False",
      HoldForm]}], "}"}], ",", 
   TagBox[
    RowBox[{"If", "[", 
     RowBox[{"False", ",", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"app", "[", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
         "]"}], ",", "Trefoilrules"}], "]"}], ",", 
      RowBox[{"Union", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
            "]"}], ",", "Trefoilrules", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", 
           RowBox[{"Depth", "[", 
            RowBox[{"app", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
             "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"Union", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
          "]"}], ",", "Trefoilrules", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3", ",", 
         RowBox[{"Depth", "[", 
          RowBox[{"app", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
           "]"}], "]"}]}], "}"}]}], "]"}], "]"}],
    HoldForm], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
           "]"}], ",", "Trefoilrules", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3", ",", 
          RowBox[{"Depth", "[", 
           RowBox[{"app", "[", 
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
            "]"}], "]"}]}], "}"}]}], "]"}],
      HoldForm], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["Trefoilrules",
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         TagBox["i",
          HoldForm], ",", 
         TagBox["3",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}], ",", 
          "3"}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"app", "[", "a", "]"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["Trefoilrules",
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         TagBox["i",
          HoldForm], ",", 
         TagBox["4",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}], ",", 
          "4"}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"app", "[", "a", "]"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["Trefoilrules",
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         TagBox["i",
          HoldForm], ",", 
         TagBox["5",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}], ",", 
          "5"}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"app", "[", "a", "]"}],
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{
        RowBox[{"app", "[", "a", "]"}], ",", 
        RowBox[{"app", "[", "a", "]"}], ",", 
        RowBox[{"app", "[", "a", "]"}]}], "}"}],
      HoldForm]}], "}"}], ",", 
   TagBox[
    RowBox[{"Union", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"app", "[", "a", "]"}], ",", 
       RowBox[{"app", "[", "a", "]"}], ",", 
       RowBox[{"app", "[", "a", "]"}]}], "}"}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"{", 
     RowBox[{"app", "[", "a", "]"}], "}"}],
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{
  3.63450069514358*^9, {3.634500860353609*^9, 3.634500871948759*^9}, 
   3.6350236592902145`*^9, 3.63502371345335*^9, 3.63502438931339*^9, 
   3.6350244531850786`*^9, 3.6350286541467056`*^9, 3.635101275906274*^9, 
   3.63510138090455*^9, 3.635103408479959*^9, 3.6353516989440804`*^9, 
   3.635443022268383*^9, 3.635447644876413*^9, 3.635447922104022*^9, 
   3.6355491567190723`*^9, 3.635705137712275*^9, 3.636649359135229*^9, 
   3.6366504958640356`*^9, 3.636669844479459*^9, 3.6367448286111803`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6345004890251713`*^9, 3.6345005046250067`*^9}, {
  3.6350236948573036`*^9, 3.6350237105802107`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"RewriteApp", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"G", ",", 
      RowBox[{"app", "[", 
       RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TrefoilRewrite", "[", 
  RowBox[{"RewriteApp2", "[", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"G", ",", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"H", " ", "=", " ", 
  RowBox[{"lambda", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", " ", 
    RowBox[{"app", "[", 
     RowBox[{"F", ",", 
      RowBox[{"app", "[", 
       RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"TrefoilRewrite", "[", 
  RowBox[{"TrefoilRewrite", "[", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"H", ",", "a"}], "]"}], ",", "b"}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.634495982569302*^9, 3.634495998348078*^9}, {
   3.634496047707985*^9, 3.6344960480696583`*^9}, {3.634499406421801*^9, 
   3.634499409431774*^9}, {3.634499472634446*^9, 3.6344994735627728`*^9}, 
   3.635028644361162*^9, 3.635103574855102*^9, {3.635103972053794*^9, 
   3.635103999435095*^9}, {3.635104051366115*^9, 3.635104062243836*^9}, {
   3.6351041324734077`*^9, 3.6351042049216967`*^9}, {3.635104260061125*^9, 
   3.635104261015314*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "c"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], ",", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", "c"}], "]"}], ",", "c"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6350236277253933`*^9, 3.635023659300228*^9, 3.63502438932339*^9, 
   3.63502445319508*^9, {3.6350286491964445`*^9, 3.635028654165697*^9}, 
   3.635101277244754*^9, 3.635101381688828*^9, {3.635103408647469*^9, 
   3.63510343161201*^9}, {3.635103548023316*^9, 3.635103576294958*^9}, {
   3.635103994083652*^9, 3.6351040002893257`*^9}, 3.635104062783943*^9, {
   3.635104144826098*^9, 3.635104150754444*^9}, {3.6351041992030487`*^9, 
   3.635104205530377*^9}, 3.6353516989580913`*^9, 3.6353552469340296`*^9, 
   3.635443022282384*^9, 3.635447644894416*^9, 3.635447922116023*^9, {
   3.6355491500191813`*^9, 3.635549156809039*^9}, 3.635705137800535*^9, 
   3.63664935915022*^9, 3.636650495873036*^9, 3.636669844542973*^9, 
   3.6367448286211686`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"b", ",", "b", ",", "b", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "b", ",", 
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"c", ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"c", ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", "b"}], 
      "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6350236277253933`*^9, 3.635023659300228*^9, 3.63502438932339*^9, 
   3.63502445319508*^9, {3.6350286491964445`*^9, 3.635028654165697*^9}, 
   3.635101277244754*^9, 3.635101381688828*^9, {3.635103408647469*^9, 
   3.63510343161201*^9}, {3.635103548023316*^9, 3.635103576294958*^9}, {
   3.635103994083652*^9, 3.6351040002893257`*^9}, 3.635104062783943*^9, {
   3.635104144826098*^9, 3.635104150754444*^9}, {3.6351041992030487`*^9, 
   3.635104205530377*^9}, 3.6353516989580913`*^9, 3.6353552469340296`*^9, 
   3.635443022282384*^9, 3.635447644894416*^9, 3.635447922116023*^9, {
   3.6355491500191813`*^9, 3.635549156809039*^9}, 3.635705137800535*^9, 
   3.63664935915022*^9, 3.636650495873036*^9, 3.636669844542973*^9, 
   3.636744828624181*^9}],

Cell[BoxData[
 RowBox[{"lambda", "[", 
  RowBox[{
   RowBox[{"{", "x", "}"}], ",", 
   RowBox[{"app", "[", 
    RowBox[{"F", ",", 
     RowBox[{"app", "[", 
      RowBox[{"x", ",", "x"}], "]"}]}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.6350236277253933`*^9, 3.635023659300228*^9, 3.63502438932339*^9, 
   3.63502445319508*^9, {3.6350286491964445`*^9, 3.635028654165697*^9}, 
   3.635101277244754*^9, 3.635101381688828*^9, {3.635103408647469*^9, 
   3.63510343161201*^9}, {3.635103548023316*^9, 3.635103576294958*^9}, {
   3.635103994083652*^9, 3.6351040002893257`*^9}, 3.635104062783943*^9, {
   3.635104144826098*^9, 3.635104150754444*^9}, {3.6351041992030487`*^9, 
   3.635104205530377*^9}, 3.6353516989580913`*^9, 3.6353552469340296`*^9, 
   3.635443022282384*^9, 3.635447644894416*^9, 3.635447922116023*^9, {
   3.6355491500191813`*^9, 3.635549156809039*^9}, 3.635705137800535*^9, 
   3.63664935915022*^9, 3.636650495873036*^9, 3.636669844542973*^9, 
   3.636744828625181*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6350236277253933`*^9, 3.635023659300228*^9, 3.63502438932339*^9, 
   3.63502445319508*^9, {3.6350286491964445`*^9, 3.635028654165697*^9}, 
   3.635101277244754*^9, 3.635101381688828*^9, {3.635103408647469*^9, 
   3.63510343161201*^9}, {3.635103548023316*^9, 3.635103576294958*^9}, {
   3.635103994083652*^9, 3.6351040002893257`*^9}, 3.635104062783943*^9, {
   3.635104144826098*^9, 3.635104150754444*^9}, {3.6351041992030487`*^9, 
   3.635104205530377*^9}, 3.6353516989580913`*^9, 3.6353552469340296`*^9, 
   3.635443022282384*^9, 3.635447644894416*^9, 3.635447922116023*^9, {
   3.6355491500191813`*^9, 3.635549156809039*^9}, 3.635705137800535*^9, 
   3.63664935915022*^9, 3.636650495873036*^9, 3.636669844542973*^9, 
   3.636744828627181*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"RewriteApp2", "[", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6351042414974537`*^9, 3.6351042420821943`*^9}, {
  3.635104286115541*^9, 3.635104307011737*^9}, {3.6351043638083677`*^9, 
  3.635104432401642*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], ",", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", "b"}], "]"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6351044102732687`*^9, 3.635104433152802*^9}, 
   3.635351698969081*^9, 3.6354430222913847`*^9, 3.6354476451214104`*^9, 
   3.6354479221290236`*^9, 3.635549156881439*^9, 3.635705137873519*^9, 
   3.63664935916322*^9, 3.636650495882023*^9, 3.63666984460999*^9, 
   3.636744828631179*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RewriteApp2", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "b"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635104490849269*^9, 3.635104494905739*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", "b"}], "]"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"b", ",", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6351044955538387`*^9, 3.635351698975083*^9, 
  3.6354430222973747`*^9, 3.6354476451274233`*^9, 3.6354479221360273`*^9, 
  3.635549157099288*^9, 3.635705137922839*^9, 3.6366493591732373`*^9, 
  3.6366504958870335`*^9, 3.63666984465998*^9, 3.636744828637179*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "b"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6351044560180283`*^9, 3.6351044653435783`*^9}, 
   3.6353639957093153`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}]], "Output",
 CellChangeTimes->{3.635104466056028*^9, 3.6353516989800816`*^9, 
  3.6354430223033867`*^9, 3.635447645160413*^9, 3.6354479221420116`*^9, 
  3.635549157142632*^9, 3.635705137973329*^9, 3.63664935918322*^9, 
  3.6366504958920345`*^9, 3.6366698447222767`*^9, 3.6367448286421795`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"G", ",", "a"}], "]"}], ",", "b"}], "]"}]], "Input",
 CellChangeTimes->{{3.6351040332972803`*^9, 3.635104033756379*^9}}],

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"a", ",", "a"}], "]"}], ",", "b"}], "]"}]], "Output",
 CellChangeTimes->{3.63510407310625*^9, 3.6353516989870825`*^9, 
  3.635443022309383*^9, 3.6354476451654263`*^9, 3.6354479221480217`*^9, 
  3.6355491572027807`*^9, 3.635705138024485*^9, 3.6366493591932244`*^9, 
  3.6366504958970346`*^9, 3.6366698447772093`*^9, 3.6367448286481843`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.634500988389917*^9, 3.634500990851156*^9}, 
   3.6350236655065784`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TrefoilRewrite", "[", 
  RowBox[{"TrefoilRewrite", "[", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"G", ",", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.634500585747242*^9, 3.634500596478428*^9}, {
  3.63450100337428*^9, 3.634501023842517*^9}, {3.634605770956979*^9, 
  3.634605778518462*^9}},
 FontSize->18],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "b", "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.634501024699255*^9, 3.634501288898869*^9, 3.6346057793997383`*^9, 
   3.6347610654516497`*^9, {3.6350236594442263`*^9, 3.6350236776993113`*^9}, 
   3.6350243893363914`*^9, 3.6350244532090807`*^9, 3.635028654184701*^9, 
   3.6351012778146753`*^9, 3.63510138224955*^9, 3.635103408789749*^9, 
   3.6353516989960833`*^9, 3.635443022318388*^9, 3.6354476452604375`*^9, 
   3.6354479221570253`*^9, 3.635549157299786*^9, 3.635705138144994*^9, 
   3.636649359207223*^9, 3.6366504959040346`*^9, 3.63666984500543*^9, 
   3.6367448286571836`*^9},
 FontSize->18]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TrefoilRewrite", "[", 
   RowBox[{"RewriteApp2", "[", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"G", ",", 
        RowBox[{"app", "[", 
         RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], "]"}], 
   "]"}], " ", "/.", 
  RowBox[{"app", " ", "\[Rule]", " ", "List"}]}]], "Input",
 CellChangeTimes->{{3.6344994883436527`*^9, 3.6344995401739817`*^9}, {
  3.6344996198726587`*^9, 3.634499666138891*^9}, {3.634499701425704*^9, 
  3.634499840679509*^9}, {3.634499879036874*^9, 3.6344998860585814`*^9}, {
  3.6344999730279703`*^9, 3.6344999747630873`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"b", ",", "b", ",", "b", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"b", ",", "b", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", "b"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", "b"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "c"}], "}"}]}], "}"}]}], "}"}], ",", "b"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.634499712086793*^9, 3.634499781516985*^9, 
  3.6344998875131207`*^9, 3.634499975568664*^9, 3.6345005705820932`*^9, 
  3.6350236594512234`*^9, 3.635024389343391*^9, 3.6350244532170806`*^9, 
  3.635028654197709*^9, 3.6351012789059687`*^9, 3.635101383019937*^9, 
  3.63510340887602*^9, 3.635351699002084*^9, 3.635443022325383*^9, 
  3.6354476453434362`*^9, 3.6354479221640263`*^9, 3.635549157343638*^9, 
  3.635705138192809*^9, 3.6366493592172346`*^9, 3.636650495910035*^9, 
  3.636669845056185*^9, 3.636744828662175*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"app1", "[", "x_", "]"}], " ", ":=", " ", "x"}]], "Input",
 CellChangeTimes->{{3.634499891789021*^9, 3.6344998996205587`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}]}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}], ",", "b"}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "b"}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "b"}], "]"}], ",", "a"}], "]"}], ",", "b"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}]}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}], ",", "b"}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"c", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app1", "[", 
          RowBox[{"c", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", "b"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "c"}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "c"}], "]"}], ",", "b"}], "]"}]}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "c"}], "]"}], ",", 
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"c", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app1", "[", 
          RowBox[{"c", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", "b"}], 
      "]"}]}], "}"}]}], "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}]}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}], ",", "b"}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "b"}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "b"}], "]"}], ",", "a"}], "]"}], ",", "b"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}]}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{"b", ",", "b"}], "]"}], ",", "b"}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"c", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app1", "[", 
          RowBox[{"c", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", "b"}], 
      "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "c"}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "c"}], "]"}], ",", "b"}], "]"}]}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "c"}], "]"}], ",", 
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"c", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", "b"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"app1", "[", 
      RowBox[{
       RowBox[{"app1", "[", 
        RowBox[{
         RowBox[{"app1", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app1", "[", 
          RowBox[{"c", ",", 
           RowBox[{"app1", "[", 
            RowBox[{"a", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", "b"}], 
      "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.634499921210073*^9, 3.634500570677741*^9, 
  3.6350236595952487`*^9, 3.635024389361392*^9, 3.6350244532410865`*^9, 
  3.63502865422571*^9, 3.635101279676914*^9, 3.63510138469977*^9, 
  3.635103409078548*^9, 3.6353516990231023`*^9, 3.635443022351375*^9, 
  3.635447645372438*^9, 3.6354479221880274`*^9, 3.6355491574305267`*^9, 
  3.635705138266427*^9, 3.6366493592392406`*^9, 3.6366504959260263`*^9, 
  3.636669845135786*^9, 3.6367448286791844`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.634499932366144*^9, 3.635351681412077*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QuandleTrefoilrules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "Trefoilruleone", ",", "Trefoilruletwo", ",", "Trefoilrulethree", ",", 
     "Trefoilrulefour", ",", "Trefoilrulefive", ",", "Trefoilrulesix", ",", 
     "Trefoilruleseven", ",", "Trefoilruleeight", ",", "Trefoilrulenine", ",",
      "quandleRuleExpandApp2"}], " ", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuandleTrefoilRewrite", "[", "t_", "]"}], " ", ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Depth", "[", "t", "]"}], " ", "<", " ", "3"}], ",", 
    RowBox[{"RewriteApp2", "[", 
     RowBox[{"Replace", "[", 
      RowBox[{"t", ",", "QuandleTrefoilrules"}], " ", "]"}], "]"}], ",", 
    RowBox[{"RewriteApp2", "[", 
     RowBox[{"Union", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"t", ",", "Trefoilrules", " ", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3", ",", 
          RowBox[{"Depth", "[", "t", "]"}]}], "}"}]}], "]"}], "]"}], "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6353511133782964`*^9, 3.6353511568178034`*^9}, 
   3.635355162231137*^9, {3.6353552240076995`*^9, 3.635355228858967*^9}, {
   3.6353707761243916`*^9, 3.6353707942174373`*^9}, 3.635428175304908*^9, {
   3.6354283599471693`*^9, 3.635428393308505*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "b"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635355165112305*^9, 3.6353551903157587`*^9}, 
   3.6353552894674664`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "c"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6354430223683896`*^9, 3.635447645461444*^9, 
  3.635447922202016*^9, 3.6355491575344753`*^9, 3.635705138332999*^9, 
  3.6366493592572365`*^9, 3.6366504959380264`*^9, 3.636669845258192*^9, 
  3.636744828690189*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "c"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{"QuandleTrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "c"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.635428762525646*^9, 3.635428773968732*^9}, {
  3.635433942686667*^9, 3.635433944041901*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "c"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.635428780096051*^9, 3.6354430223753824`*^9, 
  3.635447645467444*^9, 3.6354479222090287`*^9, 3.635549157589406*^9, 
  3.6357051383909893`*^9, 3.636649359265224*^9, 3.636650495943039*^9, 
  3.6366698453762283`*^9, 3.6367448286961737`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "a"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "c"}], "]"}], ",", "a"}], "]"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.635428780096051*^9, 3.6354430223753824`*^9, 
  3.635447645467444*^9, 3.6354479222090287`*^9, 3.635549157589406*^9, 
  3.6357051383909893`*^9, 3.636649359265224*^9, 3.636650495943039*^9, 
  3.6366698453762283`*^9, 3.636744828698186*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trace", "[", " ", 
  RowBox[{"QuandleTrefoilRewrite", "[", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", "b"}], "]"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.635362252297593*^9, {3.6353637367553587`*^9, 3.6353637420976686`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"QuandleTrefoilRewrite", "[", 
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"F", ",", "b"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Depth", "[", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "b"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}], "<", "3"}], ",", 
      RowBox[{"RewriteApp2", "[", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", 
         "QuandleTrefoilrules"}], "]"}], "]"}], ",", 
      RowBox[{"RewriteApp2", "[", 
       RowBox[{"Union", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"F", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", "Trefoilrules", 
            ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "3", ",", 
            RowBox[{"Depth", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"F", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}], "]"}], "]"}]}], "]"}],
    HoldForm], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Depth", "[", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}],
        HoldForm], ",", 
       TagBox["3",
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"3", "<", "3"}],
      HoldForm], ",", 
     TagBox["False",
      HoldForm]}], "}"}], ",", 
   TagBox[
    RowBox[{"If", "[", 
     RowBox[{"False", ",", 
      RowBox[{"RewriteApp2", "[", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", 
         "QuandleTrefoilrules"}], "]"}], "]"}], ",", 
      RowBox[{"RewriteApp2", "[", 
       RowBox[{"Union", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"F", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", "Trefoilrules", 
            ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "3", ",", 
            RowBox[{"Depth", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"F", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}], "]"}], "]"}]}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"RewriteApp2", "[", 
     RowBox[{"Union", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"F", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", "Trefoilrules", 
          ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3", ",", 
          RowBox[{"Depth", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
       "]"}], "]"}], "]"}],
    HoldForm], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"F", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", "Trefoilrules", 
            ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "3", ",", 
            RowBox[{"Depth", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"F", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}],
        HoldForm], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["Trefoilrules",
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["3",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"F", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}], 
            ",", "3"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"Union", "[", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], "]"}],
      HoldForm], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}],
      HoldForm]}], "}"}], ",", 
   TagBox[
    RowBox[{"RewriteApp2", "[", 
     RowBox[{"{", 
      RowBox[{"app", "[", 
       RowBox[{
        RowBox[{"app", "[", 
         RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
         "quandleRuleExpandApp2", ",", "i"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{
          RowBox[{"Depth", "[", 
           RowBox[{"{", 
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], 
           "]"}], "+", "1"}]}], "}"}]}], "]"}], "\[Union]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
         "quandleRuleExpandApp2", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"Depth", "[", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], 
          "]"}]}], "}"}]}], "]"}]}],
    HoldForm], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          "quandleRuleExpandApp2", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Depth", "[", 
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], 
            "]"}], "+", "1"}]}], "}"}]}], "]"}],
      HoldForm], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         TagBox["i",
          HoldForm], ",", 
         TagBox["0",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "0"}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         TagBox["i",
          HoldForm], ",", 
         TagBox["1",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "1"}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         TagBox["i",
          HoldForm], ",", 
         TagBox["2",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "2"}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         TagBox["i",
          HoldForm], ",", 
         TagBox["3",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "3"}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         TagBox["i",
          HoldForm], ",", 
         TagBox["4",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "4"}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         TagBox["i",
          HoldForm], ",", 
         TagBox["5",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "5"}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}]}], "}"}],
      HoldForm]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          "quandleRuleExpandApp2", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"Depth", "[", 
           RowBox[{"{", 
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], 
           "]"}]}], "}"}]}], "]"}],
      HoldForm], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["0",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["1",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["2",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}]}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["3",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "3"}], "}"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "3"}], "}"}]}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox["quandleRuleExpandApp2",
          HoldForm], ",", 
         TagBox[
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["4",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"0", ",", "4"}], "}"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
           "\[Rule]", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "c"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "4"}], "}"}]}], "]"}],
        HoldForm], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}]}], "}"}],
      HoldForm]}], "}"}], ",", 
   TagBox[
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "c"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "c"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "c"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "c"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "c"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}]}], "}"}], 
     "\[Union]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "c"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "c"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "c"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"F", ",", "c"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}]}], "}"}]}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"F", ",", "c"}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}]}], "}"}],
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{3.635363747345972*^9, 3.6354430224113965`*^9, 
  3.6354476457104454`*^9, 3.6354479222460356`*^9, 3.635549157659953*^9, 
  3.635705138471642*^9, 3.6366493592932262`*^9, 3.6366504959710417`*^9, 
  3.636669845463293*^9, 3.6367448287181754`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"H", ",", "a"}], "]"}], ",", "b"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"app", "[", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"F", ",", 
     RowBox[{"app", "[", 
      RowBox[{"a", ",", "a"}], "]"}]}], "]"}], ",", "b"}], "]"}]], "Output",
 CellChangeTimes->{3.6353640136753545`*^9, 3.6354430224213796`*^9, 
  3.635447645717464*^9, 3.6354479222550364`*^9, 3.635549157719144*^9, 
  3.635705138528139*^9, 3.6366493593662453`*^9, 3.6366504959800286`*^9, 
  3.6366698455095882`*^9, 3.636744828727192*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"H", ",", "a"}], "]"}], ",", "b"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635364017712556*^9, 3.6353640217887917`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "b"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.635443022427393*^9, 3.635447645796465*^9, 
  3.635447922263029*^9, 3.635549157803276*^9, 3.635705138572824*^9, 
  3.6366493593762307`*^9, 3.6366504959850397`*^9, 3.6366698455613813`*^9, 
  3.6367448287331877`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{"QuandleTrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6353686010152645`*^9, 3.6353686058385744`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}]], "Output",
 CellChangeTimes->{3.635368606444611*^9, 3.63544302243439*^9, 
  3.6354476458024683`*^9, 3.6354479222690325`*^9, 3.635549157877109*^9, 
  3.635705138623925*^9, 3.636649359384244*^9, 3.6366504959910297`*^9, 
  3.6366698456440687`*^9, 3.636744828738188*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "b"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.635368606444611*^9, 3.63544302243439*^9, 
  3.6354476458024683`*^9, 3.6354479222690325`*^9, 3.635549157877109*^9, 
  3.635705138623925*^9, 3.636649359384244*^9, 3.6366504959910297`*^9, 
  3.6366698456440687`*^9, 3.636744828741189*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{"QuandleTrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6353686349862256`*^9, 3.635368646841942*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}]], "Output",
 CellChangeTimes->{3.6353686475129776`*^9, 3.6353876091395845`*^9, 
  3.635443022441394*^9, 3.6354476458804555`*^9, 3.6354479222780333`*^9, 
  3.635549157972138*^9, 3.6357051386772537`*^9, 3.636649359393244*^9, 
  3.63665049599704*^9, 3.636669845726323*^9, 3.6367448287461786`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"app", "[", 
    RowBox[{"c", ",", "c"}], "]"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6353686475129776`*^9, 3.6353876091395845`*^9, 
  3.635443022441394*^9, 3.6354476458804555`*^9, 3.6354479222780333`*^9, 
  3.635549157972138*^9, 3.6357051386772537`*^9, 3.636649359393244*^9, 
  3.63665049599704*^9, 3.636669845726323*^9, 3.636744828748189*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"a", ",", "a"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"b", ",", "b"}], "]"}]}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635370091879817*^9, 3.635370094074936*^9}, {
  3.635372929213745*^9, 3.6353729503509645`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"app", "[", 
    RowBox[{"c", ",", "c"}], "]"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.635372950970002*^9, 3.63538760405626*^9, 
  3.635428248771043*^9, 3.6354430224493914`*^9, 3.635447646036478*^9, 
  3.635447922287033*^9, 3.635549158200107*^9, 3.6357051387389917`*^9, 
  3.636649359401249*^9, 3.636650496004041*^9, 3.636669845782049*^9, 
  3.6367448287531896`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Depth", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"d", ",", "e"}], "]"}], ",", "f"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635370125861781*^9, 3.635370133907233*^9}}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{3.6353701342372646`*^9, 3.635443022454382*^9, 
  3.6354476460424786`*^9, 3.6354479222930202`*^9, 3.6355491582560177`*^9, 
  3.6357051387892733`*^9, 3.6366493594102325`*^9, 3.6366504960090404`*^9, 
  3.636669845937438*^9, 3.636744828758189*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"d", ",", "e"}], "]"}], ",", "f"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635370634190175*^9, 3.635370642179638*^9}, 
   3.635428260138238*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"d", ",", "e"}], "]"}], ",", "f"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"d", ",", "f"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"e", ",", "f"}], "]"}]}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6353706426726665`*^9, 3.635428260997107*^9, 
  3.6354430224613843`*^9, 3.635447646123483*^9, 3.6354479223000317`*^9, 
  3.635549158321582*^9, 3.635705138841687*^9, 3.636649359417247*^9, 
  3.636650496014041*^9, 3.636669845986392*^9, 3.6367448287631874`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"QuandleTrefoilRewrite2", "[", "t_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"TrefoilRewrite", ",", 
    RowBox[{"Union", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"t", ",", "quandleRuleExpandApp2", " ", ",", "i"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Depth", "[", "t", "]"}], "+", "1"}]}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"t", ",", "quandleRuleExpandApp2", " ", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"Depth", "[", "t", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6354340466062737`*^9, 3.63543407650632*^9}, {
  3.635435790552947*^9, 3.635435797758502*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite2", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635435807459811*^9, 3.635435827500924*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{"b", ",", "a"}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.635435809212973*^9, 3.635435829147378*^9}, 
   3.635438814029558*^9, 3.635443022470396*^9, 3.6354476462044754`*^9, 
   3.6354479223100214`*^9, 3.635549158444664*^9, 3.635705138917804*^9, 
   3.636649359429247*^9, 3.6366504960220423`*^9, 3.6366698460532217`*^9, 
   3.6367448287722073`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite2", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"d", ",", "e"}], "]"}], ",", "f"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.63543882925391*^9, 3.635438848534398*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"d", ",", "e"}], "]"}], ",", "f"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"d", ",", "f"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"e", ",", "f"}], "]"}]}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6354388498901176`*^9, 3.635443022476396*^9, 
  3.6354476462564907`*^9, 3.6354479223160353`*^9, 3.635549158518587*^9, 
  3.635705138952538*^9, 3.636649359436247*^9, 3.636650496027042*^9, 
  3.636669846084201*^9, 3.6367448287771907`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.635435787591228*^9, 3.635435802166967*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite2", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "a"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"b", ",", "b"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6354396748923087`*^9, 3.6354397036980214`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6354397047210684`*^9, 3.635439846464325*^9, 
  3.635443022486396*^9, 3.6354476463444967`*^9, 3.6354479223250356`*^9, 
  3.635549158616375*^9, 3.635705139023456*^9, 3.6366493594482527`*^9, 
  3.6366504960940495`*^9, 3.636669846154286*^9, 3.6367448287871914`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trace", "[", 
  RowBox[{"QuandleTrefoilRewrite2", "[", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"a", ",", "a"}], "]"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"b", ",", "b"}], "]"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635439876428076*^9, 3.635439906841855*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"QuandleTrefoilRewrite2", "[", 
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "a"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"b", ",", "b"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"TrefoilRewrite", "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
           "quandleRuleExpandApp2", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{
            RowBox[{"Depth", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "+", "1"}]}], 
          "}"}]}], "]"}], "\[Union]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
           "quandleRuleExpandApp2", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"Depth", "[", 
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
        "]"}]}], ")"}]}],
    HoldForm], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            "quandleRuleExpandApp2", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{
             RowBox[{"Depth", "[", 
              RowBox[{"app", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "a"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "+", "1"}]}],
            "}"}]}], "]"}],
        HoldForm], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["0",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "0"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["1",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "1"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["2",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "2"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["3",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "3"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["4",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "4"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            "quandleRuleExpandApp2", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"Depth", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}],
        HoldForm], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["0",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["1",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["2",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["3",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "3"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "3"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}]}], "}"}],
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "a"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "a"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "a"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "a"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "a"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "}"}], "\[Union]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}]}], "}"}]}],
      HoldForm], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"a", ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "a"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"b", ",", "b"}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "}"}],
      HoldForm]}], "}"}], ",", 
   TagBox[
    RowBox[{"TrefoilRewrite", "/@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", "a"}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"b", ",", "b"}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "}"}]}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TrefoilRewrite", "[", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
      RowBox[{"TrefoilRewrite", "[", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", "a"}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"b", ",", "b"}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}],
    HoldForm], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"TrefoilRewrite", "[", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"a", ",", 
           RowBox[{"app", "[", 
            RowBox[{"b", ",", "b"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], "]"}],
      HoldForm], ",", 
     TagBox[
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Depth", "[", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], "]"}], "<", 
         "3"}], ",", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
          "Trefoilrules"}], "]"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"b", ",", "b"}], "]"}], ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"b", ",", "b"}], "]"}], ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
             "Trefoilrules", ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3", ",", 
             RowBox[{"Depth", "[", 
              RowBox[{"app", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], "]"}]}], 
            "}"}]}], "]"}], "]"}]}], "]"}],
      HoldForm], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox[
          RowBox[{"Depth", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], "]"}],
          HoldForm], ",", 
         TagBox["4",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"4", "<", "3"}],
        HoldForm], ",", 
       TagBox["False",
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"If", "[", 
       RowBox[{"False", ",", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
          "Trefoilrules"}], "]"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"b", ",", "b"}], "]"}], ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"b", ",", "b"}], "]"}], ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
             "Trefoilrules", ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3", ",", 
             RowBox[{"Depth", "[", 
              RowBox[{"app", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], "]"}]}], 
            "}"}]}], "]"}], "]"}]}], "]"}],
      HoldForm], ",", 
     TagBox[
      RowBox[{"Union", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
           "Trefoilrules", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", 
           RowBox[{"Depth", "[", 
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], "]"}]}], 
          "}"}]}], "]"}], "]"}],
      HoldForm], ",", 
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
            "Trefoilrules", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "3", ",", 
            RowBox[{"Depth", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"b", ",", "b"}], "]"}], ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"b", ",", "b"}], "]"}], ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], "]"}]}], 
           "}"}]}], "]"}],
        HoldForm], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["Trefoilrules",
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["3",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}], 
            ",", "3"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["Trefoilrules",
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["4",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}], 
            ",", "4"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], ",", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}]}], "}"}],
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"Union", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}]}], "}"}], "]"}],
      
      HoldForm], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], "}"}],
      HoldForm]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{"TrefoilRewrite", "[", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", "a"}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"b", ",", "b"}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
      HoldForm], ",", 
     TagBox[
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Depth", "[", 
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "<", "3"}], ",", 
        
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", "Trefoilrules"}], 
         "]"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", "Trefoilrules", 
             ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3", ",", 
             RowBox[{"Depth", "[", 
              RowBox[{"app", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "a"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
          "]"}], "]"}]}], "]"}],
      HoldForm], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         TagBox[
          RowBox[{"Depth", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
          HoldForm], ",", 
         TagBox["3",
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"3", "<", "3"}],
        HoldForm], ",", 
       TagBox["False",
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"If", "[", 
       RowBox[{"False", ",", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{"a", ",", "a"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"b", ",", "b"}], "]"}], ",", 
            RowBox[{"app", "[", 
             RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", "Trefoilrules"}], 
         "]"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", "Trefoilrules", 
             ",", "i"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "3", ",", 
             RowBox[{"Depth", "[", 
              RowBox[{"app", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "a"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
          "]"}], "]"}]}], "]"}],
      HoldForm], ",", 
     TagBox[
      RowBox[{"Union", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", "Trefoilrules", 
           ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3", ",", 
           RowBox[{"Depth", "[", 
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
        "]"}], "]"}],
      HoldForm], ",", 
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", "Trefoilrules", 
            ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "3", ",", 
            RowBox[{"Depth", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}],
        HoldForm], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox["Trefoilrules",
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["3",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}], 
            ",", "3"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{"app", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{"Union", "[", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "]"}],
      HoldForm], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
      HoldForm]}], "}"}], ",", 
   TagBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}]}], "}"}],
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{{3.6354398855066094`*^9, 3.6354399077179174`*^9}, 
   3.635443022551405*^9, 3.635447646500493*^9, 3.635447922369045*^9, 
   3.635549158699162*^9, 3.63570513911969*^9, 3.6366493594822536`*^9, 
   3.636650496133052*^9, 3.6366698462234373`*^9, 3.636744828824198*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6354401184212084`*^9, 3.635440141857602*^9}, 
   3.635444281731882*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.635440155974394*^9, 3.635440160987686*^9}, 
   3.6354455946525326`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CleanupRule", "=", " ", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], " ", "\[Rule]", 
   RowBox[{"app", "[", " ", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CleanupRule2", "=", " ", 
   RowBox[{
    RowBox[{"app", "[", "a_", "]"}], " ", "\[Rule]", "a"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"CleanupList", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"CleanupRule", ",", "CleanupRule2"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cleanup", "[", "t_", "]"}], " ", ":=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{"t", ",", "CleanupList", " ", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"Depth", "[", "t", "]"}]}], "}"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QuandleTrefoilRewrite3", "[", "t_", "]"}], ":=", 
  RowBox[{"ReplaceAll", "[", 
   RowBox[{
    RowBox[{"Union", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"TrefoilRewrite", "[", "t", "]"}], ",", 
          "quandleRuleExpandApp2", " ", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Depth", "[", "t", "]"}], "+", "1"}]}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"TrefoilRewrite", "[", "t", "]"}], ",", 
          "quandleRuleExpandApp2", " ", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"Depth", "[", "t", "]"}]}], "}"}]}], "]"}]}], "]"}], ",", 
    "CleanupList"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6354403158267317`*^9, 3.6354403433993654`*^9}, {
   3.635443897509857*^9, 3.635443931646902*^9}, {3.6354441704452157`*^9, 
   3.6354442558343306`*^9}, {3.635444286424165*^9, 3.635444312317718*^9}, 
   3.635445699513816*^9, {3.635447466574747*^9, 3.63544758229068*^9}, 
   3.635447629254464*^9, {3.635705598110258*^9, 3.635705614602851*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[Rule]", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.635444256706352*^9, 3.635444313616804*^9, {3.6354457001888657`*^9, 
   3.63544572093311*^9}, 3.635447501650816*^9, 3.635447583132697*^9, 
   3.6354476465144978`*^9, 3.635447922387027*^9, {3.6355491311696787`*^9, 
   3.635549158869198*^9}, 3.635705139268626*^9, 3.635705615359281*^9, 
   3.636649359503256*^9, 3.636650496150052*^9, 3.636669846294832*^9, 
   3.636744828841199*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"app", "[", "a_", "]"}], "\[Rule]", "a"}]], "Output",
 CellChangeTimes->{
  3.635444256706352*^9, 3.635444313616804*^9, {3.6354457001888657`*^9, 
   3.63544572093311*^9}, 3.635447501650816*^9, 3.635447583132697*^9, 
   3.6354476465144978`*^9, 3.635447922387027*^9, {3.6355491311696787`*^9, 
   3.635549158869198*^9}, 3.635705139268626*^9, 3.635705615359281*^9, 
   3.636649359503256*^9, 3.636650496150052*^9, 3.636669846294832*^9, 
   3.636744828843195*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[Rule]", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"app", "[", "a_", "]"}], "\[Rule]", "a"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.635444256706352*^9, 3.635444313616804*^9, {3.6354457001888657`*^9, 
   3.63544572093311*^9}, 3.635447501650816*^9, 3.635447583132697*^9, 
   3.6354476465144978`*^9, 3.635447922387027*^9, {3.6355491311696787`*^9, 
   3.635549158869198*^9}, 3.635705139268626*^9, 3.635705615359281*^9, 
   3.636649359503256*^9, 3.636650496150052*^9, 3.636669846294832*^9, 
   3.6367448288451815`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6354431481989517`*^9, 3.635443154399293*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}]], "Output",
 CellChangeTimes->{3.635445613670673*^9, 3.6354457049801755`*^9, 
  3.6354475877330184`*^9, 3.6354476465975122`*^9, 3.635447922399042*^9, 
  3.63554915897223*^9, 3.6357051393293667`*^9, 3.6357056355356073`*^9, 
  3.636649359514251*^9, 3.6366504961580496`*^9, 3.636669846356142*^9, 
  3.636744828850195*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"QuandleTrefoileRewrite3", "[", 
   RowBox[{"app", "[", 
    RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.635445597253688*^9, 3.6354456177649255`*^9}, 
   3.635445660069457*^9, {3.635549119585635*^9, 3.635549124985116*^9}}],

Cell[BoxData[
 RowBox[{"QuandleTrefoileRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{{3.635549126170907*^9, 3.635549159057291*^9}, 
   3.6357051393912363`*^9, 3.6366493595212517`*^9, 3.6366504961640496`*^9, 
   3.636669846393654*^9, 3.636744828855182*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "a"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"b", ",", "b"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6354456506218987`*^9, 3.63544566370467*^9}, {
  3.635445709373428*^9, 3.635445713717699*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.635445664281719*^9, {3.6354457141467357`*^9, 3.6354457241672945`*^9}, 
   3.635447510210329*^9, 3.6354475945824165`*^9, 3.635447646684517*^9, 
   3.6354479224090376`*^9, 3.635549159413793*^9, 3.635705139439147*^9, 
   3.635706872698985*^9, 3.636649359529252*^9, 3.6366504961690507`*^9, 
   3.636669846446354*^9, 3.6367448288611956`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6357069133024178`*^9, 3.6357069212056217`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"app", "[", 
    RowBox[{"c", ",", "c"}], "]"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.635706922000106*^9, 3.636649359536253*^9, 
  3.6366504961740513`*^9, 3.6366698465262547`*^9, 3.6367448288661923`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trace", "[", 
  RowBox[{"QuandleTrefoilRewrite3", "[", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.635706929816963*^9, 3.635706975509622*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"QuandleTrefoilRewrite3", "[", 
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"TrefoilRewrite", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], ",", 
          "quandleRuleExpandApp2", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Depth", "[", 
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], "+", 
           "1"}]}], "}"}]}], "]"}], "\[Union]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"TrefoilRewrite", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], ",", 
          "quandleRuleExpandApp2", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"Depth", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}]}], 
         "}"}]}], "]"}]}], "/.", "\[VeryThinSpace]", "CleanupList"}],
    HoldForm], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], ",",
             "quandleRuleExpandApp2", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{
             RowBox[{"Depth", "[", 
              RowBox[{"app", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
             "+", "1"}]}], "}"}]}], "]"}],
        HoldForm], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
               "<", "3"}], ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["0",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "0"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
               "<", "3"}], ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["1",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "1"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
               "<", "3"}], ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["2",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "2"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
               "<", "3"}], ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["3",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "3"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
               "<", "3"}], ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["4",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "4"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}]}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], ",",
             "quandleRuleExpandApp2", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"Depth", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}]}], 
           "}"}]}], "]"}],
        HoldForm], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
               "<", "3"}], ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["0",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
               "<", "3"}], ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["1",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
               "<", "3"}], ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["2",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}], 
               "<", "3"}], ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                  "]"}]}], "}"}]}], "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], 
                   "]"}]}], "}"}]}], "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["3",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "3"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "3"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "c"}], "]"}], "}"}]}], "}"}],
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"c", ",", "c"}], "]"}], "}"}]}], "}"}], "\[Union]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"c", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"c", ",", "c"}], "]"}], "}"}]}], "}"}]}],
      HoldForm], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{"c", ",", "c"}], "]"}], "}"}], "}"}],
      HoldForm]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox["CleanupList",
      HoldForm], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[Rule]", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"app", "[", "a_", "]"}], "\[Rule]", "a"}]}], "}"}],
      HoldForm]}], "}"}], ",", 
   TagBox[
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"app", "[", 
        RowBox[{"c", ",", "c"}], "]"}], "}"}], "}"}], "/.", 
     "\[VeryThinSpace]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"app", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[Rule]", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"app", "[", "a_", "]"}], "\[Rule]", "a"}]}], "}"}]}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"app", "[", 
       RowBox[{"c", ",", "c"}], "]"}], "}"}], "}"}],
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{{3.635706940342599*^9, 3.635706976588798*^9}, 
   3.6366493595862427`*^9, 3.6366504962230563`*^9, 3.636669846599457*^9, 
   3.636744828913185*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"d", ",", "e"}], "]"}], ",", "f"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635707193915585*^9, 3.6357071965379868`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"d", ",", "e"}], "]"}], ",", "f"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"d", ",", "f"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"e", ",", "f"}], "]"}]}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.635707198868412*^9, 3.636649359600243*^9, 
  3.6366504962360573`*^9, 3.636669846659853*^9, 3.6367448289651885`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trace", "[", 
  RowBox[{"QuandleTrefoilRewrite3", "[", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"a", ",", "a"}], "]"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"b", ",", "b"}], "]"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635445760727517*^9, 3.635445763784669*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"QuandleTrefoilRewrite3", "[", 
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "a"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"b", ",", "b"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
    HoldForm], ",", 
   TagBox[
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"TrefoilRewrite", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], ",", 
          "quandleRuleExpandApp2", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Depth", "[", 
            RowBox[{"app", "[", 
             RowBox[{
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "a"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"b", ",", "b"}], "]"}], ",", 
              RowBox[{"app", "[", 
               RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "+", "1"}]}], 
         "}"}]}], "]"}], "\[Union]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"TrefoilRewrite", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], ",", 
          "quandleRuleExpandApp2", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{"Depth", "[", 
           RowBox[{"app", "[", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "a"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"b", ",", "b"}], "]"}], ",", 
             RowBox[{"app", "[", 
              RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
       "]"}]}], "/.", "\[VeryThinSpace]", "CleanupList"}],
    HoldForm], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], ",", 
            "quandleRuleExpandApp2", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{
             RowBox[{"Depth", "[", 
              RowBox[{"app", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "a"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"b", ",", "b"}], "]"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "+", "1"}]}],
            "}"}]}], "]"}],
        HoldForm], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "<", "3"}],
               ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["0",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "0"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "<", "3"}],
               ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["1",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "1"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "<", "3"}],
               ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["2",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "2"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "<", "3"}],
               ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["3",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "3"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "<", "3"}],
               ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["i",
            HoldForm], ",", 
           TagBox["4",
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", "4"}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}]}], "}"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       TagBox[
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], ",", 
            "quandleRuleExpandApp2", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"Depth", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
         "]"}],
        HoldForm], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "<", "3"}],
               ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["0",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "<", "3"}],
               ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["1",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "<", "3"}],
               ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["2",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           TagBox[
            RowBox[{"TrefoilRewrite", "[", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "a"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "b"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Depth", "[", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}], "<", "3"}],
               ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               TagBox[
                RowBox[{"Depth", "[", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}],
                HoldForm], ",", 
               TagBox["3",
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"3", "<", "3"}],
              HoldForm], ",", 
             TagBox["False",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"If", "[", 
             RowBox[{"False", ",", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "a"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"b", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                "Trefoilrules"}], "]"}], ",", 
              RowBox[{"Union", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                   "Trefoilrules", ",", "i"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", 
                   RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                 "]"}], "]"}]}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                 "Trefoilrules", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", 
                 RowBox[{"Depth", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
               "]"}], "]"}],
            HoldForm], ",", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  "Trefoilrules", ",", "i"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "3", ",", 
                  RowBox[{"Depth", "[", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                "]"}],
              HoldForm], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 TagBox["Trefoilrules",
                  HoldForm], ",", 
                 TagBox[
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                  
                  HoldForm]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 TagBox["i",
                  HoldForm], ",", 
                 TagBox["3",
                  HoldForm]}], "}"}], ",", 
               TagBox[
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "c"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "a"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "b"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], "\[Rule]", "c"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "a"}], "]"}], "\[Rule]", "a"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"b", ",", "b"}], "]"}], "\[Rule]", "b"}], ",", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "c"}], "]"}], "\[Rule]", "c"}]}], "}"}],
                   ",", "3"}], "]"}],
                HoldForm], ",", 
               TagBox[
                RowBox[{"app", "[", 
                 RowBox[{"a", ",", "b", ",", "c"}], "]"}],
                HoldForm]}], "}"}], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"app", "[", 
               RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "]"}],
            HoldForm], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           TagBox["quandleRuleExpandApp2",
            HoldForm], ",", 
           TagBox[
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}],
            HoldForm]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             TagBox["i",
              HoldForm], ",", 
             TagBox["3",
              HoldForm]}], "}"}], ",", 
           TagBox[
            RowBox[{"{", 
             RowBox[{"0", ",", "3"}], "}"}],
            HoldForm]}], "}"}], ",", 
         TagBox[
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"app", "[", 
              RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
            RowBox[{
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a__", ",", "b__"}], "]"}], ",", "c__"}], "]"}], 
             "\[Rule]", 
             RowBox[{"app", "[", 
              RowBox[{
               RowBox[{"app", "[", 
                RowBox[{"a", ",", "c"}], "]"}], ",", 
               RowBox[{"app", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "3"}], "}"}]}], "]"}],
          HoldForm], ",", 
         TagBox[
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}],
          HoldForm]}], "}"}], ",", 
       TagBox[
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}]}], "}"}],
        HoldForm]}], "}"}], ",", 
     TagBox[
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}]}], "}"}], 
       "\[Union]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}]}], "}"}]}],
      HoldForm], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"app", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "}"}],
      HoldForm]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     TagBox["CleanupList",
      HoldForm], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[Rule]", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"app", "[", "a_", "]"}], "\[Rule]", "a"}]}], "}"}],
      HoldForm]}], "}"}], ",", 
   TagBox[
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"app", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], "}"}], "}"}], "/.", 
     "\[VeryThinSpace]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"app", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[Rule]", 
        RowBox[{"app", "[", 
         RowBox[{
          RowBox[{"app", "[", 
           RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"app", "[", "a_", "]"}], "\[Rule]", "a"}]}], "}"}]}],
    HoldForm], ",", 
   TagBox[
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"app", "[", 
       RowBox[{
        RowBox[{"app", "[", 
         RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], "}"}],
    HoldForm]}], "}"}]], "Output",
 CellChangeTimes->{3.635445764604718*^9, 3.6354476468675323`*^9, 
  3.6354479224740543`*^9, 3.635549159568918*^9, 3.6357051395890903`*^9, 
  3.6366493596602592`*^9, 3.6366504962960606`*^9, 3.6366698467332363`*^9, 
  3.6367448290222044`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"H", ",", "a"}], "]"}], ",", "b"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.63544745202384*^9, {3.635707620646707*^9, 3.6357076323173637`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "b"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.635707634919174*^9, 3.636649359676265*^9, 
  3.6366504963110623`*^9, 3.636669846792946*^9, 3.636744829037206*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "b"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6357076477800083`*^9, 3.635707652481942*^9}, {
  3.635707695787442*^9, 3.6357077046676073`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "b"}], "]"}], ",", "c"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "c"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.635707653270432*^9, {3.63570770214564*^9, 3.6357077054735394`*^9}, 
   3.636649359685261*^9, 3.636650496317048*^9, 3.6366698468275833`*^9, 
   3.6367448290432067`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6357076719081707`*^9, 3.635707693539912*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "c"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"b", ",", "c"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.635707719595765*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "a"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "c"}], "]"}], ",", "a"}], "]"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6357077223857613`*^9, 3.636649359697262*^9, 
  3.636650496325063*^9, 3.6366698469955387`*^9, 3.636744829052207*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "c"}], "]"}], ",", "a"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.63570775233585*^9, 3.63570775682176*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "a"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "c"}], "]"}], ",", "a"}], "]"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6357077573871727`*^9, 3.636649359706249*^9, 
  3.63665049633006*^9, 3.636669847031632*^9, 3.636744829059211*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QuandleTrefoilRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "a"}], "]"}], ",", 
    RowBox[{"app", "[", 
     RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.635707769355801*^9, 3.635707773396647*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "b"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6357077739615192`*^9, 3.63664935971325*^9, 
  3.63665049633506*^9, 3.636669847078116*^9, 3.636744829066212*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MemberQ", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{"QuandleTrefoilRewrite3", "[", 
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"F", ",", "a"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6365764877206163`*^9, 3.63657652917197*^9}, {
  3.6365765739635744`*^9, 3.63657664682876*^9}, {3.636649346831559*^9, 
  3.6366493541829405`*^9}, {3.6366598644156823`*^9, 3.636659875033311*^9}, {
  3.6366602262531433`*^9, 3.636660229384328*^9}, {3.6366606273109274`*^9, 
  3.636660638168555*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.636576589965497*^9, 3.6365766472707853`*^9}, {
   3.636649355167018*^9, 3.636649359721263*^9}, 3.636650496340063*^9, {
   3.6366606344183326`*^9, 3.6366606389836197`*^9}, 3.636669847109764*^9, 
   3.6367448290722055`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Trace", "[", 
  RowBox[{"Reap", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"x", ",", 
       RowBox[{"QuandleSearchRec", "[", 
        RowBox[{"x", ",", "1", ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{"QuandleTrefoilRewrite3", "[", 
       RowBox[{"app", "[", 
        RowBox[{
         RowBox[{"app", "[", 
          RowBox[{"F", ",", "a"}], "]"}], ",", 
         RowBox[{"app", "[", 
          RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}], "]"}]}], "]"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.63667243131107*^9, 3.6366724666480923`*^9}, {
   3.636743252866761*^9, 3.6367433110521684`*^9}, 3.636744871620747*^9, {
   3.6367452868943825`*^9, 3.6367453865222793`*^9}, {3.6367477360496254`*^9, 
   3.6367477392758164`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Attributes", "::", "attnf"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(currentRewrite$12337\\)\[NoBreak] is not a \
known attribute. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Attributes/attnf\\\", ButtonNote -> \
\\\"Attributes::attnf\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.6367453773237133`*^9, 3.6367453871143236`*^9}, 
   3.6367477397758245`*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Reap", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"x", ",", 
               RowBox[{"QuandleSearchRec", "[", 
                RowBox[{"x", ",", "1", ",", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}]}], 
                "]"}]}], "]"}], "/@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"QuandleTrefoilRewrite3", "[", 
               RowBox[{"app", "[", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{"F", ",", "a"}], "]"}], ",", 
                 RowBox[{"app", "[", 
                  RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"QuandleTrefoilRewrite3", "[", 
                  RowBox[{"app", "[", 
                   RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"TrefoilRewrite", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}], ",", 
                    "quandleRuleExpandApp2", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}], "+", 
                    "1"}]}], "}"}]}], "]"}], "\[Union]", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"TrefoilRewrite", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}], ",", 
                    "quandleRuleExpandApp2", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", 
                    RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                     "]"}]}], "/.", "\[VeryThinSpace]", "CleanupList"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"TrefoilRewrite", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}], ",", 
                    "quandleRuleExpandApp2", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}], "+", 
                    "1"}]}], "}"}]}], "]"}], ",", 
                    TemplateBox[{"5"},
                    "OutputSizeLimit`Skeleton",
                    DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}]}],
                     "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"TrefoilRewrite", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}], ",", 
                    "quandleRuleExpandApp2", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "i"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", 
                    RowBox[{"Depth", "[", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "]"}]}], "}"}]}],
                     "]"}], ",", 
                    TemplateBox[{"4"},
                    "OutputSizeLimit`Skeleton",
                    DisplayFunction->(FrameBox[
                    
                    RowBox[{
                    "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                    Background -> GrayLevel[0.75], 
                    BaseStyle -> {
                    "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                    ShowStringCharacters -> False}, BaselinePosition -> 
                    Baseline, ContentPadding -> False, FrameMargins -> 1, 
                    FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}]}],
                     "}"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}], 
                    "\[Union]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}]}],
                    ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}]}],
                   "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"CleanupList", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[Rule]", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], ",", 
                    
                    RowBox[{
                    RowBox[{"app", "[", "a_", "]"}], "\[Rule]", "a"}]}], 
                    "}"}]}], "}"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}], "/.",
                   "\[VeryThinSpace]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[Rule]", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}], ",", "c"}], "]"}]}], ",", 
                    
                    RowBox[{
                    RowBox[{"app", "[", "a_", "]"}], "\[Rule]", "a"}]}], 
                   "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}]}],
                 "}"}], ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "}"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}], "}"}]}], "}"}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], ",", 
                 RowBox[{"app", "[", 
                  RowBox[{
                   RowBox[{"app", "[", 
                    RowBox[{"F", ",", "b"}], "]"}], ",", 
                   RowBox[{"app", "[", 
                    RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], "}"}]}], "}"}],
              ",", 
             TemplateBox[{"4"},
              "OutputSizeLimit`Skeleton",
              DisplayFunction->(FrameBox[
                
                RowBox[{
                 "\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
                Background -> GrayLevel[0.75], 
                BaseStyle -> {
                 "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
                  ShowStringCharacters -> False}, BaselinePosition -> 
                Baseline, ContentPadding -> False, FrameMargins -> 1, 
                FrameStyle -> GrayLevel[0.75], RoundingRadius -> 7]& )], ",", 
             
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{"Function", "[", 
                 RowBox[{"x$", ",", 
                  RowBox[{"QuandleSearchRec", "[", 
                   RowBox[{"x$", ",", 
                    RowBox[{"1", "-", "1"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}]}], 
                   "]"}], ",", "currentRewrite$12337"}], "]"}], "]"}]}], 
              "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{"Function", "[", 
                 RowBox[{"x$", ",", 
                  RowBox[{"QuandleSearchRec", "[", 
                   RowBox[{"x$", ",", 
                    RowBox[{"1", "-", "1"}], ",", 
                    RowBox[{"app", "[", 
                    RowBox[{
                    RowBox[{"app", "[", 
                    RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}]}], 
                   "]"}], ",", "currentRewrite$12337"}], "]"}], "]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"app", "[", 
                 RowBox[{
                  RowBox[{"app", "[", 
                   RowBox[{"F", ",", "b"}], "]"}], ",", 
                  RowBox[{"app", "[", 
                   RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], "}"}], "}"}]}], 
            "}"}]}], "}"}],
         Short[#, 20]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{65., {3., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{52., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 159, 24956442114137222676, 20/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{62., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 159, 24956442114137222676, 20 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{44., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 159, 24956442114137222676, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{78., {1., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[159]]], "Output",
 CellChangeTimes->{{3.636745363196909*^9, 3.636745387119293*^9}, 
   3.63674773984784*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"QuandleTrefoilRewrite3", "[", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], ",", 
   RowBox[{"app", "[", 
    RowBox[{
     RowBox[{"app", "[", 
      RowBox[{"F", ",", "b"}], "]"}], ",", 
     RowBox[{"app", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.636744900001423*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6367448794471865`*^9, 3.6367448794862194`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.636743311533222*^9, {3.6367448290782056`*^9, 3.6367448412849226`*^9}, 
   3.6367448817283525`*^9}],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.636743311533222*^9, {3.6367448290782056`*^9, 3.636744839525818*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6367448377747116`*^9, 3.6367448377977324`*^9}, {
  3.636746992977544*^9, 3.636746993480582*^9}, {3.636747730103261*^9, 
  3.636747730152253*^9}}],

Cell[BoxData[
 RowBox[{"QuandleTrefoileRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.636744802933672*^9, 3.6367448230488725`*^9}}],

Cell[BoxData[
 RowBox[{"QuandleTrefoileRewrite3", "[", 
  RowBox[{"app", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{{3.6367448040427456`*^9, 3.636744852401615*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"QuandleSearch", "[", " ", 
   RowBox[{"element_", ",", "threshold_", ",", "target_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{
   RowBox[{"Sow", "[", "target", "]"}], 
   RowBox[{"QuandleSearchRec", "[", 
    RowBox[{"element", ",", "threshold", ",", "target"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.6366370253642187`*^9, 3.636637028538393*^9}, 
   3.6366381864418354`*^9, {3.6366493149677553`*^9, 3.6366493253313427`*^9}, {
   3.6366668634507575`*^9, 3.6366669067133455`*^9}, {3.636669727140193*^9, 
   3.636669762807105*^9}, {3.636669829655966*^9, 3.636669830520701*^9}, {
   3.6366724446461153`*^9, 3.636672483296183*^9}, {3.63667253298962*^9, 
   3.636672533435205*^9}, {3.6366727786406507`*^9, 3.636672781296936*^9}, {
   3.6367450009184217`*^9, 3.636745005521698*^9}, {3.6367452137060213`*^9, 
   3.636745216845196*^9}, {3.6367493657532673`*^9, 3.6367493869925375`*^9}, {
   3.63674941757833*^9, 3.6367494197894773`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6366505071966944`*^9, 3.6366505072086954`*^9}, 
   3.636659857457264*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"QuandleSearchRec", "[", 
    RowBox[{"element_", ",", "threshold_", ",", "target_"}], " ", "]"}], ":=",
    " ", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"currentRewrite", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"QuandleTrefoilRewrite3", "[", "element", "]"}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", "\t\t  ", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"element", " ", "\[NotEqual]", "Null"}], ",", " ", 
        RowBox[{"Sow", "[", "element", "]"}], ",", 
        RowBox[{"Return", "[", "]"}]}], "]"}], " ", ";", 
      "\[IndentingNewLine]", "\t     ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"currentRewrite", ",", "target"}], "]"}], " ", "||", " ", 
          RowBox[{"threshold", " ", "\[Equal]", " ", "0"}]}], " ", ")"}], ",", 
        RowBox[{"Return", "[", "]"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{"Function", "[", 
          RowBox[{"x", ",", 
           RowBox[{"QuandleSearchRec", "[", 
            RowBox[{"x", ",", 
             RowBox[{"threshold", "--"}], " ", ",", "target"}], "]"}], ",", 
           "currentRewrite"}], "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.636649488274545*^9, 3.6366495776975737`*^9}, {
   3.636650521897566*^9, 3.636650543523865*^9}, {3.636660586282461*^9, 
   3.6366606493222027`*^9}, {3.6366610408594246`*^9, 
   3.6366610710142436`*^9}, {3.636663183452506*^9, 3.636663198846436*^9}, {
   3.6366633847634687`*^9, 3.6366634885885916`*^9}, {3.6366645370868053`*^9, 
   3.6366645821104574`*^9}, {3.636665153546361*^9, 3.6366651794389043`*^9}, {
   3.636665801739797*^9, 3.6366658180847797`*^9}, {3.636668475338359*^9, 
   3.636668548295685*^9}, {3.636669702047381*^9, 3.6366697044161797`*^9}, {
   3.6366697505793447`*^9, 3.6366698014716473`*^9}, {3.636669913797118*^9, 
   3.636669941952228*^9}, {3.636671059872505*^9, 3.636671074634472*^9}, {
   3.636672597700952*^9, 3.636672652206726*^9}, {3.636672758304699*^9, 
   3.636672790048925*^9}, {3.6366728206738453`*^9, 3.6366728273406754`*^9}, {
   3.6367449538886085`*^9, 3.6367449640972166`*^9}, {3.636745025936898*^9, 
   3.6367450289640865`*^9}, {3.636745151703335*^9, 3.6367451609658813`*^9}, {
   3.6367452000572023`*^9, 3.6367452730865498`*^9}, {3.6367454058334265`*^9, 
   3.63674541534*^9}, {3.6367470087215*^9, 3.6367470292186813`*^9}, {
   3.6367480372544937`*^9, 3.6367480388525925`*^9}, {3.6367480884715185`*^9, 
   3.636748114953077*^9}, {3.636748153184355*^9, 3.636748156279527*^9}, 
   3.636748310628706*^9, {3.6367491646843424`*^9, 3.6367491962332125`*^9}, {
   3.636749232824394*^9, 3.6367492369156446`*^9}, {3.636749306451755*^9, 
   3.6367493126541348`*^9}, {3.6367493541765985`*^9, 
   3.6367493599349356`*^9}, {3.636749614630018*^9, 3.6367496799179263`*^9}, {
   3.636749713010873*^9, 3.636749737085313*^9}, {3.6367498233754325`*^9, 
   3.6367498332220035`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reap", "[", 
  RowBox[{"QuandleSearch", "[", 
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "a"}], "]"}], ",", "b"}], "]"}], ",", "1", ",", 
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "a"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"c", ",", "a"}], "]"}]}], "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.636669710766921*^9, 3.636669720993004*^9}, {
  3.636669783980641*^9, 3.636669788469768*^9}, {3.63666985786021*^9, 
  3.636669858811625*^9}, {3.636745042939883*^9, 3.6367450452910476`*^9}, {
  3.636745129410042*^9, 3.636745145071971*^9}, {3.6367456698650613`*^9, 
  3.6367456721131935`*^9}, {3.636748144414822*^9, 3.6367481469339924`*^9}, {
  3.6367483294418287`*^9, 3.636748338457362*^9}, {3.636749326555954*^9, 
  3.636749326711962*^9}, {3.636749660055731*^9, 3.636749660326746*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Set", "::", "write"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tag \[NoBreak]\\!\\(Times\\)\[NoBreak] in \
\[NoBreak]\\!\\(subthreshold\\\\ \\(\\({\\(\\(app[\\(\\(\\(\\(app[\\(\\(F, \
a\\)\\)]\\)\\), b\\)\\)]\\)\\), \\(\\(app[\\(\\(\\(\\(app[\\(\\(F, \
b\\)\\)]\\)\\), \\(\\(app[\\(\\(a, b\\)\\)]\\)\\)\\)\\)]\\)\\)}\\)\\)\\)\
\[NoBreak] is Protected. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/write\\\", ButtonNote -> \
\\\"Set::write\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.6367496609597635`*^9, 3.6367496870653114`*^9}, 
   3.6367497447047305`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Attributes", "::", "attnf"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(currentRewrite$21326\\)\[NoBreak] is not a \
known attribute. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Attributes/attnf\\\", ButtonNote -> \
\\\"Attributes::attnf\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.6367496609597635`*^9, 3.6367496870653114`*^9}, 
   3.6367497447387486`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"app", "[", 
     RowBox[{
      RowBox[{"app", "[", 
       RowBox[{"F", ",", "a"}], "]"}], ",", 
      RowBox[{"app", "[", 
       RowBox[{"c", ",", "a"}], "]"}]}], "]"}], " ", 
    RowBox[{"Map", "[", 
     RowBox[{"Function", "[", 
      RowBox[{"x$", ",", 
       RowBox[{"QuandleSearchRec", "[", 
        RowBox[{"x$", ",", "subthreshold", ",", 
         RowBox[{"app", "[", 
          RowBox[{
           RowBox[{"app", "[", 
            RowBox[{"F", ",", "a"}], "]"}], ",", 
           RowBox[{"app", "[", 
            RowBox[{"c", ",", "a"}], "]"}]}], "]"}]}], "]"}], ",", 
       "currentRewrite$21326"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"app", "[", 
      RowBox[{
       RowBox[{"app", "[", 
        RowBox[{"F", ",", "a"}], "]"}], ",", 
       RowBox[{"app", "[", 
        RowBox[{"c", ",", "a"}], "]"}]}], "]"}], "}"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6367449217427163`*^9, 3.636744968147445*^9, {3.6367450129961376`*^9, 
   3.6367450460530815`*^9}, 3.636745133147231*^9, 3.6367456234323387`*^9, 
   3.6367470458756704`*^9, {3.6367481211524525`*^9, 3.636748147402026*^9}, {
   3.636748313213852*^9, 3.636748339061399*^9}, 3.6367494327842407`*^9, {
   3.6367496527112923`*^9, 3.636749687069312*^9}, 3.636749744741749*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6367449187535377`*^9, 3.636744918800543*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"binSearch", "[", 
    RowBox[{"lst_", ",", "threshold_"}], "]"}], ":=", 
   RowBox[{"binSearchRec", "[", 
    RowBox[{"lst", ",", "threshold", ",", "1", ",", 
     RowBox[{"Length", "@", "lst"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "return", " ", "position", " ", "of", " ", "leftmost", " ", "element", " ",
     "greater", " ", "than", " ", "threshold", " ", "breaks", " ", "if", " ", 
    "the", " ", "first", " ", "element", " ", "is", " ", "greater", " ", 
    "than", " ", "threshold", " ", "lst", " ", "must", " ", "be", " ", 
    "sorted"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"binSearchRec", "[", 
   RowBox[{"lst_", ",", "threshold_", ",", "min_", ",", "max_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"min", "+", "max"}], ")"}], "/", "2"}], "]"}]}], ",", 
      "element"}], "}"}], ",", "\[IndentingNewLine]", "\t     ", 
    RowBox[{
     RowBox[{"element", "=", 
      RowBox[{"lst", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"min", "\[Equal]", "max"}], ",", "max", ",", 
       RowBox[{"element", "\[LessEqual]", "threshold"}], ",", 
       RowBox[{"binSearchRec", "[", 
        RowBox[{"lst", ",", "threshold", ",", 
         RowBox[{"i", "+", "1"}], ",", "max"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"element", ">", "threshold"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lst", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], "\[LessEqual]", 
          "threshold"}], ")"}]}], ",", "i", ",", "True", ",", 
       RowBox[{"binSearchRec", "[", 
        RowBox[{"lst", ",", "threshold", ",", "min", ",", 
         RowBox[{"i", "-", "1"}]}], "]"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6359676450795393`*^9, 3.635967655271161*^9}, {
  3.635968213510141*^9, 3.635968226253183*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"binSearch", "[", 
    RowBox[{"lst_", ",", "threshold_"}], "]"}], ":=", 
   RowBox[{"binSearchRec", "[", 
    RowBox[{"lst", ",", "threshold", ",", "1", ",", 
     RowBox[{"Length", "@", "lst"}]}], "]"}]}], "\n", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "return", " ", "position", " ", "of", " ", "leftmost", " ", "element", " ",
     "greater", " ", "than", " ", "threshold", " ", "breaks", " ", "if", " ", 
    "the", " ", "first", " ", "element", " ", "is", " ", "greater", " ", 
    "than", " ", "threshold", " ", "lst", " ", "must", " ", "be", " ", 
    "sorted"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binSearchRec", "[", 
   RowBox[{"input_", ",", "threshold_", ",", "currentlist_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"min", "+", "max"}], ")"}], "/", "2"}], "]"}]}], ",", 
      "element"}], "}"}], ",", "\[IndentingNewLine]", "\t     ", 
    RowBox[{
     RowBox[{"element", "=", 
      RowBox[{"lst", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t    ", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"min", "\[Equal]", "max"}], ",", "max", ",", 
       RowBox[{"element", "\[LessEqual]", "threshold"}], ",", 
       RowBox[{"binSearchRec", "[", 
        RowBox[{"lst", ",", "threshold", ",", 
         RowBox[{"i", "+", "1"}], ",", "max"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"element", ">", "threshold"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lst", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}], "\[LessEqual]", 
          "threshold"}], ")"}]}], ",", "i", ",", "True", ",", 
       RowBox[{"binSearchRec", "[", 
        RowBox[{"lst", ",", "threshold", ",", "min", ",", 
         RowBox[{"i", "-", "1"}]}], "]"}]}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6366369424825583`*^9, 3.6366369444216213`*^9}, {
  3.6366490979904947`*^9, 3.636649113184332*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Design", " ", "the", " ", "searcher", " ", "to", " ", "return", " ", 
    "every", " ", "path"}], ",", " ", 
   RowBox[{
   "explore", " ", "the", " ", "tree", " ", "given", " ", "a", " ", 
    "depth"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.636311725475211*^9, 3.6363117451786203`*^9}}]
},
WindowSize->{1024, 719},
WindowMargins->{{Automatic, 0}, {53, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 141, 2, 31, "Input"],
Cell[702, 24, 94, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[821, 29, 8335, 239, 793, "Input"],
Cell[9159, 270, 1160, 18, 35, "Output"],
Cell[10322, 290, 1520, 31, 35, "Output"],
Cell[11845, 323, 2081, 49, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13963, 377, 655, 19, 31, "Input"],
Cell[14621, 398, 1602, 43, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16260, 446, 678, 20, 31, "Input"],
Cell[16941, 468, 1763, 48, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18741, 521, 604, 19, 42, "Input"],
Cell[19348, 542, 928, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20313, 563, 733, 24, 66, "Input"],
Cell[21049, 589, 1706, 52, 31, "Output"]
}, Open  ]],
Cell[22770, 644, 87, 1, 31, "Input"],
Cell[22860, 647, 92, 1, 31, "Input"],
Cell[22955, 650, 164, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[23144, 656, 406, 12, 31, "Input"],
Cell[23553, 670, 711, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24301, 688, 411, 13, 31, "Input"],
Cell[24715, 703, 880, 16, 21, "Message"],
Cell[25598, 721, 1186, 30, 31, "Output"]
}, Open  ]],
Cell[26799, 754, 87, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[26911, 759, 493, 12, 64, "Input"],
Cell[27407, 773, 754, 14, 35, "Output"],
Cell[28164, 789, 671, 11, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28872, 805, 482, 11, 52, "Input"],
Cell[29357, 818, 612, 10, 31, "Output"],
Cell[29972, 830, 969, 17, 21, "Message"],
Cell[30944, 849, 12119, 308, 171, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43100, 1162, 1523, 46, 112, "Input"],
Cell[44626, 1210, 683, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45346, 1227, 679, 18, 52, "Input"],
Cell[46028, 1247, 671, 12, 31, "Output"],
Cell[46702, 1261, 1811, 52, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48550, 1318, 2170, 51, 212, "Input"],
Cell[50723, 1371, 740, 12, 31, "Output"],
Cell[51466, 1385, 740, 12, 31, "Output"],
Cell[52209, 1399, 738, 12, 31, "Output"],
Cell[52950, 1413, 740, 12, 31, "Output"],
Cell[53693, 1427, 738, 12, 31, "Output"],
Cell[54434, 1441, 740, 12, 31, "Output"],
Cell[55177, 1455, 738, 12, 31, "Output"],
Cell[55918, 1469, 740, 12, 31, "Output"],
Cell[56661, 1483, 740, 12, 31, "Output"]
}, Open  ]],
Cell[57416, 1498, 92, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[57533, 1503, 680, 12, 52, "Input"],
Cell[58216, 1517, 1654, 40, 52, "Output"]
}, Open  ]],
Cell[59885, 1560, 290, 4, 31, "Input"],
Cell[60178, 1566, 1990, 36, 52, "Input"],
Cell[CellGroupData[{
Cell[62193, 1606, 381, 12, 31, "Input"],
Cell[62577, 1620, 737, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63351, 1642, 483, 11, 72, "Input"],
Cell[63837, 1655, 1415, 20, 31, "Output"],
Cell[65255, 1677, 1415, 20, 31, "Output"],
Cell[66673, 1699, 1417, 20, 31, "Output"]
}, Open  ]],
Cell[68105, 1722, 96, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[68226, 1727, 422, 12, 31, "Input"],
Cell[68651, 1741, 684, 11, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69372, 1757, 338, 10, 31, "Input"],
Cell[69713, 1769, 338, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70088, 1781, 538, 13, 31, "Input"],
Cell[70629, 1796, 16301, 465, 392, "Output"]
}, Open  ]],
Cell[86945, 2264, 149, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[87119, 2270, 1517, 40, 112, "Input"],
Cell[88639, 2312, 1403, 33, 31, "Output"],
Cell[90045, 2347, 1866, 46, 52, "Output"],
Cell[91914, 2395, 992, 19, 31, "Output"],
Cell[92909, 2416, 961, 19, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93907, 2440, 386, 9, 52, "Input"],
Cell[94296, 2451, 673, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95006, 2473, 300, 8, 31, "Input"],
Cell[95309, 2483, 835, 22, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96181, 2510, 335, 9, 31, "Input"],
Cell[96519, 2521, 444, 9, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97000, 2535, 203, 5, 31, "Input"],
Cell[97206, 2542, 422, 8, 31, "Output"]
}, Open  ]],
Cell[97643, 2553, 120, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[97788, 2559, 469, 13, 36, "Input"],
Cell[98260, 2574, 647, 12, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98944, 2591, 640, 15, 31, "Input"],
Cell[99587, 2608, 1546, 42, 31, "Output"]
}, Open  ]],
Cell[101148, 2653, 160, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[101333, 2660, 3776, 117, 152, "Input"],
Cell[105112, 2779, 4247, 124, 132, "Output"]
}, Open  ]],
Cell[109374, 2906, 90, 1, 31, "Input"],
Cell[109467, 2909, 1385, 31, 92, "Input"],
Cell[CellGroupData[{
Cell[110877, 2944, 340, 9, 31, "Input"],
Cell[111220, 2955, 658, 18, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111915, 2978, 787, 24, 52, "Input"],
Cell[112705, 3004, 682, 18, 31, "Output"],
Cell[113390, 3024, 683, 19, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114110, 3048, 382, 10, 31, "Input"],
Cell[114495, 3060, 39658, 1211, 972, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154190, 4276, 135, 4, 31, "Input"],
Cell[154328, 4282, 457, 10, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154822, 4297, 254, 6, 31, "Input"],
Cell[155079, 4305, 658, 18, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155774, 4328, 423, 12, 52, "Input"],
Cell[156200, 4342, 418, 9, 31, "Output"],
Cell[156621, 4353, 679, 18, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157337, 4376, 421, 12, 52, "Input"],
Cell[157761, 4390, 444, 9, 31, "Output"],
Cell[158208, 4401, 409, 8, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158654, 4414, 485, 13, 31, "Input"],
Cell[159142, 4429, 430, 9, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159609, 4443, 236, 6, 31, "Input"],
Cell[159848, 4451, 291, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160176, 4460, 278, 7, 31, "Input"],
Cell[160457, 4469, 702, 18, 31, "Output"]
}, Open  ]],
Cell[161174, 4490, 1014, 28, 72, "Input"],
Cell[CellGroupData[{
Cell[162213, 4522, 253, 6, 31, "Input"],
Cell[162469, 4530, 549, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163055, 4548, 252, 6, 31, "Input"],
Cell[163310, 4556, 680, 18, 31, "Output"]
}, Open  ]],
Cell[164005, 4577, 92, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[164122, 4582, 383, 10, 31, "Input"],
Cell[164508, 4594, 674, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165219, 4615, 419, 11, 31, "Input"],
Cell[165641, 4628, 66104, 1830, 1792, "Output"]
}, Open  ]],
Cell[231760, 6461, 120, 2, 31, "Input"],
Cell[231883, 6465, 120, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[232028, 6471, 2424, 65, 172, "Input"],
Cell[234455, 6538, 639, 14, 31, "Output"],
Cell[235097, 6554, 491, 9, 31, "Output"],
Cell[235591, 6565, 763, 18, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236391, 6588, 207, 4, 31, "Input"],
Cell[236601, 6594, 469, 10, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237107, 6609, 318, 6, 52, "Input"],
Cell[237428, 6617, 331, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237796, 6628, 429, 11, 31, "Input"],
Cell[238228, 6641, 553, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238818, 6659, 257, 6, 31, "Input"],
Cell[239078, 6667, 268, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239383, 6678, 292, 8, 31, "Input"],
Cell[239678, 6688, 107970, 2818, 2492, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[347685, 9511, 255, 6, 31, "Input"],
Cell[347943, 9519, 560, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[348540, 9540, 419, 11, 31, "Input"],
Cell[348962, 9553, 133500, 3362, 3592, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[482499, 12920, 279, 7, 31, "Input"],
Cell[482781, 12929, 558, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[483376, 12950, 364, 9, 31, "Input"],
Cell[483743, 12961, 615, 18, 31, "Output"]
}, Open  ]],
Cell[484373, 12982, 94, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[484492, 12987, 287, 8, 31, "Input"],
Cell[484782, 12997, 563, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[485382, 13019, 251, 6, 31, "Input"],
Cell[485636, 13027, 560, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[486233, 13049, 311, 8, 31, "Input"],
Cell[486547, 13059, 556, 16, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[487140, 13080, 791, 19, 31, "Input"],
Cell[487934, 13101, 275, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[488246, 13110, 987, 26, 52, "Input"],
Cell[489236, 13138, 525, 11, 21, "Message"],
Cell[489764, 13151, 27281, 655, 551, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[517082, 13811, 228, 7, 31, "Input"],
Cell[517313, 13820, 407, 13, 31, "Output"]
}, Open  ]],
Cell[517735, 13836, 96, 1, 31, InheritFromParent],
Cell[CellGroupData[{
Cell[517856, 13841, 199, 5, 23, "Print"],
Cell[518058, 13848, 169, 4, 23, "Print"]
}, Open  ]],
Cell[518242, 13855, 194, 3, 31, InheritFromParent],
Cell[518439, 13860, 256, 6, 31, InheritFromParent],
Cell[518698, 13868, 257, 6, 31, "Output"],
Cell[518958, 13876, 968, 18, 31, "Input"],
Cell[519929, 13896, 122, 2, 31, "Input"],
Cell[520054, 13900, 3082, 59, 112, "Input"],
Cell[CellGroupData[{
Cell[523161, 13963, 940, 20, 31, "Input"],
Cell[524104, 13985, 719, 14, 21, "Message"],
Cell[524826, 14001, 525, 11, 21, "Message"],
Cell[525354, 14014, 1358, 36, 72, "Output"]
}, Open  ]],
Cell[526727, 14053, 94, 1, 31, InheritFromParent],
Cell[526824, 14056, 2200, 54, 192, "Input"],
Cell[529027, 14112, 2198, 53, 192, "Input"],
Cell[531228, 14167, 349, 9, 31, "Input"]
}
]
*)

(* End of internal cache information *)
