(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    200111,       5220]
NotebookOptionsPosition[    191268,       4977]
NotebookOutlinePosition[    191623,       4993]
CellTagsIndexPosition[    191580,       4990]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{3.561292074922595*^9, 3.561479463391407*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5606100184990053`*^9, 3.560610022054803*^9}}],

Cell[BoxData[{
 RowBox[{"test", " ", "=", " ", 
  "\"\<((i))(((ab)(c)(e))((fg)(h))\>\""}], "\[IndentingNewLine]", 
 RowBox[{"test2", " ", "=", " ", "\"\<(ab)(c)\>\""}], "\[IndentingNewLine]", 
 RowBox[{"StringPosition", "[", 
  RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.557681825792185*^9, 3.557681837192683*^9}, {
  3.557682305387177*^9, 3.557682306344137*^9}, {3.5576823889056797`*^9, 
  3.5576824062746*^9}, {3.5576851634182167`*^9, 3.557685197970213*^9}, {
  3.559302149313135*^9, 3.5593021580403337`*^9}},
 FontFamily->"Courier New Bold",
 FontWeight->"Plain"],

Cell[BoxData[
 RowBox[{"letterlocation", " ", ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"StringPosition", "[", 
     RowBox[{"test", " ", ",", " ", 
      RowBox[{"StringExpression", "[", "LetterCharacter", "]"}]}], "]"}], 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.558870483077759*^9, 3.558870542451085*^9}, {
  3.5588877134078903`*^9, 3.558887749417005*^9}, {3.558974613915629*^9, 
  3.558974644333857*^9}}],

Cell[BoxData["letterlocation"], "Input",
 CellChangeTimes->{{3.558986097727613*^9, 3.558986107490096*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"18", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"23", ",", "24"}], "}"}]}], "}"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5586340741613913`*^9, 3.558634085565297*^9}},
 FontFamily->"Courier New Bold",
 FontWeight->"Plain"],

Cell[BoxData[
 RowBox[{"Interval", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"letterlocation", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"letterlocation", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.5589746527283287`*^9, 3.558974696687436*^9}, {
  3.558989046913872*^9, 3.558989062517734*^9}, {3.558991307497821*^9, 
  3.558991310926648*^9}}],

Cell[BoxData[
 RowBox[{"IntervalMemberQ", "[", 
  RowBox[{
   RowBox[{"Interval", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"letterlocation", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"letterlocation", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"StringPosition", "[", 
       RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.558991318917735*^9, 3.558991339695223*^9}, {
  3.558991373611957*^9, 3.558991393229006*^9}}],

Cell[BoxData[
 RowBox[{"StringReplacePart", "[", 
  RowBox[{"\"\<((i))(((ab)(c)(e))((fg)(h))\>\"", ",", 
   RowBox[{"+", "\"\<}(ac)\>\""}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "14"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5588091673144617`*^9, 3.55880918452509*^9}, {
  3.5588092235055532`*^9, 3.558809312151635*^9}, {3.558809342358584*^9, 
  3.558809343407119*^9}, {3.55881054555333*^9, 3.558810630894862*^9}}],

Cell[BoxData["\"\<((i))(((ab}(ac)(e))((fg)(h))\>\""], "Input",
 CellChangeTimes->{3.558810642753138*^9}],

Cell[BoxData[
 RowBox[{"StringJoin", "[", 
  RowBox[{"\"\<)(\>\"", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"test", ",", 
        RowBox[{"{", "10", "}"}]}], "]"}], ",", 
      RowBox[{"StringTake", "[", 
       RowBox[{"test", ",", 
        RowBox[{"{", "13", "}"}]}], "]"}], ",", "\"\<)\>\""}], " ", "]"}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.558810647871645*^9, 3.5588106533945217`*^9}, {
  3.5588108329141207`*^9, 3.558810946251842*^9}, {3.5588113424026613`*^9, 
  3.5588113728560534`*^9}, {3.558811470818061*^9, 3.558811510806686*^9}, {
  3.558811602581271*^9, 3.55881177180171*^9}, {3.55881181344153*^9, 
  3.55881190383916*^9}, {3.5588152900343733`*^9, 3.558815364343465*^9}}],

Cell[BoxData[
 RowBox[{"StringReplacePart", "[", 
  RowBox[{"\"\<((i))(((ab)(c)(e))((fg)(h))\>\"", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<)(\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"test", ",", 
          RowBox[{"{", "10", "}"}]}], "]"}], ",", 
        RowBox[{"StringTake", "[", 
         RowBox[{"test", ",", 
          RowBox[{"{", "13", "}"}]}], "]"}], ",", "\"\<)\>\""}], " ", "]"}], 
      "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "14"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.5588119284371862`*^9, 3.558815377274991*^9}],

Cell[BoxData[
 RowBox[{"StringReplacePart", "[", 
  RowBox[{"test", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<)(\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"test", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"StringTake", "[", 
         RowBox[{"test", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], "}"}]}], 
         "]"}], ",", "\"\<)\>\""}], " ", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "+", "2"}]}], " ", "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.558816109950344*^9, 3.558816111403842*^9}, {
  3.558816142293935*^9, 3.558816143640683*^9}, {3.558816250570071*^9, 
  3.558816308378716*^9}, {3.5588165020917273`*^9, 3.5588165609960823`*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", " ", "\[LessEqual]", 
    RowBox[{"Length", "[", 
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}]}], ",", 
   RowBox[{"++", "i"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.558816324077179*^9, 3.5588163458942547`*^9}, {
  3.558816378622542*^9, 3.558816401571444*^9}, {3.558816566849791*^9, 
  3.558816583288423*^9}, {3.5588166175108423`*^9, 3.558816617677846*^9}, {
  3.5588168911667643`*^9, 3.558816893407948*^9}, {3.558968394874856*^9, 
  3.558968395159429*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.558974530462698*^9, 3.5589745515900307`*^9}, {
  3.558974591876574*^9, 3.558974606868155*^9}}],

Cell[BoxData[
 RowBox[{"StringReplacePart", "[", 
  RowBox[{"test", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<)(\>\"", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"test", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"StringTake", "[", 
         RowBox[{"test", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
              RowBox[{"[", "5", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], "}"}]}], 
         "]"}], ",", "\"\<)\>\""}], " ", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "5", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "+", "2"}]}], " ", "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5588168990992327`*^9, 3.558816928343733*^9}, {
  3.5588169641478252`*^9, 3.558816993723534*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "}"}]], "Input",
 CellChangeTimes->{{3.558816239700495*^9, 3.558816243437904*^9}}],

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"StringPosition", "[", 
   RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.5588165979970284`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5588158875583076`*^9, 3.5588159116318283`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.558815980571396*^9, {3.558816095944335*^9, 3.558816107217064*^9}}],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{"  ", 
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.558634527273622*^9, 3.5586345798638372`*^9}, {
   3.5586355528458643`*^9, 3.5586355755438967`*^9}, {3.5586367469746733`*^9, 
   3.558636775550192*^9}, 3.558810619460312*^9},
 FontFamily->"Courier New Bold",
 FontWeight->"Plain"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.558641247977735*^9, 3.55864125961722*^9}}],

Cell[BoxData[
 RowBox[{"toDistribute", " ", ":=", " ", 
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.558636705709742*^9, 3.558636730908836*^9}, {
  3.5586367781810427`*^9, 3.5586368378041553`*^9}, {3.558637449363912*^9, 
  3.5586374498113422`*^9}, {3.558638332035138*^9, 3.558638352818012*^9}, {
  3.558638399817322*^9, 3.558638400352693*^9}},
 FontFamily->"Courier New Bold",
 FontWeight->"Plain"],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test", ",", " ", 
   RowBox[{"Part", "[", 
    RowBox[{
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], ",", " ", "2"}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.558637287082366*^9, 3.55863729946292*^9}, {
  3.558637358726549*^9, 3.55863736508539*^9}, {3.558639897433449*^9, 
  3.558639952726821*^9}, {3.558639986437481*^9, 3.558639998365039*^9}, {
  3.5586401279260178`*^9, 3.558640184719853*^9}, {3.5586411958875017`*^9, 
  3.5586411980120583`*^9}}],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", " ", "<=", 
    RowBox[{"Length", "[", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Print", "[", 
    RowBox[{"StringTake", "[", 
     RowBox[{"test", ",", 
      RowBox[{
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"StringPosition", "[", 
           RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.55870475454357*^9, 3.558704844154711*^9}, {
  3.558704881017108*^9, 3.558704892688006*^9}, {3.558704966755434*^9, 
  3.558704968509387*^9}, {3.558705833759858*^9, 3.558705837061893*^9}, {
  3.5587058721733723`*^9, 3.558705890173202*^9}, {3.558705934584326*^9, 
  3.55870593490518*^9}, {3.558714129519442*^9, 3.558714141790649*^9}, {
  3.558720858585072*^9, 3.558720880442618*^9}, {3.558723235229047*^9, 
  3.558723267754443*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.558704803235759*^9, 3.558704812481985*^9}}],

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5587049395593243`*^9, 3.558704945447609*^9}, {
  3.558705896069078*^9, 3.5587059275385447`*^9}}],

Cell[BoxData["5"], "Input",
 CellChangeTimes->{3.558731966680056*^9}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", " ", "<=", 
    RowBox[{"Length", "[", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}], " ", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Print", "[", 
    RowBox[{"StringTake", "[", 
     RowBox[{"test", ",", 
      RowBox[{
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"StringPosition", "[", 
           RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.558815401298977*^9, {3.558815813768406*^9, 3.558815880085417*^9}, {
   3.55881591374431*^9, 3.5588159868794107`*^9}, {3.5588161254064293`*^9, 
   3.558816140253893*^9}, {3.558971418145123*^9, 3.558971459246908*^9}, {
   3.5589716569386463`*^9, 3.558971688545945*^9}, {3.558974352699069*^9, 
   3.558974394068088*^9}, {3.558974511913127*^9, 3.5589745190408993`*^9}, 
   3.5589916184818974`*^9, {3.558991684318199*^9, 3.558991712300181*^9}, {
   3.558992525889496*^9, 3.5589926868662786`*^9}, {3.5590581313607683`*^9, 
   3.559058136655677*^9}, {3.5590612218818617`*^9, 3.559061224940197*^9}, {
   3.559062356927683*^9, 3.559062378374522*^9}, {3.5590628070892773`*^9, 
   3.559062813089942*^9}, {3.559062925948542*^9, 3.559062952650772*^9}, {
   3.559063222642584*^9, 3.559063262450791*^9}, 3.559063384534981*^9}],

Cell[BoxData[{"test", "\[IndentingNewLine]", 
 RowBox[{"StringPosition", "[", 
  RowBox[{"test", ",", "\"\<)(\>\""}], 
  "]"}], "\[IndentingNewLine]", "letterlocation", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntervalMemberQ", "[", 
   RowBox[{
    RowBox[{"Interval", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}], "]"}], " ", "&&", 
  RowBox[{"IntervalMemberQ", "[", 
   RowBox[{
    RowBox[{"Interval", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"StringPosition", "[", 
       RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "&&", 
  "\[IndentingNewLine]", 
  RowBox[{"IntervalMemberQ", "[", 
   RowBox[{
    RowBox[{"Interval", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.5590585992705107`*^9, 3.559058619303523*^9}, {
  3.5590596461413727`*^9, 3.559059676878067*^9}, {3.5590597321260653`*^9, 
  3.559059810738081*^9}, {3.559060096460939*^9, 3.559060181515588*^9}, {
  3.55906042650489*^9, 3.5590604994031143`*^9}, {3.559061111836115*^9, 
  3.559061149200303*^9}, {3.5590612295907993`*^9, 3.5590612892382812`*^9}, {
  3.5590617761118107`*^9, 3.559061777475136*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"IntervalMemberQ", "[", 
   RowBox[{
    RowBox[{"Interval", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}], "]"}], " ", "&&", 
  RowBox[{"IntervalMemberQ", "[", 
   RowBox[{
    RowBox[{"Interval", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"StringPosition", "[", 
       RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", "&&", 
  "\[IndentingNewLine]", 
  RowBox[{"IntervalMemberQ", "[", 
   RowBox[{
    RowBox[{"Interval", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"letterlocation", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.559061712645934*^9, {3.559061790188787*^9, 3.559061829740239*^9}, {
   3.559062173531846*^9, 3.559062173691114*^9}}],

Cell[BoxData[
 RowBox[{"Interval", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"letterlocation", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"letterlocation", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{3.559061854625085*^9}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}]], "Input",
 CellChangeTimes->{
  3.559060506573831*^9, {3.559062117146572*^9, 3.559062133680187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StringPosition", "[", 
    RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{3.559062149111741*^9}],

Cell[BoxData[
 RowBox[{"Interval", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"letterlocation", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"letterlocation", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Interval", "[", 
  RowBox[{"{", 
   RowBox[{"9", ",", "13"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{3.559062325796009*^9}],

Cell[BoxData[
 RowBox[{"\"\<)\>\"", " ", "\[Equal]", "\"\<)\>\""}]], "Input",
 CellChangeTimes->{{3.559062331140128*^9, 3.55906234222646*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.559063269666616*^9, 3.559063291955871*^9}, {
   3.5590633451260147`*^9, 3.559063352668058*^9}, 3.5590634002755632`*^9}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], "  ", 
       "\[Equal]", " ", "\"\<)\>\""}], "&&", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "  ", 
       "\[Equal]", " ", "\"\<)\>\""}], "&&", " ", 
      RowBox[{"\"\<)\>\"", "==", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}], " ", "&&", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], "  ", 
       "\[Equal]", " ", "\"\<(\>\""}], "&&", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "  ", 
       "\[Equal]", " ", "\"\<(\>\""}], "&&", " ", 
      RowBox[{"\"\<(\>\"", "==", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}]}], ")"}]}], 
   ",", 
   RowBox[{"StringReplacePart", "[", 
    RowBox[{"test", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<)(\>\"", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"test", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringPosition", "[", 
                 RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"StringTake", "[", 
           RowBox[{"test", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringPosition", "[", 
                 RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], "}"}]}],
            "]"}], ",", "\"\<)\>\""}], " ", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "+", "2"}]}], " ", "}"}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Does not satisfiy axiom\>\"", "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5590633904010773`*^9, 3.559063401874473*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringTake", "[", 
   RowBox[{"test", ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}]}], "]"}], "  ", 
  "\[Equal]", " ", "\"\<)\>\""}]], "Input",
 CellChangeTimes->{
  3.559154937440185*^9, 3.5591550306181927`*^9, {3.5591560680570374`*^9, 
   3.559156071325218*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StringTake", "[", 
    RowBox[{"test", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], " ", "}"}]}], 
    "]"}], " ", "\[Equal]", " ", "\"\<)\>\""}], "&&", 
  RowBox[{
   RowBox[{"StringTake", "[", 
    RowBox[{"test", ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], "]"}], 
   "  ", "\[Equal]", " ", "\"\<)\>\""}], "&&", " ", 
  RowBox[{"\"\<)\>\"", "==", 
   RowBox[{"StringTake", "[", 
    RowBox[{"test", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
    "]"}]}], " ", "&&", 
  RowBox[{
   RowBox[{"StringTake", "[", 
    RowBox[{"test", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], " ", "}"}]}], 
    "]"}], " ", "\[Equal]", " ", "\"\<(\>\""}], "&&", " ", 
  RowBox[{
   RowBox[{"StringTake", "[", 
    RowBox[{"test", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}], "  ", "]"}], 
   "\[Equal]", " ", "\"\<(\>\""}], "&&", " ", 
  RowBox[{"\"\<(\>\"", "==", 
   RowBox[{"StringTake", "[", 
    RowBox[{"test", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.5591548629707317`*^9, 3.559154906555109*^9, {3.559154979370311*^9, 
   3.559155037069879*^9}, {3.5591561388447313`*^9, 3.5591562057872057`*^9}, {
   3.55916015829886*^9, 3.559160192282175*^9}, {3.559167029364648*^9, 
   3.5591670372539263`*^9}}],

Cell[BoxData["False"], "Input",
 CellChangeTimes->{3.559167049979437*^9}],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.559167073986887*^9, 3.559167123626635*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"test", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "2"}], " ", 
          "}"}]}], "]"}], " ", "\[Equal]", " ", "\"\<)\>\""}], "||", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"test", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
        "]"}], "  ", "\[Equal]", " ", "\"\<)\>\""}], "||", " ", 
      RowBox[{"\"\<)\>\"", "==", 
       RowBox[{"StringTake", "[", 
        RowBox[{"test", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}], " ", "-", " ", "1"}]}], 
        "]"}]}], " ", "||", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"test", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "2"}], " ", 
          "}"}]}], "]"}], " ", "\[Equal]", " ", "\"\<(\>\""}], "||", " ", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"test", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}], " ", "-", " ", "1"}]}], 
        "  ", "]"}], "\[Equal]", " ", "\"\<(\>\""}], "||", " ", 
      RowBox[{"\"\<(\>\"", "==", 
       RowBox[{"StringTake", "[", 
        RowBox[{"test", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "}"}], " ", "-", " ", "1"}]}], 
        "]"}]}]}], ")"}]}], ",", 
   RowBox[{"StringReplacePart", "[", 
    RowBox[{"test", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<)(\>\"", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"test", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringPosition", "[", 
                 RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"StringTake", "[", 
           RowBox[{"test", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringPosition", "[", 
                 RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], "}"}]}],
            "]"}], ",", "\"\<)\>\""}], " ", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "+", "2"}]}], " ", "}"}]}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", "\"\<Does not satisfiy axiom\>\"", "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.559151887022851*^9, 3.5591518992550287`*^9}, {
  3.559151955616302*^9, 3.5591519903267527`*^9}, {3.5591547718947077`*^9, 
  3.559154839975965*^9}, {3.559155000370702*^9, 3.559155022729965*^9}, {
  3.559156366939527*^9, 3.559156373054545*^9}, {3.5591654897890377`*^9, 
  3.55916554614189*^9}, {3.559167148523576*^9, 3.559167222269209*^9}, {
  3.559167761132863*^9, 3.559167793817834*^9}, {3.559233591073489*^9, 
  3.559233612810577*^9}, {3.5592338187868357`*^9, 3.559233859243943*^9}, {
  3.5593021649461393`*^9, 3.559302178496683*^9}}],

Cell[BoxData["\"\<((i))()()ab)(c)(e))((fg)(h))\>\""], "Input",
 CellChangeTimes->{3.559167283573926*^9}],

Cell[BoxData[{
 RowBox[{"test", " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", 
  "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StringTake", "[", 
   RowBox[{"test", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "-", "2"}], "}"}]}], "]"}], 
  RowBox[{"StringTake", "[", 
   RowBox[{"test", ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], "]"}], "  ", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "}"}], " ", "-", " ", "1"}]}], "]"}], 
  " ", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "  ", "-", "2"}], " ", "}"}]}], "]"}], 
  " ", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "}"}], " ", "-", " ", "1"}]}], "  ", 
   "]"}], 
  RowBox[{"StringTake", "[", 
   RowBox[{"test", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "}"}], " ", "-", " ", "1"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.559167291857951*^9, 3.5591674383055468`*^9}, {
  3.5591684763453217`*^9, 3.559168487134486*^9}, {3.559233304328803*^9, 
  3.55923336467209*^9}, {3.5592333991629047`*^9, 3.559233497631731*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5591684795685596`*^9, 3.559168480994755*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "<", "2"}], ",", 
   RowBox[{"++", "i"}], ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], "}"}]}], 
          " ", "]"}], " ", "\[Equal]", " ", "\"\<)\>\""}], "&&", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
          "]"}], "  ", "\[Equal]", " ", "\"\<)\>\""}], "&&", " ", 
        RowBox[{"\"\<)\>\"", "==", 
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
          "]"}]}], " ", "&&", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], " ", 
            "}"}]}], "]"}], " ", "\[Equal]", " ", "\"\<(\>\""}], "&&", " ", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], " ", 
            "}"}]}], " ", "]"}], "\[Equal]", " ", "\"\<(\>\""}], "&&", " ", 
        RowBox[{"\"\<(\>\"", "==", 
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
          "]"}]}]}], ")"}]}], ",", 
     RowBox[{"StringReplacePart", "[", 
      RowBox[{"test", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<)(\>\"", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"test", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"StringPosition", "[", 
                   RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{"test", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"StringPosition", "[", 
                   RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], 
               "}"}]}], "]"}], ",", "\"\<)\>\""}], " ", "]"}], "]"}]}], "]"}],
        ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringPosition", "[", 
             RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], " ", "+", "2"}]}], " ", "}"}]}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Does not satisfiy axiom\>\"", "]"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.559063977886105*^9, 3.559075438414865*^9, {3.559154746315178*^9, 
   3.5591547667612658`*^9}, 3.5591576053870497`*^9, {3.5591576709902563`*^9, 
   3.559157674933154*^9}, {3.559157727245047*^9, 3.559157783289671*^9}, {
   3.559157821846603*^9, 3.559157822742731*^9}, {3.559158483215681*^9, 
   3.5591585217559347`*^9}, {3.5591585940997868`*^9, 3.559158616470564*^9}, {
   3.559158698295528*^9, 3.559158735227253*^9}, {3.559160001681382*^9, 
   3.559160028884099*^9}}],

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"Drop", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"StringPosition", "[", 
      RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "]"}], " ", ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", 
      RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringTake", "[", 
   RowBox[{"test", ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}]}], " ", "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.5590639803187323`*^9, 3.55906402489511*^9}, {
  3.559158537740972*^9, 3.55915856691367*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", " ", "<", " ", "6"}], ",", " ", 
   RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], "}"}]}], 
          " ", "]"}], " ", "\[Equal]", " ", "\"\<)\>\""}], "&&", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
          "]"}], "  ", "\[Equal]", " ", "\"\<)\>\""}], "&&", " ", 
        RowBox[{"\"\<)\>\"", "==", 
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
          "]"}]}], " ", "&&", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], " ", 
            "}"}]}], "]"}], " ", "\[Equal]", " ", "\"\<(\>\""}], "&&", " ", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], " ", 
            "}"}]}], " ", "]"}], "\[Equal]", " ", "\"\<(\>\""}], "&&", " ", 
        RowBox[{"\"\<(\>\"", "==", 
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
          "]"}]}]}], ")"}]}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{"StringReplacePart", "[", 
       RowBox[{"test", ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"\"\<)(\>\"", ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{"test", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"StringTake", "[", 
              RowBox[{"test", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], 
                "}"}]}], "]"}], ",", "\"\<)\>\""}], " ", "]"}], "]"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringPosition", "[", 
             RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "+", "2"}]}], " ", "}"}]}], 
       "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Does not satisfiy axiom\>\"", "]"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.559063477628812*^9, 3.559063526473184*^9}, {
  3.559063919225664*^9, 3.559063976147355*^9}, {3.5592375085542727`*^9, 
  3.5592375800102177`*^9}, {3.559238208435244*^9, 3.559238226407226*^9}, {
  3.559238256432722*^9, 3.559238326316989*^9}, {3.559238603726486*^9, 
  3.5592386373086653`*^9}, {3.559238684568907*^9, 3.559238764504781*^9}, {
  3.559240540326206*^9, 3.559240549982266*^9}, {3.559302190826622*^9, 
  3.559302194864259*^9}}],

Cell[BoxData[
 RowBox[{"Print", "[", 
  RowBox[{"StringReplacePart", "[", 
   RowBox[{"test", ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<)(\>\"", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], "}"}]}], 
          "]"}], ",", "\"\<)\>\""}], " ", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "+", "2"}]}], " ", "}"}]}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.559063960953225*^9, 3.559063969105508*^9}, {
  3.559240048024816*^9, 3.559240070365301*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringTake", "[", 
   RowBox[{"test", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], "]"}], 
  " ", "\[Equal]", " ", "\"\<)\>\""}]], "Input",
 CellChangeTimes->{{3.559240573548935*^9, 3.5592406111039257`*^9}}],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.559240879941393*^9, 3.5592409495052032`*^9}}],

Cell[BoxData["\"\<(\>\""], "Input",
 CellChangeTimes->{3.559302202950426*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.559240607303606*^9, 3.5592406080077343`*^9}}],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.559156714338354*^9, 3.559156752620298*^9, {3.559240589438718*^9, 
   3.559240591930633*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", " ", "<", " ", "6"}], ",", " ", 
    RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
          " ", "]"}], " ", "\[Equal]", " ", "\"\<(\>\""}], " ", ")"}]}], ",", 
      
      RowBox[{"Print", "[", 
       RowBox[{"StringReplacePart", "[", 
        RowBox[{"test", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<)(\>\"", ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"StringJoin", "[", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"test", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"StringTake", "[", 
               RowBox[{"test", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], 
                 "}"}]}], "]"}], ",", "\"\<)\>\""}], " ", "]"}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "+", "2"}]}], " ", "}"}]}], 
        "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Does not satisfiy axiom\>\"", "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.559241817775037*^9, 3.559241822563963*^9}, {
  3.559301639074798*^9, 3.559301678864891*^9}, {3.559302213377825*^9, 
  3.5593022570517387`*^9}, {3.5593040520441923`*^9, 3.559304092695592*^9}, {
  3.559387230829691*^9, 3.559387233450082*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"((i))(((ab)(bc)(e))((fg)(h))\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.5593016523538446`*^9, 3.559301679578331*^9}, 
   3.559302250068437*^9, 3.5593040932155523`*^9, 3.5593872869910383`*^9, {
   3.5599255333644457`*^9, 3.5599255339624853`*^9}}],

Cell[BoxData["\<\"((i))(((ab)(c)(ce))((fg)(h))\"\>"], "Print",
 CellChangeTimes->{{3.5593016523538446`*^9, 3.559301679578331*^9}, 
   3.559302250068437*^9, 3.5593040932155523`*^9, 3.559387286993575*^9}],

Cell[BoxData["\<\"Does not satisfiy axiom\"\>"], "Print",
 CellChangeTimes->{{3.5593016523538446`*^9, 3.559301679578331*^9}, 
   3.559302250068437*^9, 3.5593040932155523`*^9, 3.559387286996292*^9}],

Cell[BoxData["\<\"((i))(((ab)(c)(e))((fg)(gh))\"\>"], "Print",
 CellChangeTimes->{{3.5593016523538446`*^9, 3.559301679578331*^9}, 
   3.559302250068437*^9, 3.5593040932155523`*^9, 3.5593872869992533`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "+", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.559387324248294*^9, 3.559387357677953*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.5593872820815268`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.559241859727067*^9, 3.559241864212728*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"distributorTick", "[", "todistribute_", "]"}], " ", ":=", " ", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", " ", "<=", " ", 
     RowBox[{"Length", "[", 
      RowBox[{"StringPosition", "[", 
       RowBox[{"todistribute", ",", "\"\<)(\>\""}], "]"}], "]"}]}], ",", " ", 
    
    RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"todistribute", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"todistribute", ",", "\"\<)(\>\""}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
          " ", "]"}], " ", "\[Equal]", " ", "\"\<(\>\""}], " ", ")"}]}], ",", 
      
      RowBox[{"Print", "[", 
       RowBox[{"StringReplacePart", "[", 
        RowBox[{"todistribute", ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"todistribute", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringPosition", "[", 
                  RowBox[{"todistribute", ",", "\"\<)(\>\""}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<)(\>\"", ",", 
             RowBox[{"StringJoin", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"todistribute", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"todistribute", ",", "\"\<)(\>\""}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "-", "1"}], "}"}]}], 
                 "]"}], ",", 
                RowBox[{"StringTake", "[", 
                 RowBox[{"todistribute", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"todistribute", ",", "\"\<)(\>\""}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], " ", "+", "  ", "1"}], 
                   "}"}]}], "]"}], ",", "\"\<)\>\""}], " ", "]"}], "]"}]}], 
            "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"todistribute", ",", "\"\<)(\>\""}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "  ", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"todistribute", ",", "\"\<)(\>\""}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "+", "2"}]}], " ", "}"}]}], 
        "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Does not satisfiy axiom\>\"", "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.559302265700967*^9, 3.559302268292671*^9}, {
   3.559302696131139*^9, 3.559302724896235*^9}, {3.559302757844098*^9, 
   3.5593027983564787`*^9}, 3.559304271828763*^9, {3.55931787017901*^9, 
   3.559317872020171*^9}, 3.5593313043153267`*^9, {3.559331581758048*^9, 
   3.559331680964716*^9}, {3.559331712282256*^9, 3.5593317147576237`*^9}, {
   3.559387507825037*^9, 3.5593875829853897`*^9}, {3.55938776050779*^9, 
   3.559387879128525*^9}, {3.5593883740656424`*^9, 3.559388386525764*^9}, {
   3.559388416973187*^9, 3.559388417333317*^9}, {3.5596638433963633`*^9, 
   3.559663850986521*^9}, {3.5596638832418613`*^9, 3.5596639471424503`*^9}, {
   3.559664154643503*^9, 3.55966418397614*^9}, {3.5596642764571457`*^9, 
   3.5596643547099743`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.560080445559792*^9, 3.560080447590118*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"distributorTick", "[", "\"\<(ab)(c)\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"distributorTick", "[", "\"\<(ab)c\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"distributorTick", "[", "test", "]"}]}], "Input",
 CellChangeTimes->{{3.5593022776424294`*^9, 3.5593022883778763`*^9}, {
  3.559302735420759*^9, 3.5593027393408957`*^9}, {3.559317878293437*^9, 
  3.559317880587721*^9}, {3.5612935245772123`*^9, 3.56129352987153*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"((i))(((ab)(c)(e))((fh)(gh))\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5600804708947144`*^9, {3.560080560469998*^9, 3.56008062332786*^9}, 
   3.561293530549505*^9, 3.5625037134790907`*^9}],

Cell[BoxData["\<\"Does not satisfiy axiom\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5600804708947144`*^9, {3.560080560469998*^9, 3.56008062332786*^9}, 
   3.561293530549505*^9, 3.562503713475852*^9}],

Cell[BoxData["\<\"((i))(((ab)(e)(ce))((fg)(h))\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5600804708947144`*^9, {3.560080560469998*^9, 3.56008062332786*^9}, 
   3.561293530549505*^9, 3.5625037134721737`*^9}],

Cell[BoxData["\<\"((i))(((ac)(bc)(e))((fg)(h))\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5600804708947144`*^9, {3.560080560469998*^9, 3.56008062332786*^9}, 
   3.561293530549505*^9, 3.5625037134691963`*^9}],

Cell[BoxData["\<\"Does not satisfiy axiom\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5600804708947144`*^9, {3.560080560469998*^9, 3.56008062332786*^9}, 
   3.561293530549505*^9, 3.562503713466248*^9}],

Cell[BoxData["\<\"(ac)(bc)\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5600804708947144`*^9, {3.560080560469998*^9, 3.56008062332786*^9}, 
   3.561293530549505*^9, 3.562503713463201*^9}],

Cell[BoxData["\<\"(ac)(bc)\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5600804708947144`*^9, {3.560080560469998*^9, 3.56008062332786*^9}, 
   3.561293530549505*^9}],

Cell[BoxData["\<\"Does not satisfiy axiom\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5600804708947144`*^9, {3.560080560469998*^9, 3.56008062332786*^9}}],

Cell[BoxData["\<\"((b)(ab))((c))\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5600804708947144`*^9, {3.560080560469998*^9, 3.560080623325015*^9}}],

Cell[BoxData[{
 RowBox[{"try", "=", "\<\"\\\"(ab)((cd))\\\"\"\>"}], "\n", 
 RowBox[{"distributorTick", "[", "try", "]"}]}], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5600804708947144`*^9, {3.560080560469998*^9, 3.560080615465085*^9}, {
   3.560080659263048*^9, 3.560080673127264*^9}, {3.560080756125618*^9, 
   3.5600807619162493`*^9}, {3.560081083278854*^9, 3.560081096468357*^9}}],

Cell[BoxData["\<\"Does not satisfiy axiom\"\>"], "Print",
 CellChangeTimes->{3.5600804708974533`*^9}]
}, Open  ]],

Cell[BoxData["pre"], "Output",
 CellChangeTimes->{{3.560080465714942*^9, 3.560080470899976*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"test2", " ", "=", " ", "\"\<(ab)(bc)\>\""}]], "Input",
 CellChangeTimes->{{3.5593179648603687`*^9, 3.559317978860806*^9}}],

Cell[BoxData[
 RowBox[{"distributorTick", "[", "test2", "]"}]], "Input",
 CellChangeTimes->{{3.55938887917776*^9, 3.559388898964837*^9}}],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test2", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.559318039983398*^9, 3.559318083146913*^9}, {
  3.559318351011353*^9, 3.5593183693515167`*^9}, {3.559320918980204*^9, 
  3.559320934579817*^9}, {3.55932584172701*^9, 3.5593258425595417`*^9}}],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test2", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", "2"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5593209677734413`*^9, 3.559320975680766*^9}}],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test2", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", "3"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.559320982831071*^9, 3.559320984754676*^9}}],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test2", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], "]"}]], \
"Input",
 CellChangeTimes->{{3.559320942066367*^9, 3.5593209461872396`*^9}}],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test", ",", "\"\<)(\>\""}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", "1"}], "}"}]}], "]"}]], \
"Input",
 CellChangeTimes->{{3.559320026133251*^9, 3.559320066660048*^9}}],

Cell[BoxData[{
 RowBox[{"goal", " ", "=", " ", "\"\<(ab)(ac)\>\""}], "\[IndentingNewLine]", 
 RowBox[{"goal2", "=", "\"\<(a(ac))(b(ac))\>\""}]}], "Input",
 CellChangeTimes->{{3.559389022209774*^9, 3.559389028050556*^9}, {
  3.5593909368728437`*^9, 3.559390971078391*^9}, {3.559423291552971*^9, 
  3.55942330326414*^9}}],

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"StringTake", "[", 
    RowBox[{"goal", ",", "4"}], "]"}], ",", " ", 
   RowBox[{
    RowBox[{
    "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", " ", 
     "\"\<)\>\""}], "->", "goal2"}]}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.559669643916416*^9, 3.55966964663363*^9}, {
  3.5596697229848337`*^9, 3.559669726135166*^9}, {3.559669856420326*^9, 
  3.559669876867138*^9}, {3.559669947370585*^9, 3.559669951984745*^9}, {
  3.559670027786728*^9, 3.559670053213921*^9}, {3.559670115493567*^9, 
  3.5596702746001387`*^9}, {3.559670857454671*^9, 3.559670884039281*^9}, {
  3.559671146201622*^9, 3.5596712049906816`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"goal", ",", " ", 
       RowBox[{"StringExpression", "[", 
        RowBox[{
        "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", 
         " ", "\"\<)\>\""}], "]"}]}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"StringLength", "[", "goal", "]"}]}], "Input",
 CellChangeTimes->{{3.5596784586099873`*^9, 3.559678465021523*^9}, {
  3.559679013066966*^9, 3.559679079665483*^9}, {3.559687726143241*^9, 
  3.559687749397787*^9}, {3.559688348409493*^9, 3.559688396696004*^9}, {
  3.559688884114174*^9, 3.5596889231463833`*^9}, {3.559689845957855*^9, 
  3.559689859462224*^9}, {3.559689892708971*^9, 3.55968991161243*^9}}],

Cell[BoxData[
 RowBox[{"StringJoin", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<(\>\"", ",", " ", 
             RowBox[{"StringTake", "[", 
              RowBox[{"goal", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"goal", ",", " ", 
                    RowBox[{"StringExpression", "[", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], 
                "}"}]}], "]"}]}], "]"}], ",", "\"\<(\>\""}], "]"}], ",", 
         RowBox[{"StringTake", "[", 
          RowBox[{"goal", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"goal", ",", " ", 
                 RowBox[{"StringExpression", "[", 
                  RowBox[{
                  "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                   "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], "}"}]}], 
          "]"}]}], "]"}], ",", "  ", 
       RowBox[{"StringTake", "[", 
        RowBox[{"goal", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"goal", ",", " ", 
               RowBox[{"StringExpression", "[", 
                RowBox[{
                "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter",
                  "~~", " ", "\"\<)\>\""}], "]"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
        "]"}]}], "]"}], ",", "\"\<))\>\""}], "]"}], ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<(\>\"", ",", " ", 
             RowBox[{"StringTake", "[", 
              RowBox[{"goal", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"goal", ",", " ", 
                    RowBox[{"StringExpression", "[", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], 
                "}"}]}], "]"}]}], "]"}], ",", "\"\<(\>\""}], "]"}], ",", 
         RowBox[{"StringTake", "[", 
          RowBox[{"goal", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"goal", ",", " ", 
                 RowBox[{"StringExpression", "[", 
                  RowBox[{
                  "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                   "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], "}"}]}], 
          "]"}]}], "]"}], ",", "  ", 
       RowBox[{"StringTake", "[", 
        RowBox[{"goal", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"goal", ",", " ", 
               RowBox[{"StringExpression", "[", 
                RowBox[{
                "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter",
                  "~~", " ", "\"\<)\>\""}], "]"}]}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
        "]"}]}], "]"}], ",", "\"\<))\>\""}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.55939103061524*^9, 3.559391042212372*^9}, {
   3.559421732902205*^9, 3.5594217354918137`*^9}, {3.559421774813304*^9, 
   3.559421803634555*^9}, {3.559422651468487*^9, 3.559422696330024*^9}, {
   3.559422733495682*^9, 3.55942273389987*^9}, {3.5594227720413723`*^9, 
   3.559422825005694*^9}, {3.559513642875043*^9, 3.559513663741897*^9}, {
   3.559513694773017*^9, 3.559513744252729*^9}, {3.5595142520520678`*^9, 
   3.559514262303913*^9}, {3.559579190832818*^9, 3.5595792560983763`*^9}, {
   3.5596645158034353`*^9, 3.559664856815078*^9}, 3.5596651104429913`*^9, {
   3.559665141257345*^9, 3.559665230086138*^9}, {3.5596883604516068`*^9, 
   3.5596884084621058`*^9}, {3.559688895462929*^9, 3.5596889588704987`*^9}, {
   3.5596890821393003`*^9, 3.559689085212368*^9}}],

Cell[BoxData[
 RowBox[{"StringJoin", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<(\>\"", ",", " ", 
             RowBox[{"StringTake", "[", 
              RowBox[{"goal", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], ",", "\"\<(\>\""}], 
          "]"}], ",", 
         RowBox[{"StringTake", "[", 
          RowBox[{"goal", ",", 
           RowBox[{"{", "6", "}"}]}], "]"}]}], "]"}], ",", "  ", 
       RowBox[{"StringTake", "[", 
        RowBox[{"goal", ",", 
         RowBox[{"{", "7", "}"}]}], "]"}]}], "]"}], ",", "\"\<)\>\""}], "]"}],
    ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<(\>\"", ",", " ", 
             RowBox[{"StringTake", "[", 
              RowBox[{"goal", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}]}], "]"}], ",", "\"\<(\>\""}], 
          "]"}], ",", 
         RowBox[{"StringTake", "[", 
          RowBox[{"goal", ",", 
           RowBox[{"{", "6", "}"}]}], "]"}]}], "]"}], ",", "  ", 
       RowBox[{"StringTake", "[", 
        RowBox[{"goal", ",", 
         RowBox[{"{", "7", "}"}]}], "]"}]}], "]"}], ",", "\"\<)\>\""}], 
    "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"distributorTock", "[", "input_", "]"}], " ", ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<(\>\"", ",", " ", 
               RowBox[{"StringTake", "[", 
                RowBox[{"input", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", " ", 
                    RowBox[{"StringExpression", "[", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], 
                  "}"}]}], "]"}]}], "]"}], ",", "\"\<(\>\""}], "]"}], ",", 
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringPosition", "[", 
                  RowBox[{"input", ",", " ", 
                   RowBox[{"StringExpression", "[", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                  "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], "}"}]}],
             "]"}]}], "]"}], ",", "  ", 
         RowBox[{"StringTake", "[", 
          RowBox[{"input", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"input", ",", " ", 
                 RowBox[{"StringExpression", "[", 
                  RowBox[{
                  "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                   "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
          "]"}]}], "]"}], ",", "\"\<))\>\""}], "]"}], ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{"\"\<(\>\"", ",", " ", 
               RowBox[{"StringTake", "[", 
                RowBox[{"input", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", " ", 
                    RowBox[{"StringExpression", "[", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], 
                  "}"}]}], "]"}]}], "]"}], ",", "\"\<(\>\""}], "]"}], ",", 
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringPosition", "[", 
                  RowBox[{"input", ",", " ", 
                   RowBox[{"StringExpression", "[", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                  "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], "}"}]}],
             "]"}]}], "]"}], ",", "  ", 
         RowBox[{"StringTake", "[", 
          RowBox[{"input", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"input", ",", " ", 
                 RowBox[{"StringExpression", "[", 
                  RowBox[{
                  "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                   "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
          "]"}]}], "]"}], ",", "\"\<))\>\""}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.559317895350705*^9, 3.559317920629346*^9}, {
   3.559317950857154*^9, 3.5593179521001177`*^9}, {3.559317996381241*^9, 
   3.559318004848311*^9}, {3.5593258230756903`*^9, 3.5593258297078342`*^9}, 
   3.559391017562935*^9, {3.559689629250545*^9, 3.559689644348022*^9}, {
   3.5596899195778303`*^9, 3.5596899245341177`*^9}, {3.559743162928588*^9, 
   3.5597431697772007`*^9}, {3.5597437816078176`*^9, 
   3.5597438014314137`*^9}, {3.5597439163977222`*^9, 
   3.5597439175517263`*^9}, {3.5597439605559397`*^9, 3.559744010725239*^9}, {
   3.559744115351953*^9, 3.559744134205749*^9}, {3.559744394767548*^9, 
   3.559744412904294*^9}, {3.559745218842493*^9, 3.559745232827079*^9}, {
   3.5597609607431917`*^9, 3.559760983136694*^9}, {3.559762801117168*^9, 
   3.559762882361847*^9}, {3.559762940425518*^9, 3.5597629658473463`*^9}, {
   3.559772737514517*^9, 3.559772758197864*^9}, {3.559772904449441*^9, 
   3.559772906649287*^9}, {3.559773022238141*^9, 3.559773025368772*^9}, {
   3.5597736096908493`*^9, 3.559773619172698*^9}, {3.5597736697944736`*^9, 
   3.559773680498659*^9}, {3.559774250338807*^9, 3.55977427045502*^9}, {
   3.559774318342761*^9, 3.559774336210904*^9}, 3.5597743784474487`*^9, {
   3.559776075661112*^9, 3.5597760884441442`*^9}, {3.55984473361731*^9, 
   3.559844739047736*^9}, {3.559845375390595*^9, 3.5598454436180573`*^9}, {
   3.559845512338028*^9, 3.5598455174038963`*^9}, {3.559848625878517*^9, 
   3.5598486277920427`*^9}, {3.5598545752029057`*^9, 
   3.5598545797409678`*^9}, {3.5598565154769173`*^9, 3.5598565203149776`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.559762887987464*^9, 3.5597628890945807`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"distributorTock", "[", "\"\<(ab)(ac)\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"test3", " ", "=", 
  "\"\<((i))(((ab)(c)(e))((fg)(gh))\>\""}], "\[IndentingNewLine]", 
 RowBox[{"distributorTock", "[", "test3", "]"}]}], "Input",
 CellChangeTimes->{{3.559743931495377*^9, 3.559743946686871*^9}, {
  3.559747225765777*^9, 3.559747236987671*^9}, {3.559769338789976*^9, 
  3.559769347837105*^9}, {3.559924669099805*^9, 3.559924696395857*^9}}],

Cell[BoxData["\<\"(a(ac))(b(ac))\"\>"], "Output",
 CellChangeTimes->{3.563643097160369*^9}],

Cell[BoxData["\<\"((i))(((ab)(c)(e))((fg)(gh))\"\>"], "Output",
 CellChangeTimes->{3.5636430971619473`*^9}],

Cell[BoxData["\<\"(a(fg))(b(fg))\"\>"], "Output",
 CellChangeTimes->{3.5636430971639633`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"StringPosition", "[", 
  RowBox[{"test3", ",", 
   RowBox[{
   "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", " ", 
    "\"\<)(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", 
    " ", "\"\<)\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.559769850377002*^9, 3.559769857083399*^9}, {
  3.5597700671669283`*^9, 3.559770091777173*^9}}],

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"20", ",", "27"}], "}"}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"StringDrop", "[", 
  RowBox[{"test3", ",", 
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"test3", ",", 
      RowBox[{
      "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", 
       " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~",
        " ", "\"\<)\>\""}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5597730519771338`*^9, 3.5597731194403353`*^9}, {
  3.559774298536234*^9, 3.5597742993599977`*^9}}],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test3", ",", 
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"test3", ",", 
      RowBox[{
      "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", 
       " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~",
        " ", "\"\<)\>\""}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.559774306862547*^9, 3.5597743081924143`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"distributorTock", "[", 
   RowBox[{"StringTake", "[", 
    RowBox[{"test3", ",", 
     RowBox[{
      RowBox[{"StringPosition", "[", 
       RowBox[{"test3", ",", 
        RowBox[{
        "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", 
         " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", 
         "~~", " ", "\"\<)\>\""}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.559844765404562*^9, 3.559844779687346*^9}, {
  3.55984546602846*^9, 3.5598454679345818`*^9}, {3.55984612741932*^9, 
  3.559846132080414*^9}}],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.559762969053191*^9, 3.559769350604068*^9, {3.5597698241691847`*^9, 
   3.559769843010247*^9}, {3.559924772234168*^9, 3.559924773172102*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"StringInsert", "[", 
  RowBox[{
   RowBox[{"StringTake", "[", 
    RowBox[{"test3", ",", 
     RowBox[{
      RowBox[{"StringPosition", "[", 
       RowBox[{"test3", ",", 
        RowBox[{
        "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", 
         " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", 
         "~~", " ", "\"\<)\>\""}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", ",", "20"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.559846153432932*^9, 3.5598461556238213`*^9}, {
  3.5598462409269657`*^9, 3.559846299125403*^9}, {3.559848644212365*^9, 
  3.559848653829525*^9}, {3.559854348554524*^9, 3.5598543743765497`*^9}, {
  3.5599211781687193`*^9, 3.559921179347518*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StringPosition", "[", 
    RowBox[{"\"\<(ab)(ac)\>\"", ",", 
     RowBox[{
     "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", 
      " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~",
       " ", "\"\<)\>\""}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.559921249252043*^9, 3.559921307224351*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.559920580022213*^9, 3.5599205888778057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"distributorTockFail", "[", "input_", "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<(\>\"", ",", " ", 
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"input", ",", 
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)(\>\"", "~~", 
                    "LetterCharacter", "~~", "LetterCharacter", "~~", " ", 
                    "\"\<)\>\""}]}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)(\>\"", "~~", 
                    "LetterCharacter", "~~", "LetterCharacter", "~~", " ", 
                    "\"\<)\>\""}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
                    RowBox[{"StringExpression", "[", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], 
                 "}"}]}], "]"}]}], "]"}], ",", "\"\<(\>\""}], "]"}], ",", 
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"input", ",", 
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"input", ",", 
                 RowBox[{
                 "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                  "LetterCharacter", "~~", " ", "\"\<)(\>\"", "~~", 
                  "LetterCharacter", "~~", "LetterCharacter", "~~", " ", 
                  "\"\<)\>\""}]}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringPosition", "[", 
                 RowBox[{
                  RowBox[{"StringTake", "[", 
                   RowBox[{"input", ",", 
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)(\>\"", "~~", 
                    "LetterCharacter", "~~", "LetterCharacter", "~~", " ", 
                    "\"\<)\>\""}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
                  RowBox[{"StringExpression", "[", 
                   RowBox[{
                   "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                 "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], "}"}]}], 
           "]"}]}], "]"}], ",", "  ", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"input", ",", 
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"input", ",", 
               RowBox[{
               "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", 
                "~~", " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", 
                "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"input", ",", 
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)(\>\"", "~~", 
                    "LetterCharacter", "~~", "LetterCharacter", "~~", " ", 
                    "\"\<)\>\""}]}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
                RowBox[{"StringExpression", "[", 
                 RowBox[{
                 "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                  "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], "]"}],
               "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
         "]"}]}], "]"}], ",", "\"\<))\>\""}], "]"}], ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<(\>\"", ",", " ", 
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"input", ",", 
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)(\>\"", "~~", 
                    "LetterCharacter", "~~", "LetterCharacter", "~~", " ", 
                    "\"\<)\>\""}]}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", " ", 
                    RowBox[{"StringExpression", "[", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], 
                 "}"}]}], "]"}]}], "]"}], ",", "\"\<(\>\""}], "]"}], ",", 
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"input", ",", 
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"input", ",", 
                 RowBox[{
                 "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                  "LetterCharacter", "~~", " ", "\"\<)(\>\"", "~~", 
                  "LetterCharacter", "~~", "LetterCharacter", "~~", " ", 
                  "\"\<)\>\""}]}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"StringPosition", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{"StringExpression", "[", 
                   RowBox[{
                   "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], 
                 "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}], "}"}]}], 
           "]"}]}], "]"}], ",", "  ", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"input", ",", 
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"input", ",", 
               RowBox[{
               "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", 
                "~~", " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", 
                "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"input", ",", 
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                    "LetterCharacter", "~~", " ", "\"\<)(\>\"", "~~", 
                    "LetterCharacter", "~~", "LetterCharacter", "~~", " ", 
                    "\"\<)\>\""}]}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
                RowBox[{"StringExpression", "[", 
                 RowBox[{
                 "\"\<(\>\"", "~~", "LetterCharacter", "~~", 
                  "LetterCharacter", "~~", " ", "\"\<)\>\""}], "]"}]}], "]"}],
               "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
         "]"}]}], "]"}], ",", "\"\<))\>\""}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.559846140185568*^9, {3.559846170444057*^9, 3.55984624630652*^9}, {
   3.5598565303366737`*^9, 3.559856662328196*^9}, 3.559919169111569*^9, {
   3.559920557531501*^9, 3.5599206358007107`*^9}, {3.5599211878564253`*^9, 
   3.559921206491829*^9}, {3.559921315084011*^9, 3.55992132541403*^9}, {
   3.5599213598168488`*^9, 3.5599213664178867`*^9}, {3.559921430363941*^9, 
   3.559921470171504*^9}, {3.559921533376636*^9, 3.559921534445594*^9}, {
   3.559923892743413*^9, 3.559923894055723*^9}, {3.55992392431427*^9, 
   3.5599240158790894`*^9}, {3.559924593102748*^9, 3.559924598506654*^9}, {
   3.559924752543654*^9, 3.5599247546819553`*^9}, {3.559924887804442*^9, 
   3.559924888165824*^9}}],

Cell[BoxData[
 RowBox[{"distributorTock", "[", "\"\<(ab)(ac)\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.5599206922048807`*^9, 3.5599207189212723`*^9}}],

Cell[BoxData[
 RowBox[{"distributorTock", "[", "test3", "]"}]], "Input",
 CellChangeTimes->{{3.559924631377322*^9, 3.5599246398839684`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"StringReplacePart", "[", 
   RowBox[{"test3", ",", 
    RowBox[{"distributorTock", "[", 
     RowBox[{"StringTake", "[", 
      RowBox[{"test3", ",", 
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test3", ",", 
          RowBox[{
          "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~",
            " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", 
           "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"StringPosition", "[", 
     RowBox[{"test3", ",", 
      RowBox[{
      "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", 
       " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~",
        " ", "\"\<)\>\""}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5599247785481462`*^9, 3.559924816898604*^9}, 
   3.559924874121398*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistributorTook", "[", "input_", "]"}], ":=", 
  RowBox[{"StringReplacePart", "[", 
   RowBox[{"input", ",", 
    RowBox[{"distributorTock", "[", 
     RowBox[{"StringTake", "[", 
      RowBox[{"input", ",", 
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"input", ",", 
          RowBox[{
          "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~",
            " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", 
           "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
    RowBox[{"StringPosition", "[", 
     RowBox[{"input", ",", 
      RowBox[{
      "\"\<(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~", 
       " ", "\"\<)(\>\"", "~~", "LetterCharacter", "~~", "LetterCharacter", "~~",
        " ", "\"\<)\>\""}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DistributorTook", "[", "\"\<((i))(((ab)(bc)(e))((fg)(h))\>\"", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.559924617579257*^9, 3.5599246176039467`*^9}, {
  3.5599249112174892`*^9, 3.559924961790872*^9}, {3.559925539735409*^9, 
  3.559925553776206*^9}}],

Cell[BoxData["\"\<((i))(((a(bc))(b(bc))(e))((fg)(h))\>\""], "Input",
 CellChangeTimes->{3.5600811819141703`*^9}],

Cell[BoxData[
 RowBox[{"DistributorTook", "[", "\"\<(ab)(cd)\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.560081186962215*^9, 3.5600812051214457`*^9}}],

Cell[BoxData[
 RowBox[{"DistributorTook", "[", "\"\<(ab)(c)\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.56008134498488*^9, 3.560081354739523*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.559921485219088*^9, 3.559921527009886*^9}, 
   3.559924553825841*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"test4", " ", "=", "\"\<(ab)(cdefg)\>\""}], "\[IndentingNewLine]", 
 RowBox[{"test5", " ", "=", 
  "\"\<((i)(ab)(cdefg))(fg)(gh)\>\""}], "\[IndentingNewLine]", 
 RowBox[{"StringCases", "[", 
  RowBox[{"test4", ",", " ", 
   RowBox[{"RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"distributorTick", "[", "test4", "]"}]}], "Input",
 CellChangeTimes->{{3.5599285338074903`*^9, 3.559928564622253*^9}, {
  3.559928598795272*^9, 3.559928607276311*^9}, {3.559928680390202*^9, 
  3.559928683578115*^9}, {3.5599287740844584`*^9, 3.559928775002799*^9}, {
  3.559928851489436*^9, 3.559928917820867*^9}, {3.5599289559891157`*^9, 
  3.559928958757015*^9}, {3.559929007897812*^9, 3.5599290107212877`*^9}, {
  3.5599290924807253`*^9, 3.559929101089142*^9}, {3.559929135504478*^9, 
  3.559929153645464*^9}, {3.559939484706317*^9, 3.5599394860456753`*^9}, {
  3.560273325754579*^9, 3.560273389739051*^9}}],

Cell[BoxData["\<\"(ab)(bc)efg)\"\>"], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.5599285652616463`*^9, {3.559928599706636*^9, 3.559928607642902*^9}, 
   3.559928853995043*^9, {3.5599288860087748`*^9, 3.559928918297254*^9}, {
   3.559928959402581*^9, 3.5599289641777763`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"test4", ",", "2"}], "]"}], ",", 
          RowBox[{
           RowBox[{"StringCases", "[", 
            RowBox[{"test4", ",", " ", 
             RowBox[{
             "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
            "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\"\<(\>\""}], " ", 
       "]"}], ",", 
      RowBox[{"StringTake", "[", 
       RowBox[{"test4", ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{"StringCases", "[", 
      RowBox[{"test4", ",", " ", 
       RowBox[{"RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
      "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.559939495873293*^9, 3.559939502189932*^9}, {
   3.560268847262072*^9, 3.560268848063053*^9}, {3.560268903897584*^9, 
   3.56026892235144*^9}, {3.560268959718206*^9, 3.560268977205999*^9}, {
   3.560269070904111*^9, 3.560269124505862*^9}, {3.5602693751400642`*^9, 
   3.5602694150845623`*^9}, {3.560269549407009*^9, 3.560269549542162*^9}, {
   3.560269792024918*^9, 3.5602698639420547`*^9}, {3.560269982782598*^9, 
   3.560270238244958*^9}, {3.560272407642502*^9, 3.560272410108926*^9}, {
   3.560272782440722*^9, 3.56027281150069*^9}, 3.5602734858144608`*^9}],

Cell[BoxData[{
 RowBox[{"\"\<(a(cdefg)(b(cdefg)\>\"", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"StringPosition", "[", 
  RowBox[{"test4", ",", 
   RowBox[{
   "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.560273454199621*^9, 3.560273490987008*^9}, {
  3.5602735419281683`*^9, 3.560273546839389*^9}}],

Cell[BoxData[
 RowBox[{"StringPosition", "[", 
  RowBox[{"test5", ",", 
   RowBox[{
   "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\\\\([a-z]{2,}\\\\)\>\"", 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.560273556464508*^9, 3.560273574166149*^9}, {
  3.560273672210711*^9, 3.560273685259295*^9}, {3.560362331310111*^9, 
  3.5603623314464808`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "15"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"17", ",", "24"}], "}"}]}], "}"}], "\[IndentingNewLine]"}]], \
"Input",
 CellChangeTimes->{{3.560362875634767*^9, 3.560362930982971*^9}, {
   3.560364494798436*^9, 3.560364512836892*^9}, 3.560364729399703*^9}],

Cell[BoxData[
 RowBox[{"StringJoin", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringTake", "[", 
          RowBox[{"test4", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"test4", ",", 
                RowBox[{
                "RegularExpression", "[", 
                 "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", "]"}]}], "]"}], 
              "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}]}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"StringCases", "[", 
           RowBox[{"test4", ",", " ", 
            RowBox[{
            "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
           "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "\"\<(\>\""}], " ", 
      "]"}], ",", 
     RowBox[{"StringTake", "[", 
      RowBox[{"test4", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"test4", ",", 
             RowBox[{
             "RegularExpression", "[", 
              "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}], 
      "]"}]}], "]"}], ",", 
   RowBox[{
    RowBox[{"StringCases", "[", 
     RowBox[{"test4", ",", " ", 
      RowBox[{"RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
     "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.560364733153803*^9, 3.560364734970171*^9}, {
  3.560365480023312*^9, 3.560365567017544*^9}, {3.560365906277287*^9, 
  3.560365939806074*^9}, {3.5603670175138474`*^9, 3.560367046613359*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistributePass3", "[", "input_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", 
      RowBox[{"StringPosition", "[", 
       RowBox[{"input", ",", 
        RowBox[{
        "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", 
         "]"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"input", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "RegularExpression", "[", 
                    "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", "]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}]}], 
                "]"}], ",", 
               RowBox[{
                RowBox[{"StringCases", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                  "RegularExpression", "[", "\"\<\\\\(*([a-z]+\\\\)*)\>\"", 
                   "]"}]}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}]}], "]"}], 
             ",", "\"\<(\>\""}], " ", "]"}], ",", 
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"StringPosition", "[", 
                  RowBox[{"input", ",", 
                   RowBox[{
                   "RegularExpression", "[", 
                    "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", "]"}]}], 
                  "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], "}"}]}],
             "]"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"StringCases", "[", 
           RowBox[{"input", ",", " ", 
            RowBox[{
            "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"StringDrop", "[", 
        RowBox[{"input", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"input", ",", 
             RowBox[{
             "RegularExpression", "[", 
              "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", "]"}]}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DistributePass3", "[", "test4", "]"}], "\[IndentingNewLine]", 
 RowBox[{"DistributePass3", "[", "test5", "]"}], "\[IndentingNewLine]", 
 RowBox[{"DistributorPass3", "[", "test", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/eX1kvDbba8cl3DfB9M/9zFsBdE7+h/sB9Gd9z1e
geiY05XvQHRBoUHpHSC9eMHlChDNkHKjHUTv4ajvAtG7iiwngOhXJ45MBNGz
mdZPB9EuNWazQfQHky+cd4G0zzwOXhCto+ioAqJfsSuogegDDok6INrMthlM
Hzp0q+sLkL5y3rgbRB+XNZkIoqO5aqaC6C+9zgtBdFRq2lIQHRKgtRasPv/h
OhBtztO2FUTznJl2CEQnLT347ReQ1mAK+guid1Qt5f8NpG/oRAiA6LycScUg
+sq7+2UgOkN/bxWIPvdOoAZEaxxsbwDRZj8vNILonZc/LGNrf+XY1zZ7OYgG
ADJew3M=
  "]],

Cell[BoxData[{
 RowBox[{"StringDrop", "[", 
  RowBox[{"test5", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test5", ",", 
       RowBox[{
       "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", 
        "]"}]}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringPosition", "[", 
  RowBox[{"test5", ",", 
   RowBox[{
   "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", 
    "]"}]}], "]"}], "\[IndentingNewLine]", "test5"}], "Input",
 CellChangeTimes->{{3.560427956871398*^9, 3.5604280076470346`*^9}, {
  3.560428049843206*^9, 3.5604280551359997`*^9}, {3.560429433322351*^9, 
  3.560429484806162*^9}, {3.560450310747592*^9, 3.560450333979147*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.560270131728365*^9, 3.560270135684095*^9}, 
   3.560430660103373*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.560270131728365*^9, 3.560270135684095*^9}, 
   3.560430660103373*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistributePass3", "[", "input_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", 
      RowBox[{"StringPosition", "[", 
       RowBox[{"input", ",", 
        RowBox[{
        "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", 
         "]"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"input", ",", 
            RowBox[{
            "RegularExpression", "[", 
             "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", "]"}]}], "]"}], "[", 
          
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"input", ",", 
            RowBox[{
            "RegularExpression", "[", 
             "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", "]"}]}], "]"}], "[", 
          
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], " ", ">", " ", "6"}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{
               RowBox[{"StringJoin", "[", 
                RowBox[{
                 RowBox[{"StringTake", "[", 
                  RowBox[{"input", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "RegularExpression", "[", 
                    "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", "]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "1"}]}], 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"StringCases", "[", 
                   RowBox[{"input", ",", " ", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<\\\\(*([a-z]+\\\\)*)\>\"", 
                    "]"}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}]}], "]"}], 
               ",", "\"\<(\>\""}], " ", "]"}], ",", 
             RowBox[{"StringTake", "[", 
              RowBox[{"input", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "RegularExpression", "[", 
                    "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", "]"}]}], 
                    "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", "2"}], 
                "}"}]}], "]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"StringCases", "[", 
             RowBox[{"input", ",", " ", 
              RowBox[{
              "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", " ", "+", " ", "1"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"StringDrop", "[", 
          RowBox[{"input", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"input", ",", 
               RowBox[{
               "RegularExpression", "[", 
                "\"\<\\\\([a-z]+\\\\)\\\\([a-z]+\\\\)\>\"", "]"}]}], "]"}], 
             "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Does not satisfy axiom\>\"", "]"}]}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DistributePass3", "[", "test4", "]"}], "\[IndentingNewLine]", 
 RowBox[{"DistributePass3", "[", "test5", "]"}], "\[IndentingNewLine]", 
 RowBox[{"DistributePass3", "[", "\"\<(a(cdefg)(b(cdefg)\>\"", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.5604306764475307`*^9, {3.560448985605205*^9, 3.5604490939006243`*^9}, {
   3.5604491482522573`*^9, 3.56044916778471*^9}, {3.560449238284211*^9, 
   3.560449307350019*^9}, {3.560449363267912*^9, 3.5604493731496*^9}, {
   3.56044949119491*^9, 3.560449491385683*^9}, {3.560449526307967*^9, 
   3.560449553702937*^9}, {3.560449742323892*^9, 3.560449764732452*^9}, {
   3.560449810328583*^9, 3.560449862754052*^9}, {3.560449980382557*^9, 
   3.560450002173585*^9}, {3.5604502944797363`*^9, 3.560450297396584*^9}, {
   3.560450368716807*^9, 3.5604503842593327`*^9}, {3.5604505306696787`*^9, 
   3.560450543604577*^9}, {3.560450575620551*^9, 3.560450619925166*^9}, {
   3.560450853932932*^9, 3.560451073439324*^9}, {3.560451131531636*^9, 
   3.560451159720273*^9}, {3.560512142020123*^9, 3.560512149823546*^9}, {
   3.560512201998361*^9, 3.560512244561714*^9}}],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.559925190463564*^9, 3.5599251937649183`*^9}}],

Cell[BoxData[""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.559762969055382*^9, 3.5597693531729527`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.559846179509017*^9, 3.559846180477523*^9}, {
  3.5604595891022673`*^9, 3.560459589629095*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"test7", "=", " ", 
  "\"\<((a)(b))((c))\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StringTake", "[", 
   RowBox[{"test7", ",", " ", 
    RowBox[{"StringPosition", "[", 
     RowBox[{"test7", ",", " ", 
      RowBox[{
      "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], 
     "]"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.5593876311253147`*^9, 3.5593876314406433`*^9}, {
  3.560080452249696*^9, 3.560080464937752*^9}, {3.5600806291990423`*^9, 
  3.560080629542639*^9}, {3.560453580441916*^9, 3.560453585513198*^9}, {
  3.560459586381311*^9, 3.560459607252499*^9}, {3.5606126798423777`*^9, 
  3.5606127350853157`*^9}, {3.560614910311323*^9, 3.560614925991879*^9}, {
  3.56061583386615*^9, 3.560615834025301*^9}, {3.5606169028616467`*^9, 
  3.5606169030207453`*^9}, {3.5616621980556097`*^9, 3.5616622023240423`*^9}}],

Cell[BoxData["\<\"((a)(b))((c))\"\>"], "Output",
 CellChangeTimes->{3.561662202969449*^9}],

Cell[BoxData["\<\"(a)\"\>"], "Output",
 CellChangeTimes->{3.561662202971767*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"StringPosition", "[", 
  RowBox[{"test7", ",", 
   RowBox[{
   "\"\<((\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)(\>\"", " ", "~~", 
    "LetterCharacter", "~~", " ", "\"\<))\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.560615219302678*^9, 3.5606152437157183`*^9}, {
  3.560615330303461*^9, 3.560615352470138*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.560615163391265*^9, 3.560615178165977*^9}}],

Cell[BoxData[
 RowBox[{"StringPosition", "[", 
  RowBox[{"test7", ",", "\"\<)(\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.5606129788933487`*^9, 3.560612990902858*^9}, {
  3.560613276983625*^9, 3.5606132816606197`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"test7", ",", " ", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"test7", ",", " ", 
               RowBox[{
               "\"\<((\>\"", "~~", "LetterCharacter", "~~", " ", 
                "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"test7", ",", " ", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"test7", ",", " ", 
               RowBox[{
               "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", 
                "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", " ", "\"\<)(\>\""}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"test7", ",", " ", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"test7", ",", " ", 
           RowBox[{
           "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], 
          "]"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"test7", ",", " ", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"test7", ",", " ", 
           RowBox[{
           "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], 
          "]"}]}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", "\"\<))\>\""}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.5606151824938097`*^9, 3.5606151920367928`*^9}, {
  3.560615370228183*^9, 3.560615372178941*^9}, {3.5606154794502277`*^9, 
  3.560615482409711*^9}, {3.560615659396785*^9, 3.560615663707255*^9}, {
  3.560615694920377*^9, 3.560615730298626*^9}, {3.560615848363514*^9, 
  3.560615854305543*^9}, {3.560615996781719*^9, 3.560615999670267*^9}, {
  3.5606169116082153`*^9, 3.560616917590723*^9}, {3.5606173683922977`*^9, 
  3.5606174057859*^9}, {3.560617455843856*^9, 3.560617496593708*^9}, {
  3.5606178744412727`*^9, 3.5606179096549377`*^9}, {3.560618146771174*^9, 
  3.560618187850463*^9}, {3.560618427225878*^9, 3.560618431523263*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistributePass6", "[", "input_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", " ", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"input", ",", " ", 
               RowBox[{
               "\"\<((\>\"", "~~", "LetterCharacter", "~~", " ", 
                "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", " ", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"input", ",", " ", 
               RowBox[{
               "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", 
                "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", " ", "\"\<)(\>\""}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"input", ",", " ", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"input", ",", " ", 
           RowBox[{
           "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], 
          "]"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"input", ",", " ", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"input", ",", " ", 
           RowBox[{
           "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], 
          "]"}]}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", "\"\<))\>\""}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.560920586392112*^9, 3.560920597093672*^9}, {
   3.5609208494038*^9, 3.560920873505959*^9}, 3.5610431317060213`*^9, {
   3.561043381283988*^9, 3.5610433875806303`*^9}, {3.561045690821766*^9, 
   3.5610456993620167`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DistributePass6", "[", "test7", "]"}]], "Input",
 CellChangeTimes->{{3.561131982717538*^9, 3.561131991108692*^9}}],

Cell[BoxData["\<\"((a)(c))((b)(c)))\"\>"], "Output",
 CellChangeTimes->{3.561662212909795*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistributePass6", "[", "input_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", " ", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"input", ",", " ", 
               RowBox[{
               "\"\<((\>\"", "~~", "LetterCharacter", "~~", " ", 
                "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", " ", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"input", ",", " ", 
               RowBox[{
               "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", 
                "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", " ", "\"\<)(\>\""}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"input", ",", " ", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"input", ",", " ", 
           RowBox[{
           "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], 
          "]"}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"input", ",", " ", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"input", ",", " ", 
           RowBox[{
           "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], 
          "]"}]}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", "\"\<))\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{3.56113238498822*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistributePass6", "[", "input_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "3"}], ",", 
    RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"input", ",", " ", 
                RowBox[{"StringPosition", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                  "\"\<((\>\"", "~~", "LetterCharacter", "~~", " ", 
                   "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"input", ",", " ", 
                RowBox[{"StringPosition", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                  "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", 
                   "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
           "\"\<)(\>\""}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"input", ",", " ", 
            RowBox[{"StringPosition", "[", 
             RowBox[{"input", ",", " ", 
              RowBox[{
              "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", 
               "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"input", ",", " ", 
            RowBox[{"StringPosition", "[", 
             RowBox[{"input", ",", " ", 
              RowBox[{
              "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", 
               "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "2"}], "]"}], "]"}]}], "]"}], ",", 
       "\"\<))\>\""}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.560601615139909*^9, 3.560601622872908*^9}, 
   3.5606016569074497`*^9, {3.5611327463953*^9, 3.561132788734208*^9}, {
   3.561133072010727*^9, 3.56113310042691*^9}, {3.561133223402693*^9, 
   3.561133236053192*^9}, {3.561133283245812*^9, 3.5611332926609163`*^9}, {
   3.561308977311637*^9, 3.561308987146894*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test10", " ", "=", " ", 
  "\"\<((a)(b))((c))((d)(e))((f))\>\""}]], "Input",
 CellChangeTimes->{{3.5611331856068277`*^9, 3.561133203029874*^9}}],

Cell[BoxData["\<\"((a)(b))((c))((d)(e))((f))\"\>"], "Output",
 CellChangeTimes->{3.561643903307495*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DistributePass6", "[", "test10", "]"}]], "Input",
 CellChangeTimes->{{3.561133208152762*^9, 3.5611332181104517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistributePass6Part1", "[", "input_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", " ", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"input", ",", " ", 
               RowBox[{
               "\"\<((\>\"", "~~", "LetterCharacter", "~~", " ", 
                "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", " ", 
             RowBox[{"StringPosition", "[", 
              RowBox[{"input", ",", " ", 
               RowBox[{
               "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", 
                "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "2"}], "]"}], "]"}]}], "]"}], ",", " ", 
        "\"\<)(\>\""}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"input", ",", " ", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"input", ",", " ", 
           RowBox[{
           "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], 
          "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"input", ",", " ", 
         RowBox[{"StringPosition", "[", 
          RowBox[{"input", ",", " ", 
           RowBox[{
           "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], 
          "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", "+", "2"}], "]"}], "]"}]}], "]"}], ",", "\"\<))\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.5613097283990517`*^9, {3.5614843000007067`*^9, 3.561484307680834*^9}, {
   3.561485442594654*^9, 3.561485444536137*^9}}],

Cell[BoxData[
 RowBox[{"DistributePass6", "[", "test10", "]"}]], "Input",
 CellChangeTimes->{{3.56148408479739*^9, 3.5614840921722317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistributePass6", "[", "input_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "0"}], ",", 
    RowBox[{"i", " ", "<", " ", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"StringPosition", "[", 
        RowBox[{"input", ",", 
         RowBox[{
         "RegularExpression", "[", 
          "\"\<\\\\(\\\\([a-z]\\\\)\\\\([a-z]\\\\)\\\\)\\\\(\\\\([a-z]\\\\)\\\
\\)\>\"", "]"}]}], "]"}], "]"}], "+", "1"}]}], ",", " ", 
    RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"StringReplacePart", "[", 
      RowBox[{"input", ",", 
       RowBox[{"DistributePass6Part1", "[", 
        RowBox[{"StringTake", "[", 
         RowBox[{"input", ",", 
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"input", ",", 
             RowBox[{
             "RegularExpression", "[", 
              "\"\<\\\\(\\\\([a-z]\\\\)\\\\([a-z]\\\\)\\\\)\\\\(\\\\([a-z]\\\\\
)\\\\)\>\"", "]"}]}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"input", ",", 
          RowBox[{
          "RegularExpression", "[", 
           "\"\<\\\\(\\\\([a-z]\\\\)\\\\([a-z]\\\\)\\\\)\\\\(\\\\([a-z]\\\\)\\\
\\))\>\"", "]"}]}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.561484355355729*^9, 3.5614843885584183`*^9}, {
  3.561484608813663*^9, 3.561484609020891*^9}, {3.561484679913877*^9, 
  3.5614846816970873`*^9}, {3.561485057585103*^9, 3.561485057735053*^9}, {
  3.561485110319295*^9, 3.561485125470847*^9}, {3.561485420714411*^9, 
  3.561485420875619*^9}, {3.56148547315303*^9, 3.561485473724215*^9}, {
  3.5616438781482277`*^9, 3.561643880159009*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5616438750747833`*^9, 3.56164387656711*^9}}],

Cell[BoxData[""], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"StringPosition", "[", 
   RowBox[{"test10", ",", 
    RowBox[{
    "RegularExpression", "[", 
     "\"\<\\\\(\\\\([a-z]\\\\)\\\\([a-z]\\\\)\\\\)\\\\(\\\\([a-z]\\\\)\\\\)\>\
\"", "]"}]}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"DistributePass6", "[", "test10", "]"}]}], "Input",
 CellChangeTimes->{{3.56008062635483*^9, 3.560080626368622*^9}, {
  3.561293308600037*^9, 3.5612933155676603`*^9}, {3.5612933970863037`*^9, 
  3.5612933977525997`*^9}, {3.561484643601677*^9, 3.5614846459258633`*^9}, {
  3.5614850794590397`*^9, 3.561485081331162*^9}, {3.561485141901231*^9, 
  3.561485150674803*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", "@", ")"}], " ", 
      RowBox[{"(", "#", ")"}]}], ")"}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "&", ")"}], "--"}], "--"}], "--"}]}], ">", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", "@", ")"}], 
       RowBox[{"(", "&", ")"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", "#", ")"}], 
       RowBox[{"(", "&", ")"}]}], ")"}]}], ")"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.560080860942507*^9, 3.560080860944387*^9}, {
  3.5600809785032587`*^9, 3.56008100145802*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"done", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", "@", ")"}], " ", 
      RowBox[{"(", "#", ")"}]}], ")"}], " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"(", "&", ")"}], ")"}], "--"}], "--"}]}], "\[Rule]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", "@", ")"}], 
       RowBox[{"(", "&", ")"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", "#", ")"}], 
       RowBox[{"(", "&", ")"}]}], ")"}]}], ")"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.560080784203018*^9, 3.560080784205093*^9}, {
  3.560080993188958*^9, 3.5600810051380577`*^9}, {3.561676646280459*^9, 
  3.561676647410314*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{")", " ", 
        RowBox[{"(", "#", ")"}]}], ")"}], " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(", "&", ")"}], ")"}], "--"}], "--"}]}], "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{")", 
            RowBox[{"(", "&", ")"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", "#", ")"}], 
            RowBox[{"(", "&", ")"}]}], ")"}]}], ")"}], 
        " "}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.560080776193664*^9, {3.560080982571855*^9, 3.5600809890907087`*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{"target", " ", "=", " ", "\"\<(((a)(c)) ((b)(c)))\>\""}]], "Input",
 CellChangeTimes->{{3.5600806384355288`*^9, 3.560080646823118*^9}, {
  3.560459614892804*^9, 3.560459616309655*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"test6", " ", "=", " ", 
  "\"\< (a(defghi))(b(defghi))\>\""}], "\[IndentingNewLine]", 
 RowBox[{"target6", " ", "=", 
  "\"\<(a((b(defghi))))((defghi)(b(defghi))\>\""}]}], "Input",
 CellChangeTimes->{{3.560512394220461*^9, 3.5605123942236557`*^9}, {
   3.5605128279110193`*^9, 3.560512867244011*^9}, 3.561121521365996*^9}],

Cell[BoxData["\<\" (a(defghi))(b(defghi))\"\>"], "Output",
 CellChangeTimes->{3.561643893024743*^9, 3.563636417512416*^9}],

Cell[BoxData["\<\"(a((b(defghi))))((defghi)(b(defghi))\"\>"], "Output",
 CellChangeTimes->{3.561643893024743*^9, 3.563636417514619*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistributePass6", "[", "input_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "0"}], ",", 
    RowBox[{"i", " ", "<", " ", 
     RowBox[{
      RowBox[{"Length", " ", "[", 
       RowBox[{"StringPosition", "[", 
        RowBox[{"input", ",", " ", 
         RowBox[{
         "\"\<((\>\"", "~~", "LetterCharacter", "~~", " ", "\"\<)\>\""}]}], 
        "]"}], "]"}], " ", "-", "3"}]}], ",", 
    RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"input", ",", " ", 
                RowBox[{"StringPosition", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                  "\"\<((\>\"", "~~", "LetterCharacter", "~~", " ", 
                   "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"input", ",", " ", 
                RowBox[{"StringPosition", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                  "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", 
                   "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", " ", 
           "\"\<)(\>\""}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"input", ",", " ", 
            RowBox[{"StringPosition", "[", 
             RowBox[{"input", ",", " ", 
              RowBox[{
              "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", 
               "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"input", ",", " ", 
            RowBox[{"StringPosition", "[", 
             RowBox[{"input", ",", " ", 
              RowBox[{
              "\"\<(\>\"", "~~", "LetterCharacter", "~~", " ", 
               "\"\<)\>\""}]}], "]"}]}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", "\"\<))\>\""}], "]"}],
      " ", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DistributePass6", "[", "test10", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5610457086060047`*^9, 3.5610457139408083`*^9}, {
  3.5610581316642303`*^9, 3.561058164059407*^9}, {3.5610613111300287`*^9, 
  3.561061368620658*^9}, {3.561131944683484*^9, 3.561131962049658*^9}, {
  3.561309692190977*^9, 3.561309694284924*^9}}],

Cell[BoxData[{
 RowBox[{"StringPosition", "[", 
  RowBox[{"test6", ",", 
   RowBox[{"RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringPosition", "[", 
  RowBox[{"test6", ",", " ", 
   RowBox[{"RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.561065685562874*^9, 3.561065693731439*^9}, 
   3.561066420109674*^9, 3.561068171589422*^9, {3.561068415027281*^9, 
   3.5610684422095137`*^9}, {3.561116458480221*^9, 3.561116493537874*^9}, {
   3.561116618330386*^9, 3.561116620127116*^9}}],

Cell[BoxData[{
 RowBox[{"StringTake", "[", 
  RowBox[{"test6", ",", 
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"test6", ",", 
      RowBox[{"RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StringTake", "[", 
  RowBox[{"test6", ",", " ", 
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"test6", ",", " ", 
      RowBox[{"RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
     "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5611166260956593`*^9, 3.561116664343742*^9}}],

Cell[BoxData[
 RowBox[{"StringJoin", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"test6", ",", " ", 
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test6", ",", " ", 
               RowBox[{
               "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"StringTake", "[", 
           RowBox[{"test6", ",", " ", 
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test6", ",", " ", 
               RowBox[{
               "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
              "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"StringTake", "[", 
           RowBox[{"test6", ",", 
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test6", ",", 
               RowBox[{
               "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
       "\"\<)))\>\""}], "]"}], ",", 
     RowBox[{"StringTake", "[", 
      RowBox[{"test6", ",", 
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test6", ",", 
          RowBox[{
          "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"StringDrop", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"test6", ",", " ", 
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"test6", ",", " ", 
             RowBox[{
             "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
            "]"}], "[", 
           RowBox[{"[", "2", "\[IndentingNewLine]", "]"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], ",", 
      RowBox[{"StringTake", "[", 
       RowBox[{"test6", ",", 
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"test6", ",", 
           RowBox[{
           "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
   "\"\<)\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.561116974522361*^9, 3.561117063453961*^9}, {
  3.561117146207478*^9, 3.5611171632798843`*^9}, {3.561117491716344*^9, 
  3.561117530527861*^9}, {3.5611175755594387`*^9, 3.561117578757918*^9}, {
  3.561117609529108*^9, 3.56111761741917*^9}, {3.561117671367956*^9, 
  3.56111771167977*^9}, {3.5611180444486523`*^9, 3.561118064910203*^9}, {
  3.561119271856049*^9, 3.561119277494475*^9}, {3.561120141714259*^9, 
  3.561120144067885*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"target6", "\[IndentingNewLine]", 
 RowBox[{"StringJoin", "[", 
  RowBox[{
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"test6", ",", " ", 
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test6", ",", " ", 
               RowBox[{
               "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"StringTake", "[", 
           RowBox[{"test6", ",", " ", 
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"test6", ",", " ", 
               RowBox[{
               "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
              "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"StringDrop", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"test6", ",", 
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"test6", ",", 
                 RowBox[{
                 "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", 
                  "]"}]}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], "]"}], ",", 
       "\"\<)))(\>\""}], "]"}], ",", 
     RowBox[{"StringTake", "[", 
      RowBox[{"test6", ",", 
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test6", ",", 
          RowBox[{
          "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
         "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"StringDrop", "[", 
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"test6", ",", " ", 
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"test6", ",", " ", 
             RowBox[{
             "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
            "]"}], "[", 
           RowBox[{"[", "2", "\[IndentingNewLine]", "]"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"{", "3", "}"}]}], "]"}], ",", 
      RowBox[{"StringTake", "[", 
       RowBox[{"test6", ",", 
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"test6", ",", 
           RowBox[{
           "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
          "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
   "\"\<)\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.561129609573353*^9, 3.5611296247821283`*^9}, {
  3.561129697361126*^9, 3.561129728552462*^9}, {3.561129851350692*^9, 
  3.561129854842012*^9}, {3.561130002326971*^9, 3.5611300037546883`*^9}}],

Cell[BoxData["\<\"(a((b(defghi))))((defghi)(b(defghi))\"\>"], "Output",
 CellChangeTimes->{{3.563636409934651*^9, 3.563636428268237*^9}}],

Cell[BoxData["\<\"(a((b(defghi))))((defghi)(b(defghi))\"\>"], "Output",
 CellChangeTimes->{{3.563636409934651*^9, 3.563636428269971*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
  "test8", " ", "=", " ", 
   "\"\<(a(defghi))(b(defghi))(c(defghi))(d(defghi))\>\""}]}]], "Input",
 CellChangeTimes->{{3.5611300055042677`*^9, 3.561130041570612*^9}, {
  3.561132350602605*^9, 3.561132351250695*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistributorPass7", "[", "input_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "3"}], ",", 
    RowBox[{"++", "i"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", " ", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", 
                    "]"}]}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"StringTake", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", " ", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", 
                    "]"}]}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", " ", "1"}], "]"}], "]"}]}], "]"}], ",", 
                
                RowBox[{"StringDrop", "[", 
                 RowBox[{
                  RowBox[{"StringTake", "[", 
                   RowBox[{"input", ",", 
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", 
                    "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", " ", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  
                  RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], "]"}], ",", 
             "\"\<)))(\>\""}], "]"}], ",", 
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", 
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"input", ",", 
                RowBox[{
                "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}],
                "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringDrop", "[", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"input", ",", " ", 
                RowBox[{
                 RowBox[{"StringPosition", "[", 
                  RowBox[{"input", ",", " ", 
                   RowBox[{
                   "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", 
                    "]"}]}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "\[IndentingNewLine]", "]"}], 
                 "]"}]}], "]"}], ",", 
              RowBox[{"{", "3", "}"}]}], "]"}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{"input", ",", 
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"input", ",", 
                 RowBox[{
                 "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", 
                  "]"}]}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
         "\"\<)\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"input", ",", " ", 
             RowBox[{
             "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
            "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringPosition", "[", 
             RowBox[{"input", ",", " ", 
              RowBox[{
              "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "2"}], "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DistributorPass7", "[", "test8", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.561117055106825*^9, 3.5611170558191357`*^9}, {
   3.561120604504505*^9, 3.561120667739403*^9}, 3.5611208099453697`*^9, 
   3.561121416978107*^9, {3.5611215502916737`*^9, 3.5611215952329693`*^9}, {
   3.561130472335103*^9, 3.561130518450325*^9}, {3.56113059723796*^9, 
   3.561130657434957*^9}, {3.561131558429706*^9, 3.561131643169568*^9}, {
   3.5612383423820972`*^9, 3.561238396081827*^9}, {3.561242443456747*^9, 
   3.561242443643702*^9}, {3.561295093171783*^9, 3.561295131872527*^9}, {
   3.56129518693777*^9, 3.5612951896990757`*^9}, {3.561295661143359*^9, 
   3.561295661965375*^9}, {3.561394376741797*^9, 3.561394415167968*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5613941723250713`*^9, 3.561394174090206*^9}}],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.561131576253394*^9, 3.561131582662478*^9}, {
   3.561238405215304*^9, 3.561238406167248*^9}, {3.5612934745539007`*^9, 
   3.561293474857356*^9}, {3.561293997923999*^9, 3.561293999698938*^9}, 
   3.561394380659992*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test8", ",", 
       RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
      "]"}], "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], "]"}], 
  "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test8", ",", 
       RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
      "]"}], "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], "]"}], 
  "<>", 
  RowBox[{"StringDrop", "[", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"test8", ",", 
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test8", ",", 
         RowBox[{
         "RegularExpression", "[", "\<\"\\\\([a-z]+\\\\)\"\>", "]"}]}], "]"}],
        "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], "]"}], ",", 
    
    RowBox[{"{", "1", "}"}]}], "]"}], "<>", "\<\")))(\"\>", "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test8", ",", 
       RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]+\\\\)\"\>", "]"}]}], 
      "]"}], "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], "]"}], 
  "<>", 
  RowBox[{"StringDrop", "[", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"test8", ",", 
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test8", ",", 
         RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}],
         "]"}], "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
     "]"}], ",", 
    RowBox[{"{", "3", "}"}]}], "]"}], "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test8", ",", 
       RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]+\\\\)\"\>", "]"}]}], 
      "]"}], "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], "]"}], 
  "<>", "\<\")\"\>", "<>", 
  RowBox[{
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"test8", ",", 
      RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
     "]"}], "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
   "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], "<>", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"StringPosition", "[", 
       RowBox[{"test8", ",", 
        RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
       "]"}], "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
     "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
   ")"}]}]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.561131614483382*^9, 3.5611316457240953`*^9}, {
   3.5612381972648163`*^9, 3.561238200044097*^9}, 3.561238374470607*^9, {
   3.5612384128955317`*^9, 3.561238413317533*^9}, {3.56129344984898*^9, 
   3.5612934732374773`*^9}, {3.5612940061069*^9, 3.5612940129452887`*^9}, 
   3.561294068302587*^9, {3.5613033361206837`*^9, 3.56130333682894*^9}, 
   3.561394178664077*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test8", ",", 
       RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
      "]"}], "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "]"}], 
  "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test8", ",", 
       RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
      "]"}], "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], "]"}], 
  "<>", 
  RowBox[{"StringDrop", "[", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"test8", ",", 
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test8", ",", 
         RowBox[{
         "RegularExpression", "[", "\<\"\\\\([a-z]+\\\\)\"\>", "]"}]}], "]"}],
        "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], "]"}], ",", 
    
    RowBox[{"{", "1", "}"}]}], "]"}], "<>", "\<\")))(\"\>", "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test8", ",", 
       RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]+\\\\)\"\>", "]"}]}], 
      "]"}], "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "]"}], 
  "<>", 
  RowBox[{"StringDrop", "[", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"test8", ",", 
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test8", ",", 
         RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}],
         "]"}], "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
     "]"}], ",", 
    RowBox[{"{", "3", "}"}]}], "]"}], "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test8", ",", 
       RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]+\\\\)\"\>", "]"}]}], 
      "]"}], "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "]"}], 
  "<>", "\<\")\"\>", "<>", 
  RowBox[{
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"test8", ",", 
      RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
     "]"}], "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
   "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "<>", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"StringPosition", "[", 
       RowBox[{"test8", ",", 
        RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
       "]"}], "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
     "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
   ")"}]}]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.561131614483382*^9, 3.5611316457240953`*^9}, {
   3.5612381972648163`*^9, 3.561238200044097*^9}, 3.561238374470607*^9, {
   3.5612384128955317`*^9, 3.561238413317533*^9}, {3.56129344984898*^9, 
   3.5612934732374773`*^9}, {3.5612940061069*^9, 3.5612940129452887`*^9}, 
   3.561294068302587*^9, {3.5613033361206837`*^9, 3.56130333682894*^9}, 
   3.561394178660417*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
   "]"}], "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{
     RowBox[{"StringPosition", "[", 
      RowBox[{"test8", ",", 
       RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
      "]"}], "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "]"}], 
  "<>", 
  RowBox[{"StringDrop", "[", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"test8", ",", 
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test8", ",", 
         RowBox[{
         "RegularExpression", "[", "\<\"\\\\([a-z]+\\\\)\"\>", "]"}]}], "]"}],
        "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "]"}], ",", 
    
    RowBox[{"{", "1", "}"}]}], "]"}], "<>", "\<\")))(\"\>", "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]+\\\\)\"\>", "]"}]}], 
   "]"}], "<>", 
  RowBox[{"StringDrop", "[", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"test8", ",", 
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test8", ",", 
         RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}],
         "]"}], "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
     "]"}], ",", 
    RowBox[{"{", "3", "}"}]}], "]"}], "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]+\\\\)\"\>", "]"}]}], 
   "]"}], "<>", "\<\")\"\>", "<>", 
  RowBox[{
   RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}], 
   "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "<>", 
  "3"}]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.561131614483382*^9, 3.5611316457240953`*^9}, {
   3.5612381972648163`*^9, 3.561238200044097*^9}, 3.561238374470607*^9, {
   3.5612384128955317`*^9, 3.561238413317533*^9}, {3.56129344984898*^9, 
   3.5612934732374773`*^9}, {3.5612940061069*^9, 3.5612940129452887`*^9}, 
   3.561294068302587*^9, {3.5613033361206837`*^9, 3.56130333682894*^9}, 
   3.561394178657153*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", "test8"}], "]"}], "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", 
    RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
   "]"}], "<>", 
  RowBox[{"StringDrop", "[", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"test8", ",", 
      RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]+\\\\)\"\>", "]"}]}], 
     "]"}], ",", 
    RowBox[{"{", "1", "}"}]}], "]"}], "<>", "\<\")))(\"\>", "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", "test8"}], "]"}], "<>", 
  RowBox[{"StringDrop", "[", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"test8", ",", 
      RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
     "]"}], ",", 
    RowBox[{"{", "3", "}"}]}], "]"}], "<>", 
  RowBox[{"StringTake", "[", 
   RowBox[{"test8", ",", "test8"}], "]"}], "<>", "\<\")\"\>", "<>", 
  RowBox[{"test8", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<>", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"StringPosition", "[", 
     RowBox[{"test8", ",", 
      RowBox[{"RegularExpression", "[", "\<\"\\\\([a-z]\\\\(\"\>", "]"}]}], 
     "]"}]}], ")"}]}]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.561131614483382*^9, 3.5611316457240953`*^9}, {
   3.5612381972648163`*^9, 3.561238200044097*^9}, 3.561238374470607*^9, {
   3.5612384128955317`*^9, 3.561238413317533*^9}, {3.56129344984898*^9, 
   3.5612934732374773`*^9}, {3.5612940061069*^9, 3.5612940129452887`*^9}, 
   3.561294068302587*^9, {3.5613033361206837`*^9, 3.56130333682894*^9}, 
   3.5613941786446753`*^9}],

Cell[BoxData[
 RowBox[{"\[LineSeparator]", "\[LineSeparator]"}]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.561131614483382*^9, 3.5611316457240953`*^9}, {
   3.5612381972648163`*^9, 3.561238200044097*^9}, 3.561238374470607*^9, {
   3.5612384128955317`*^9, 3.561238413317533*^9}, {3.56129344984898*^9, 
   3.5612934732374773`*^9}, {3.5612940061069*^9, 3.5612940129452887`*^9}, 
   3.561294068302587*^9, {3.5613033361206837`*^9, 3.56130333682894*^9}}],

Cell[BoxData[" "], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.561131614483382*^9, 3.5611316457240953`*^9}, {
   3.5612381972648163`*^9, 3.561238200044097*^9}, 3.561238416642888*^9, {
   3.5612937801754847`*^9, 3.561293788959543*^9}, {3.561293979136456*^9, 
   3.561294003690517*^9}, 3.56129407458314*^9, {3.561303327524748*^9, 
   3.561303329469919*^9}}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{
   RowBox[{"StringPosition", "[", 
    RowBox[{"test7", ",", 
     RowBox[{"RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
    "]"}], " ", "-", " ", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.561131281515595*^9, 3.561131282876124*^9}, {
  3.561131538418154*^9, 3.56113154695118*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.561238202917094*^9, 3.561238220460981*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5611315694295397`*^9, 3.5611315694434223`*^9}}],

Cell[BoxData[
 RowBox[{"StringDrop", "[", 
  RowBox[{"test8", ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"StringPosition", "[", 
        RowBox[{"test8", ",", " ", 
         RowBox[{"RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}],
         "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"test8", ",", " ", 
          RowBox[{
          "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], "]"}],
         "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.561238238222035*^9, 3.561238335826763*^9}}],

Cell[BoxData["\"\<(c(defghi))(d(defghi))\>\""], "Input",
 CellChangeTimes->{3.561294061940096*^9}],

Cell[BoxData[""], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistributorPass7", "[", "input_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "3"}], ",", 
    RowBox[{"++", "i"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"StringReplacePart", "[", 
      RowBox[{"input", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", " ", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", 
                    "]"}]}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"StringTake", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", " ", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", 
                    "]"}]}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"StringDrop", "[", 
                 RowBox[{
                  RowBox[{"StringTake", "[", 
                   RowBox[{"input", ",", 
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", 
                    "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", " ", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  
                  RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], "]"}], ",", 
             "\"\<)))(\>\""}], "]"}], ",", 
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", 
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"input", ",", 
                RowBox[{
                "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}],
                "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringDrop", "[", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"input", ",", " ", 
                RowBox[{
                 RowBox[{"StringPosition", "[", 
                  RowBox[{"input", ",", " ", 
                   RowBox[{
                   "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", 
                    "]"}]}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "\[IndentingNewLine]", "]"}], 
                 "]"}]}], "]"}], ",", 
              RowBox[{"{", "3", "}"}]}], "]"}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{"input", ",", 
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"input", ",", 
                 RowBox[{
                 "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", 
                  "]"}]}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
         "\"\<)\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"input", ",", " ", 
             RowBox[{
             "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
            "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringPosition", "[", 
             RowBox[{"input", ",", " ", 
              RowBox[{
              "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "2"}], "]"}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DistributorPass7", "[", "test8", "]"}], "\[IndentingNewLine]", 
 RowBox[{"DistributorPass7", "[", "\"\<(a(cdefghi))(d(defghi))\>\"", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.561303356491127*^9, 3.561303370452815*^9}, {
  3.561304382040002*^9, 3.561304399999701*^9}, {3.5613058102451763`*^9, 
  3.561305814974147*^9}, {3.561306404909225*^9, 3.561306481603426*^9}, {
  3.561306842869956*^9, 3.561306847964961*^9}, {3.561308549281856*^9, 
  3.5613085812855997`*^9}, {3.561386832826584*^9, 3.561386875003715*^9}, {
  3.561387536739451*^9, 3.561387580126628*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistributorPass7", "[", "input_", "]"}], " ", ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ",", 
    RowBox[{"i", "\[LessEqual]", "1"}], ",", 
    RowBox[{"++", "i"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"StringReplacePart", "[", 
      RowBox[{"input", ",", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"StringJoin", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", " ", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", 
                    "]"}]}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", " ", "1"}], "]"}], "]"}]}], "]"}], ",", 
                
                RowBox[{"StringTake", "[", 
                 RowBox[{"input", ",", " ", 
                  RowBox[{
                   RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", " ", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", 
                    "]"}]}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"i", "+", "2"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"StringDrop", "[", 
                 RowBox[{
                  RowBox[{"StringTake", "[", 
                   RowBox[{"input", ",", 
                    RowBox[{
                    RowBox[{"StringPosition", "[", 
                    RowBox[{"input", ",", 
                    RowBox[{
                    "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", 
                    "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", " ", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  
                  RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], "]"}], ",", 
             "\"\<)))(\>\""}], "]"}], ",", 
           RowBox[{"StringTake", "[", 
            RowBox[{"input", ",", 
             RowBox[{
              RowBox[{"StringPosition", "[", 
               RowBox[{"input", ",", 
                RowBox[{
                "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}],
                "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringDrop", "[", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"input", ",", " ", 
                RowBox[{
                 RowBox[{"StringPosition", "[", 
                  RowBox[{"input", ",", " ", 
                   RowBox[{
                   "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", 
                    "]"}]}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "+", "1"}], "\[IndentingNewLine]", "]"}], 
                 "]"}]}], "]"}], ",", 
              RowBox[{"{", "3", "}"}]}], "]"}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{"input", ",", 
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"input", ",", 
                 RowBox[{
                 "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", 
                  "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], 
          "]"}], ",", "\"\<)\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"input", ",", " ", 
             RowBox[{
             "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
            "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringPosition", "[", 
             RowBox[{"input", ",", " ", 
              RowBox[{
              "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
             "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "2"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
      "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DistributorPass7", "[", "\"\<(b(defghi))(c(defghi))\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DistributorPass7", "[", "test8", "]"}]}], "Input",
 CellChangeTimes->{{3.5613870755861464`*^9, 3.561387146689982*^9}, {
  3.561387177424317*^9, 3.561387178561966*^9}, {3.561388509671838*^9, 
  3.561388537192885*^9}, {3.5613924057862*^9, 3.5613924186338587`*^9}, {
  3.561393971113942*^9, 3.561393971304367*^9}, {3.561394014057106*^9, 
  3.561394042392358*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DistributePass7Part1", "[", "input_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"StringJoin", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"input", ",", " ", 
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"input", ",", " ", 
                 RowBox[{
                 "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}],
                 "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{"input", ",", " ", 
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{"input", ",", " ", 
                 RowBox[{
                 "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}],
                 "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"StringDrop", "[", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{"input", ",", 
                RowBox[{
                 RowBox[{"StringPosition", "[", 
                  RowBox[{"input", ",", 
                   RowBox[{
                   "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", 
                    "]"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], "]"}], ",", 
         "\"\<)))(\>\""}], "]"}], ",", 
       RowBox[{"StringTake", "[", 
        RowBox[{"input", ",", 
         RowBox[{
          RowBox[{"StringPosition", "[", 
           RowBox[{"input", ",", 
            RowBox[{
            "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"StringDrop", "[", 
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{"input", ",", " ", 
            RowBox[{
             RowBox[{"StringPosition", "[", 
              RowBox[{"input", ",", " ", 
               RowBox[{
               "RegularExpression", "[", "\"\<\\\\([a-z]\\\\(\>\"", "]"}]}], 
              "]"}], "[", 
             RowBox[{"[", "2", "\[IndentingNewLine]", "]"}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"{", "3", "}"}]}], "]"}], ",", 
        RowBox[{"StringTake", "[", 
         RowBox[{"input", ",", 
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"input", ",", 
             RowBox[{
             "RegularExpression", "[", "\"\<\\\\([a-z]+\\\\)\>\"", "]"}]}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
     "\"\<)\>\""}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.5613876067226152`*^9, 3.561388484061839*^9, {3.561397471037166*^9, 
   3.56139747534649*^9}, {3.561397952114779*^9, 3.561398073721079*^9}, 
   3.561398144958085*^9, {3.561467385989169*^9, 3.561467386660377*^9}}],

Cell[BoxData[{
 RowBox[{"test8", " ", "=", " ", 
  "\"\<(a(defghi))(b(defghi))(c(defghi))(d(defghi))\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{"StringPosition", "[", 
  RowBox[{"test8", ",", 
   RowBox[{
   "RegularExpression", "[", 
    "\"\<\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\>\"", 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test8partial", " ", "=", 
   RowBox[{"StringDrop", "[", 
    RowBox[{"test8", ",", 
     RowBox[{"-", "22"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"test8partial2", " ", "=", 
   RowBox[{"StringDrop", "[", 
    RowBox[{"test8", ",", 
     RowBox[{"+", "22"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"DistributePass7", "[", "test8partial2", "]"}]}], "Input",
 CellChangeTimes->{{3.561395821673087*^9, 3.5613958709801064`*^9}, {
   3.561397975387121*^9, 3.561397980033654*^9}, {3.561398086139423*^9, 
   3.561398086871654*^9}, {3.56139811988903*^9, 3.5613981308301888`*^9}, {
   3.561403424850281*^9, 3.5614034356680717`*^9}, {3.561467389034747*^9, 
   3.561467390134968*^9}, 3.5614674813339367`*^9, {3.561467825967742*^9, 
   3.561467869807743*^9}, {3.561467902110148*^9, 3.5614679492099524`*^9}, {
   3.561479806760013*^9, 3.561479825923751*^9}, {3.561479876975917*^9, 
   3.5614799428706703`*^9}}],

Cell[BoxData[
 RowBox[{"StringTake", "[", 
  RowBox[{"test8", ",", 
   RowBox[{
    RowBox[{"StringPosition", "[", 
     RowBox[{"test8", ",", 
      RowBox[{
      "RegularExpression", "[", 
       "\"\<\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\>\"\
", "]"}]}], "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.561479948651067*^9, 3.56147999036591*^9}}],

Cell[BoxData[
 RowBox[{"StringDrop", "[", 
  RowBox[{"test8", ",", 
   RowBox[{"-", "22"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.561397457607792*^9, 3.561397462768001*^9}}],

Cell[BoxData[
 RowBox[{"test11", " ", "=", " ", "\"\<((ab)c)d\>\""}]], "Input",
 CellChangeTimes->{{3.5612940789742537`*^9, 3.561294081852866*^9}}],

Cell[BoxData[{
 RowBox[{"test12", " ", "=", " ", "\"\<(ab)c\>\""}], "\[IndentingNewLine]", 
 RowBox[{"target12", " ", "=", "\"\<(ac)(bc)\>\""}], "\n", 
 RowBox[{"test13", " ", "=", "\"\<(ab)c\>\""}], "\[IndentingNewLine]", 
 RowBox[{"target14", " ", "=", "\"\<([a][b])[c]\>\""}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"[", "a", "]"}], "[", "b", "]"}], ")"}], "[", "c", "]"}], 
    "]"}], "=", 
   RowBox[{
    RowBox[{"(", "ab", ")"}], "c"}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.56129408718246*^9, 3.561294146417325*^9}, {
  3.5613867966009607`*^9, 3.5613867970030212`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistributePass7", "[", "input_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", 
    RowBox[{"i", " ", "<", " ", "4"}], ",", " ", 
    RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"DistributePass7Part1", "[", 
      RowBox[{"StringTake", "[", 
       RowBox[{"input", ",", 
        RowBox[{
         RowBox[{"StringPosition", "[", 
          RowBox[{"input", ",", 
           RowBox[{
           "RegularExpression", "[", 
            "\"\<\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\\\\([a-z]\\\\([a-z]*\\\\)\\\\\
)\>\"", "]"}]}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5614802833979397`*^9, 3.561480300958557*^9}, {
  3.561481105535981*^9, 3.561481160818684*^9}, {3.561481200169636*^9, 
  3.561481240431305*^9}, {3.5614813033800287`*^9, 3.561481303499834*^9}, {
  3.5614825584214907`*^9, 3.561482574037499*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DistributePass7", "[", "test8", "]"}]], "Input",
 CellChangeTimes->{{3.561481164470957*^9, 3.561481170953766*^9}}],

Cell[BoxData[
 RowBox[{"\<\"(c((d(defghi))))((defghi)(d(defghi))\"\>", 
  "\[IndentingNewLine]"}]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.561481243983807*^9, 3.561481306366249*^9, {3.5614825762396727`*^9, 
   3.561482581060287*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DistributePass7", "[", "input_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", " ", "=", " ", "1"}], ",", 
    RowBox[{"i", " ", "<", " ", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"StringPosition", "[", 
        RowBox[{"input", ",", 
         RowBox[{
         "RegularExpression", "[", 
          "\"\<\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\
\>\"", "]"}]}], "]"}], "]"}], "+", "1"}]}], ",", " ", 
    RowBox[{"++", "i"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"StringReplacePart", "[", 
      RowBox[{"input", ",", 
       RowBox[{"DistributePass7Part1", "[", 
        RowBox[{"StringTake", "[", 
         RowBox[{"input", ",", 
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"input", ",", 
             RowBox[{
             "RegularExpression", "[", 
              "\"\<\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\\\\([a-z]\\\\([a-z]*\\\\)\\\
\\)\>\"", "]"}]}], "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"StringPosition", "[", 
         RowBox[{"input", ",", 
          RowBox[{
          "RegularExpression", "[", 
           "\"\<\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\
\>\"", "]"}]}], "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DistributePass7", "[", "test8", "]"}]}], "Input",
 CellChangeTimes->{{3.561482583755773*^9, 3.561482602045062*^9}, {
  3.5614828204289627`*^9, 3.561482868356056*^9}, {3.5614833390814877`*^9, 
  3.561483352485033*^9}, {3.561483608117201*^9, 3.5614836193409443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Length", "[", 
   RowBox[{"StringPosition", "[", 
    RowBox[{"input", ",", 
     RowBox[{
     "RegularExpression", "[", 
      "\"\<\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\\\\([a-z]\\\\([a-z]*\\\\)\\\\)\>\"\
", "]"}]}], "]"}], "]"}], "+", "1"}]], "Input",
 CellChangeTimes->{{3.561483576730101*^9, 3.561483601409499*^9}}],

Cell[BoxData[""], "Input"]
},
WindowSize->{735, 756},
WindowMargins->{{23, Automatic}, {Automatic, 24}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 90, 1, 27, "Input"],
Cell[650, 23, 94, 1, 27, "Input"],
Cell[747, 26, 625, 12, 84, "Input"],
Cell[1375, 40, 460, 10, 43, "Input"],
Cell[1838, 52, 106, 1, 27, "Input"],
Cell[1947, 55, 614, 19, 48, "Input"],
Cell[2564, 76, 412, 10, 27, "Input"],
Cell[2979, 88, 672, 18, 43, "Input"],
Cell[3654, 108, 431, 8, 27, "Input"],
Cell[4088, 118, 104, 1, 27, "Input"],
Cell[4195, 121, 791, 17, 43, "Input"],
Cell[4989, 140, 681, 17, 73, "Input"],
Cell[5673, 159, 1846, 48, 88, "Input"],
Cell[7522, 209, 605, 13, 27, "Input"],
Cell[8130, 224, 143, 2, 27, "Input"],
Cell[8276, 228, 1751, 47, 88, "Input"],
Cell[10030, 277, 307, 8, 27, "Input"],
Cell[10340, 287, 180, 4, 27, "Input"],
Cell[10523, 293, 96, 1, 27, "Input"],
Cell[10622, 296, 117, 2, 27, "Input"],
Cell[10742, 300, 26, 0, 27, "Input"],
Cell[10771, 302, 553, 14, 29, "Input"],
Cell[11327, 318, 91, 1, 27, "Input"],
Cell[11421, 321, 648, 15, 29, "Input"],
Cell[12072, 338, 754, 18, 27, "Input"],
Cell[12829, 358, 26, 0, 27, "Input"],
Cell[12858, 360, 1404, 34, 43, "Input"],
Cell[14265, 396, 111, 1, 43, "Input"],
Cell[14379, 399, 435, 11, 27, "Input"],
Cell[14817, 412, 69, 1, 27, "Input"],
Cell[14889, 415, 952, 27, 43, "Input"],
Cell[15844, 444, 862, 12, 27, "Input"],
Cell[16709, 458, 2295, 59, 148, "Input"],
Cell[19007, 519, 1840, 53, 103, "Input"],
Cell[20850, 574, 288, 8, 27, "Input"],
Cell[21141, 584, 361, 10, 27, "Input"],
Cell[21505, 596, 250, 7, 27, "Input"],
Cell[21758, 605, 246, 7, 27, "Input"],
Cell[22007, 614, 151, 4, 27, "Input"],
Cell[22161, 620, 142, 2, 27, "Input"],
Cell[22306, 624, 168, 2, 27, "Input"],
Cell[22477, 628, 3966, 106, 208, "Input"],
Cell[26446, 736, 503, 14, 27, "Input"],
Cell[26952, 752, 2695, 76, 103, "Input"],
Cell[29650, 830, 73, 1, 27, "Input"],
Cell[29726, 833, 422, 12, 27, "Input"],
Cell[30151, 847, 5236, 132, 208, "Input"],
Cell[35390, 981, 104, 1, 27, "Input"],
Cell[35497, 984, 4247, 129, 223, "Input"],
Cell[39747, 1115, 94, 1, 27, "Input"],
Cell[39844, 1118, 5573, 138, 223, "Input"],
Cell[45420, 1258, 321, 9, 27, "Input"],
Cell[45744, 1269, 471, 13, 27, "Input"],
Cell[46218, 1284, 5675, 138, 223, "Input"],
Cell[51896, 1424, 1823, 48, 88, "Input"],
Cell[53722, 1474, 481, 13, 27, "Input"],
Cell[54206, 1489, 425, 12, 27, "Input"],
Cell[54634, 1503, 77, 1, 27, "Input"],
Cell[54714, 1506, 94, 1, 27, "Input"],
Cell[54811, 1509, 473, 14, 27, "Input"],
Cell[CellGroupData[{
Cell[55309, 1527, 3129, 76, 148, "Input"],
Cell[CellGroupData[{
Cell[58463, 1607, 308, 5, 20, "Print"],
Cell[58774, 1614, 202, 2, 20, "Print"],
Cell[58979, 1618, 197, 2, 20, "Print"],
Cell[59179, 1622, 204, 2, 20, "Print"]
}, Open  ]]
}, Open  ]],
Cell[59410, 1628, 409, 11, 27, "Input"],
Cell[59822, 1641, 70, 1, 27, "Input"],
Cell[59895, 1644, 92, 1, 27, "Input"],
Cell[59990, 1647, 4513, 102, 238, "Input"],
Cell[64506, 1751, 92, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[64623, 1756, 460, 8, 58, "Input"],
Cell[CellGroupData[{
Cell[65108, 1768, 254, 5, 20, "Print"],
Cell[65365, 1775, 247, 5, 20, "Print"],
Cell[65615, 1782, 254, 5, 20, "Print"],
Cell[65872, 1789, 254, 5, 20, "Print"],
Cell[66129, 1796, 247, 5, 20, "Print"],
Cell[66379, 1803, 232, 5, 20, "Print"],
Cell[66614, 1810, 210, 5, 20, "Print"],
Cell[66827, 1817, 199, 4, 20, "Print"],
Cell[67029, 1823, 191, 4, 20, "Print"],
Cell[67223, 1829, 423, 8, 36, "Print"],
Cell[67649, 1839, 101, 1, 20, "Print"]
}, Open  ]],
Cell[67765, 1843, 96, 1, 27, "Output"]
}, Open  ]],
Cell[67876, 1847, 146, 2, 27, "Input"],
Cell[68025, 1851, 137, 2, 27, "Input"],
Cell[68165, 1855, 571, 14, 27, "Input"],
Cell[68739, 1871, 426, 12, 27, "Input"],
Cell[69168, 1885, 424, 12, 27, "Input"],
Cell[69595, 1899, 425, 12, 27, "Input"],
Cell[70023, 1913, 422, 12, 27, "Input"],
Cell[70448, 1927, 319, 5, 43, "Input"],
Cell[70770, 1934, 710, 14, 43, "Input"],
Cell[71483, 1950, 883, 19, 73, "Input"],
Cell[72369, 1971, 5508, 127, 418, "Input"],
Cell[77880, 2100, 1569, 44, 118, "Input"],
Cell[79452, 2146, 6684, 144, 448, "Input"],
Cell[86139, 2292, 94, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[86258, 2297, 468, 8, 58, "Input"],
Cell[86729, 2307, 91, 1, 27, "Output"],
Cell[86823, 2310, 107, 1, 27, "Output"],
Cell[86933, 2313, 93, 1, 27, "Output"]
}, Open  ]],
Cell[87041, 2317, 396, 8, 43, "Input"],
Cell[87440, 2327, 636, 15, 73, "Input"],
Cell[88079, 2344, 482, 11, 58, "Input"],
Cell[CellGroupData[{
Cell[88586, 2359, 675, 15, 88, "Input"],
Cell[89264, 2376, 241, 5, 20, "Print"]
}, Open  ]],
Cell[89520, 2384, 771, 17, 73, "Input"],
Cell[90294, 2403, 470, 11, 43, "Input"],
Cell[90767, 2416, 94, 1, 27, "Input"],
Cell[90864, 2419, 10963, 240, 793, "Input"],
Cell[101830, 2661, 153, 2, 27, "Input"],
Cell[101986, 2665, 140, 2, 27, "Input"],
Cell[102129, 2669, 979, 22, 133, "Input"],
Cell[103111, 2693, 1197, 26, 148, "Input"],
Cell[104311, 2721, 112, 1, 27, "Input"],
Cell[104426, 2724, 151, 2, 27, "Input"],
Cell[104580, 2728, 147, 2, 27, "Input"],
Cell[104730, 2732, 118, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[104873, 2738, 971, 16, 73, "Input"],
Cell[105847, 2756, 315, 6, 20, "Print"]
}, Open  ]],
Cell[106177, 2765, 1593, 37, 103, "Input"],
Cell[107773, 2804, 397, 9, 58, "Input"],
Cell[108173, 2815, 356, 8, 27, "Input"],
Cell[108532, 2825, 415, 12, 43, "Input"],
Cell[108950, 2839, 1986, 53, 148, "Input"],
Cell[110939, 2894, 3924, 96, 328, "Input"],
Cell[114866, 2992, 816, 19, 73, "Input"],
Cell[115685, 3013, 118, 2, 27, "Input"],
Cell[115806, 3017, 118, 2, 27, "Input"],
Cell[115927, 3021, 5468, 127, 373, "Input"],
Cell[CellGroupData[{
Cell[121420, 3152, 94, 1, 27, "Input"],
Cell[121517, 3155, 142, 3, 20, "Print"]
}, Open  ]],
Cell[121674, 3161, 143, 2, 27, "Input"],
Cell[CellGroupData[{
Cell[121842, 3167, 911, 18, 58, "Input"],
Cell[122756, 3187, 90, 1, 27, "Output"],
Cell[122849, 3190, 80, 1, 27, "Output"]
}, Open  ]],
Cell[122944, 3194, 348, 7, 27, "Input"],
Cell[123295, 3203, 92, 1, 27, "Input"],
Cell[123390, 3206, 222, 4, 27, "Input"],
Cell[123615, 3212, 2430, 56, 148, "Input"],
Cell[126048, 3270, 2107, 53, 148, "Input"],
Cell[CellGroupData[{
Cell[128180, 3327, 138, 2, 27, "Input"],
Cell[128321, 3331, 94, 1, 27, "Output"]
}, Open  ]],
Cell[128430, 3335, 1902, 50, 148, "Input"],
Cell[130335, 3387, 2642, 63, 208, "Input"],
Cell[CellGroupData[{
Cell[133002, 3454, 168, 3, 27, "Input"],
Cell[133173, 3459, 103, 1, 27, "Output"]
}, Open  ]],
Cell[133291, 3463, 141, 2, 27, "Input"],
Cell[133435, 3467, 2126, 55, 178, "Input"],
Cell[135564, 3524, 140, 2, 27, "Input"],
Cell[135707, 3528, 1869, 44, 193, "Input"],
Cell[137579, 3574, 93, 1, 27, "Input"],
Cell[137675, 3577, 26, 0, 27, "Input"],
Cell[137704, 3579, 656, 13, 73, "Input"],
Cell[138363, 3594, 695, 24, 31, "Input"],
Cell[139061, 3620, 768, 25, 31, "Input"],
Cell[139832, 3647, 777, 28, 31, "Input"],
Cell[140612, 3677, 207, 3, 27, "Input"],
Cell[CellGroupData[{
Cell[140844, 3684, 347, 6, 43, "Input"],
Cell[141194, 3692, 122, 1, 27, "Output"],
Cell[141319, 3695, 135, 1, 27, "Output"]
}, Open  ]],
Cell[141469, 3699, 2853, 68, 238, "Input"],
Cell[144325, 3769, 599, 12, 43, "Input"],
Cell[144927, 3783, 668, 17, 43, "Input"],
Cell[145598, 3802, 3155, 80, 268, "Input"],
Cell[CellGroupData[{
Cell[148778, 3886, 3080, 79, 283, "Input"],
Cell[151861, 3967, 137, 1, 27, "Output"],
Cell[152001, 3970, 137, 1, 27, "Output"]
}, Open  ]],
Cell[152153, 3974, 274, 6, 43, "Input"],
Cell[152430, 3982, 5346, 126, 373, "Input"],
Cell[157779, 4110, 94, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[157898, 4115, 266, 4, 27, "Input"],
Cell[CellGroupData[{
Cell[158189, 4123, 3215, 82, 126, "Print"],
Cell[161407, 4207, 3215, 82, 126, "Print"],
Cell[164625, 4291, 2236, 56, 111, "Print"],
Cell[166864, 4349, 1693, 41, 96, "Print"],
Cell[168560, 4392, 488, 8, 51, "Print"],
Cell[169051, 4402, 392, 7, 20, "Print"]
}, Open  ]]
}, Open  ]],
Cell[169470, 4413, 352, 8, 27, "Input"],
Cell[169825, 4423, 92, 1, 27, "Input"],
Cell[169920, 4426, 96, 1, 27, "Input"],
Cell[170019, 4429, 824, 24, 43, "Input"],
Cell[170846, 4455, 98, 1, 27, "Input"],
Cell[170947, 4458, 26, 0, 27, "Input"],
Cell[170976, 4460, 5171, 123, 358, "Input"],
Cell[176150, 4585, 5320, 129, 358, "Input"],
Cell[181473, 4716, 3357, 84, 298, "Input"],
Cell[184833, 4802, 1355, 30, 133, "Input"],
Cell[186191, 4834, 416, 11, 58, "Input"],
Cell[186610, 4847, 176, 4, 27, "Input"],
Cell[186789, 4853, 147, 2, 27, "Input"],
Cell[186939, 4857, 698, 17, 118, "Input"],
Cell[187640, 4876, 1038, 25, 103, "Input"],
Cell[CellGroupData[{
Cell[188703, 4905, 138, 2, 27, "Input"],
Cell[188844, 4909, 277, 7, 36, "Print"]
}, Open  ]],
Cell[189136, 4919, 1746, 43, 208, "Input"],
Cell[190885, 4964, 350, 9, 43, "Input"],
Cell[191238, 4975, 26, 0, 27, "Input"]
}
]
*)

(* End of internal cache information *)
